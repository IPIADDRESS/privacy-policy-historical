<!--The following is the downloaded HTML source of the moki.tv privacy policy that was archived on 2011-09-02.
 Please check the original snapshot on the Wayback Machine (https://web.archive.org/web/20110902115608id_/http%3A//moki.tv/privacy) for the most accurate reproduction.-->

<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html class="cufon-active cufon-ready"><head>
    <meta name="google-site-verification" content="a2fEN19Zt2_vxtdwiPbWp-htwNWrZpQFnmmJXGvoklg">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta property="og:type" content="website">
    <meta property="og:image" content="http://moki.tv/images/moki_80.jpg">
    <meta property="fb:admins" content="712187,1374360197,120416227995298">
    <meta name="description" content="Moki.TV - Find new Movies and TV shows to watch online, right now.">
    <title>Moki</title>
    <link rel="stylesheet" href="/static1296559268/css/reset.css" type="text/css">
    <link rel="stylesheet" href="/static1302999883/css/utils.css" type="text/css">
    <link rel="stylesheet" href="/static1302999883/css/main.css" type="text/css">
    <link rel="stylesheet" href="/static1296559268/css/tipsy.css" type="text/css">
    <link rel="shortcut icon" type="image/vnd.microsoft.icon" href="/static1297470414/favicon.ico">
    <script type="text/javascript" async="" src="https://ssl.google-analytics.com/ga.js"></script><script src="/js/cufon-yui.js" type="text/javascript"></script><style type="text/css">cufon{text-indent:0!important;}@media screen,projection{cufon{display:inline!important;display:inline-block!important;position:relative!important;vertical-align:middle!important;font-size:1px!important;line-height:1px!important;}cufon cufontext{display:-moz-inline-box!important;display:inline-block!important;width:0!important;height:0!important;overflow:hidden!important;text-indent:-10000in!important;}cufon canvas{position:relative!important;}}@media print{cufon{padding:0!important;}cufon canvas{display:none!important;}}</style>
    <script src="/js/Futura.font.js" type="text/javascript"></script>
    <script type="text/javascript">
          Cufon.replace('h1');
    </script>
    
    <script type="text/javascript">var _sf_startpt=(new Date()).getTime()</script>
    <script type="text/javascript">
      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-17083830-1']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();
    </script>
  </head>
  <body>

    <div id="header_container">
      <div id="header" class="clearfix">
        <div class="left" style="width: 140px;">
          <a href="/"><h1 id="logo"><span class="hide">moki.tv</span></h1></a>
        </div>
        <div class="right clearfix" style="width: 780px;position: relative;">
          <div id="search" class="left">
            <input type="text" value="Search for a Movie, Show, Director, Actor..." autocomplete="off">
            <ul class="dropdown_options media hide">
            </ul>
          </div>
          <div class="right search_button">
            Search
          </div>
        </div>
      </div>
    </div>
    <div id="container">
      <div id="main" class="clearfix">
        <div class="left">
          <a id="signup_block" class="signup_link mr_10 mb_10">
            <p class="darkest small mb_10">
              The <strong>ultimate</strong> guide to online entertainment.
            </p>
            <p class="faded small">
              <span class="special_link">Signup</span> to get your personalized movie &amp; TV recommendations.
            </p>
          </a>
          <hr class="mt_10 mb_10">
          <ul id="main_nav">
            <li><a href="/" class="" title="There's no place like it.">Home</a></li>
            <li><a href="/movies" class="">Movies</a></li>
            <li><a href="/tv" class="">TV</a></li>
            <li><a href="/explore" class="">Explore</a></li>
          </ul>
          <hr class="mt_0 mb_10">
          <div class="small mt_20 ml_10 mb_20">
            <form id="header_login_form">
              <div class="mb_5">Email</div>
              <input type="text" name="email" style="width: 125px;font-size:13px;padding: 2px;">
              <div class="mt_10 mb_5">Password</div>
              <input type="password" name="password" style="width: 125px;font-size:13px;padding: 2px;">
              <div id="header_login_form_error" class="form_error mt_10">
              </div>
              <div class="clearfix mt_10">
                <input type="submit" class="action_button no_icon left" value="Login">
                <a class="facebook_button mt_4 ml_10 left">
                  <img src="/images/facebook_16.png">
                </a>
              </div>
              <p class="mt_7">
                <a href="/auth/forgot_password" class="faint small">Forgot password?</a>
              </p>
              <hr class="mt_10 mb_10">
              <p class="mt_0">
              <a class="signup_link small">Signup. <span class="faded">The best decision you've made all week.</span></a>
              </p>
            </form>
          </div>
        </div>
        <div class="right">
          

<h2 class="mb_20">Privacy Policy</h2>

<div class="clearfix" style="width: 600px;">
<p class="mb_15">We recognize that your privacy is very important and take it seriously. This Privacy Policy describes Moki's policies and procedures on the collection, use and disclosure of your information when you use the Moki Service. We will not use or share your information with anyone except as described in this Privacy Policy. This Privacy Policy does not apply to information we collect by other means (including offline) or from other sources. Capitalized terms that are not defined in this Privacy Policy have the meaning given them in our Terms of Service.</p>

<h3 class="strong mt_30 mb_10">
  Information Collection and Use
</h3>

<p class="mb_15 medium">
Moki uses information we collect to analyze how the Service is used, diagnose service or technical problems, maintain security, personalize content, remember information to help you efficiently access your account, monitor aggregate metrics such as total number of visitors, traffic, and demographic patterns, and track User Content and users as necessary to comply with the Digital Millennium Copyright Act and other applicable laws.
</p>

<p class="mb_15 medium">
<strong>User-Provided Information:</strong> You provide us information about yourself, such as your name and e-mail address, if you register for a member account with the Service. Your name and other information you choose to add to your profile will be available for public viewing on the Service. We may use your email address to send you Service-related notices (including any notices required by law, in lieu of communication by postal mail). You can control receipt of certain Service-related messages on your Settings page. We may also use your contact information to send you marketing messages. If you do not want to receive such messages, you may opt out by following the instructions in the message. If you correspond with us by email, we may retain the content of your email messages, your email address and our responses.
</p>
<p class="mb_15 medium">
You also provide us information in User Content you post to the Service. Your questions, answers, and other contributions on the Service, and metadata about them (such as when you posted them), are publicly viewable on the Service, along with your name (unless the Service permits you to post anonymously). This information may be searched by search engines and be republished elsewhere on the Web in accordance with our Terms of Service.
</p>
<p class="mb_15 medium">
If you choose to use our invitation service to invite a friend to the Service, we will ask you for that person's email address and automatically send an email invitation. Moki stores this information to send this email, to register your friend if your invitation is accepted, and to track the success of our invitation service.
</p>
<p class="mb_15 medium">
<strong>Cookies:</strong> When you visit the Service, we may send one or more "cookies" - small data files - to your computer to uniquely identify your browser and let Moki help you log in faster and enhance your navigation through the site. A cookie may convey anonymous information about how you browse the Service to us, but does not collect personal information about you. A persistent cookie remains on your computer after you close your browser so that it can be used by your browser on subsequent visits to the Service. Persistent cookies can be removed by following your web browser's directions. A session cookie is temporary and disappears after you close your browser. You can reset your web browser to refuse all cookies or to indicate when a cookie is being sent. However, some features of the Service may not function properly if the ability to accept cookies is disabled.
</p>
<p class="mb_15 medium">
<strong>Log Files:</strong> Log file information is automatically reported by your browser each time you access a web page. When you use the Service, our servers automatically record certain information that your web browser sends whenever you visit any website. These server logs may include information such as your web request, Internet Protocol ("IP") address, browser type, referring / exit pages and URLs, number of clicks, domain names, landing pages, pages viewed, and other such information.
</p>
<p class="mb_15 medium">
<strong>Clear GIFs Information:</strong> When you use the Service, we may employ clear GIFs (also known as web beacons) which are used to track the online usage patterns of our users anonymously. No personally identifiable information from your Moki account is collected using these clear GIFs. In addition, we may also use clear GIFs in HTML-based emails sent to our users to track which emails are opened by recipients. The information is used to enable more accurate reporting and make Moki better for our users.
</p>
<p class="mb_15 medium">
<strong>Third Party Services:</strong> Moki may use Google Analytics or Mixpanel to help understand use of the Service. Google Analytics and Mixpanel collect the information sent by your browser as part of a web page request, including cookies and your IP address. Google Analytics and Mixpanel also receive this information and their use of it is governed by their Privacy Policies.
</p>

<h3 class="strong mt_30 mb_10">
  How We Share Your Information
</h3>

<p class="mb_15 medium">
Personally Identifiable Information: Moki may share your personally identifiable information with third parties for the purpose of providing the Service to you. If we do this, such third parties' use of your information will be bound by this Privacy Policy. We may store personal information in locations outside the direct control of Moki (for instance, on servers or databases co-located with hosting providers).
</p>
<p class="mb_15 medium">
As we develop our business, we may buy or sell assets or business offerings. Customer, email, and visitor information is generally one of the transferred business assets in these types of transactions. We may also transfer or assign such information in the course of corporate divestitures, mergers, or dissolution.
</p>
<p class="mb_15 medium">
We may share or disclose your information with your consent, such as if you choose to sign on to the Service through a third-party service. We cannot control third parties' use of your information.
</p>
<p class="mb_15 medium">
Moki may disclose your personal information if required to do so by law or subpoena or if we believe that it is reasonably necessary to comply with a law, regulation or legal request; to protect the safety of any person; to address fraud, security or technical issues; or to protect Moki's rights or property.
</p>
<p class="mb_15 medium">
Non-Personally Identifiable Information: We may share non-personally identifiable information (such as anonymous usage data, referring/exit pages and URLs, platform types, number of clicks, etc.) with interested third parties to help them understand the usage patterns for certain Moki services.
</p>
<p class="mb_15 medium">
Moki may allow third-party ad servers or ad networks to serve advertisements on the Service. These third-party ad servers or ad networks use technology to send, directly to your browser, the advertisements and links that appear on Moki. They automatically receive your IP address when this happens. They may also use other technologies (such as cookies, JavaScript, or web beacons) to measure the effectiveness of their advertisements and to personalize the advertising content. Moki does not provide any personally identifiable information to these third-party ad servers or ad networks without your consent. However, please note that if an advertiser asks Moki to show an advertisement to a certain audience and you respond to that advertisement, the advertiser or ad server may conclude that you fit the description of the audience they are trying to reach. The Moki Privacy Policy does not apply to, and we cannot control the activities of, third-party advertisers. Please consult the respective privacy policies of such advertisers for more information.
</p>

<h3 class="strong mt_30 mb_10">
  How We Protect Your Information
</h3>

<p class="mb_15 medium">
Moki uses commercially reasonable physical, managerial, and technical safeguards to preserve the integrity and security of your personal information. We cannot, however, ensure or warrant the security of any information you transmit to Moki or guarantee that your information on the Service may not be accessed, disclosed, altered, or destroyed by breach of any of our physical, technical, or managerial safeguards.
</p>
<p class="mb_15 medium">
In the event that personal information is compromised as a result of a breach of security, Moki will promptly notify those persons whose personal information has been compromised, in accordance with the notification procedures set forth in this Privacy Policy, or as otherwise required by applicable law.
</p>

<h3 class="strong mt_30 mb_10">
Your Choices About Your Information
</h3>

<p class="mb_15 medium">
You may, of course, decline to submit personally identifiable information through the Service, in which case Moki may not be able to provide certain services to you. You may update or correct your account information and email preferences at any time by logging in to your account.
</p>

<h3 class="strong mt_30 mb_10">
Children's Privacy
</h3>

<p class="mb_15 medium">
Protecting the privacy of young children is especially important. Moki does not knowingly collect or solicit personal information from anyone under the age of 13 or knowingly allow such persons to register with the Service. If we become aware that we have collected personal information from a child under age 13 without verification of parental consent, we take steps to remove that information.
</p>

<h3 class="strong mt_30 mb_10">
Links to Other Web Sites
</h3>

<p class="mb_15 medium">
We are not responsible for the practices employed by websites linked to or from the Service, nor the information or content contained therein. Please remember that when you use a link to go from the Service to another website, our Privacy Policy is no longer in effect. Your browsing and interaction on any other website, including those that have a link on our website, is subject to that website's own rules and policies.
</p>
</div>

        </div>
      </div>
    </div>
    <div id="footer" class="clearfix">
      <hr class="mt_0">
      <div class="left ml_10" style="width: 150px;line-height: 18px;">
        Moki Inc. © 2011
      </div>
      <div class="left column">
        <ul>
          <li class="mb_3"><a href="/" class="faded">Home</a></li>

          <li class="mb_3"><a href="/movies" class="faded">Movies</a></li>

          <li class="mb_3"><a href="/tv" class="faded">TV</a></li>

          <li class="mb_3"><a href="/explore" class="faded">Collections</a></li>

          <li class="mb_3"><a href="/explore" class="faded">Awards</a></li>
          <li class="mb_3"><a href="/learn" class="faded">Learn More</a></li>
        </ul>
      </div>
      <div class="left column">
        
        <strong>Popular Movies</strong>
        <ul class="mt_3">
          
          <li class="mb_3"><a href="/movie/inception" class="faded">Inception</a></li><li>
          
          </li><li class="mb_3"><a href="/movie/toy-story-3" class="faded">Toy Story 3</a></li><li>
          
          </li><li class="mb_3"><a href="/movie/the-social-network" class="faded">The Social Network</a></li><li>
          
          </li><li class="mb_3"><a href="/movie/shutter-island" class="faded">Shutter Island</a></li><li>
          
          </li><li class="mb_3"><a href="/movie/black-swan" class="faded">Black Swan</a></li><li>
          
          </li><li class="mb_3"><a href="/movie/the-town" class="faded">The Town</a></li><li>
          
          </li><li class="mb_3"><a href="/movie/iron-man-2" class="faded">Iron Man 2</a></li><li>
          
          </li><li class="mb_3"><a href="/movie/the-kings-speech" class="faded">The King's Speech</a></li><li>
          
          </li><li class="mb_3"><a href="/movie/avatar" class="faded">Avatar</a></li><li>
          
          </li><li class="mb_3"><a href="/movie/salt" class="faded">Salt</a></li><li>
        </li></ul>
      </div>
      <div class="left column">
        <strong>Popular TV Shows</strong>
        <ul class="mt_3">
          
          <li class="mb_3"><a href="/tv/boardwalk-empire" class="faded">Boardwalk Empire</a></li><li>
          
          </li><li class="mb_3"><a href="/tv/dexter" class="faded">Dexter</a></li><li>
          
          </li><li class="mb_3"><a href="/tv/family-guy" class="faded">Family Guy</a></li><li>
          
          </li><li class="mb_3"><a href="/tv/jersey-shore" class="faded">Jersey Shore</a></li><li>
          
          </li><li class="mb_3"><a href="/tv/mad-men" class="faded">Mad Men</a></li><li>
          
          </li><li class="mb_3"><a href="/tv/modern-family" class="faded">Modern Family</a></li><li>
          
          </li><li class="mb_3"><a href="/tv/south-park" class="faded">South Park</a></li><li>
          
          </li><li class="mb_3"><a href="/tv/weeds" class="faded">Weeds</a></li><li>
          
          </li><li class="mb_3"><a href="/tv/futurama" class="faded">Futurama</a></li><li>
          
          </li><li class="mb_3"><a href="/tv/fringe" class="faded">Fringe</a></li><li>
        </li></ul>
      </div>
      <div class="left column">
        <ul>
          <li class="mb_3"><a href="/about" class="faded">About Moki</a></li>
          <li class="mb_3"><a href="/blog" class="faded">The Moki Blog</a></li>
          <li class="mb_3"><a href="/jobs" class="faded" style="background: #fcfca5;">We're Hiring!</a></li>
          <li class="mb_3"><a href="mailto:moki@moki.tv" class="faded">Contact Us</a></li>
        </ul>
      </div>
      <div class="left column">
        <ul>
          <li class="mb_3"><a href="http://twitter.com/MokiTV" target="_blank" class="faded">Twitter</a></li>
          <li class="mb_3"><a href="http://facebook.com/MokiTV" target="_blank" class="faded">Facebook</a></li>
          <li class="mb_3"><a href="/developers" class="faded">Developers</a></li>
          <li class="mb_3"><a href="/terms" class="faded">Terms</a></li>
          <li class="mb_3"><a href="/privacy" class="faded">Privacy</a></li>
        </ul>
      </div>
    </div>
    <div class="feedback_tab feedback"></div>
    <script type="text/javascript" src="/static1296559268/js/jquery-1.4.4.min.js"></script>
    <script type="text/javascript" src="/static1296559268/js/jquery-ui-1.8.5.custom.min.js"></script>
    <div id="fb-root"><script async="" src="https://connect.facebook.net/en_US/all.js"></script><script async="" src="https://platform.twitter.com/anywhere.js?id=otaH6BissRiIyOmEzGKMag&amp;v=1"></script><script async="" src="https://jsapi.netflix.com/us/api/js/api.js"></script></div>
    <script type="text/javascript" src="/static1296559268/js/jquery.simplemodal-1.4.js"></script>
    <script type="text/javascript" src="/static1296559268/js/jquery.tipsy.js"></script>
    <script type="text/javascript" src="/static1296559268/js/sprintf-0.7-beta1.js"></script>
    <script type="text/javascript">
        var _sf_async_config={uid:14538,domain:"moki.tv"};
        (function(){
            function loadChartbeat() {
            window._sf_endpt=(new Date()).getTime();
            var e = document.createElement('script');
            e.setAttribute('language', 'javascript');
            e.setAttribute('type', 'text/javascript');
            e.setAttribute('src',
              (("https:" == document.location.protocol) ? "https://s3.amazonaws.com/" : "http://") +
              "static.chartbeat.com/js/chartbeat.js");
            document.body.appendChild(e);
            }
            var oldonload = window.onload;
            window.onload = (typeof window.onload != 'function') ?
            loadChartbeat : function() { oldonload(); loadChartbeat(); };
        })();
    </script>
    <script>
      (function( $ ){

        $.fn.selectRange = function(start, end) {
          return this.each(function() {
            if (this.setSelectionRange) {
              this.focus();
              this.setSelectionRange(start, end);
            } else if (this.createTextRange) {
              var range = this.createTextRange();
              range.collapse(true);
              range.moveEnd('character', end);
              range.moveStart('character', start);
              range.select();
            }
          });
        };

        $.fn.autocomplete = function (url, onclick, extra_args) {
          // Media Search
          var container = this;
          var dropdown_options = this.find('.dropdown_options');
          var textarea = this.find('input');
          var lastSearch = 0, searchCount = 0, searchReturned = 0;
          var search_value = textarea.val();

          function triggerSearch() {

            var search = function () {
              var a = ++searchCount;
              var success = function (data) {
                if (a > searchReturned) {
                  searchReturned = a;
                  if (data.length) {
                    $(dropdown_options).html(data).removeClass('hide').children().first().addClass('selected');
                    $(dropdown_options).find('li').click(onclick).click(function () {
                      textarea.val('');
                      dropdown_options.addClass('hide');
                    });

                  }
                }
              } 
              var searchTerm = textarea.val();
              if (searchTerm == search_value) {
                searchTerm = '';
              }
              query = {q: searchTerm}
              if (extra_args) {
                query = $.extend(query, extra_args(container));
              }
              $.get(url, query, evalAjaxResponse({success: success}));
            }

            var time = new Date().getTime();
            if (time - lastSearch < 400) {
              return
            }
            lastSearch = time;
            setTimeout(search, 400);
          }

          textarea.focus(function () {
            if ($(this).val() == search_value) {
              $(this).val('');
            }
          });

          var lastSearchValue = textarea.val();

          textarea.keyup(function (e) {
            if (e.keyCode == 13) return
            var searchValue = $(this).val();
            if (searchValue != lastSearchValue) {
              lastSearchValue = searchValue;
              triggerSearch();
            }
          });

          textarea.mousedown(function () {
            var searchValue = $(this).val();
            lastSearchValue = searchValue;
            triggerSearch();
          })

          textarea.keydown(function (e) {
            if (e.keyCode == 40) {
              if ($('ul.dropdown_options').not('.hide').children('.selected').removeClass('selected').next().addClass('selected').length || $('ul.dropdown_options').not('.hide').children().first().addClass('selected').focus().length) {
                return false;
              }
            } else if (e.keyCode == 38) {
              if ($('ul.dropdown_options').not('.hide').children('.selected').removeClass('selected').prev().addClass('selected').length || $('ul.dropdown_options').not('.hide').children().last().addClass('selected').focus().length) {
                return false;
              }
            } else if (e.keyCode == 13) {
              $('ul.dropdown_options').not('.hide').children('.selected').click();
              // There is no return false here because otherwise you cannot put newline in textareas
            } else if (e.keyCode == 27 || (e.keyCode == 8 && $(this).val() == '')) {
              $(document).mousedown(); 
            }
            return true;
          });
        };
      })( jQuery );

      function mptrack(e, args) {
          if (args === undefined) {
            var args = {};
          }
          mpmetrics.track(e, args);
      }

      function modalResize() {
        var height = $('#simplemodal-data,.simplemodal-data').outerHeight();
        $('#simplemodal-container').height(height);
        return height;
      }

      
      function spawnLoginModal(signupSuccess, loginSuccess) {
        // Spawn the login modal
          var str = '<div style="width:320px;">'
          str += '  <div class="modal_nav clearfix">'
          str += '    <div id="modal_signup_tab" class="left active"><h2>Signup</h2></div>'
          str += '    <div id="modal_login_tab" class="mt_12 right medium">Have an account? <a>Login</a>.</div>'
          str += '  </div>'
          str += '  <div id="modal_login" class="login_form_inner clearfix" style="display:none">'
          str += '    <form id="login_form">'
          str += '      <div class="mb_10 clearfix">'
          str += '        <label for="email" class="normal left mt_7">Email</label>'
          str += '        <input name="email" type="text" value="" class="right" style="width: 182px;" />'
          str += '      </div>'
          str += '      <div class="mb_10 clearfix">'
          str += '        <label for="password" class="normal left mt_7">Password</label>'
          str += '        <input name="password" type="password" value="" class="right" style="width: 182px;" />'
          str += '      </div>'
          str += '      <div id="login_form_error" class="clearfix form_error" style="float:right;width:190px;margin-top:7px;">'
          str += '      </div>'
          str += '      <div class="clearfix">'
          str += '        <div style="float:right;width:194px;">'
          str += '          <input type="submit" name="submit" value="Login" class="button mt_7 left">'
          str += '          <div class="right mt_15 mr_10">'
          str += '            <a href="/auth/forgot_password" class="weak faded">forgot password?</a>'
          str += '          </div>'
          str += '        </div>'
          str += '      </div>'
          str += '      '
          str += '      <hr class="mt_10 mb_10" />'
          str += ''
          str += '      <a class="facebook_button_modal right">'
          str += '        <img src="/images/facebook_button_L.gif" />'
          str += '      </a>'
          str += '    </form>'
          str += '  </div>'
          str += '  <div id="modal_signup">'
          str += '    <div class="medium tleft ml_15 mr_15 weak">'
          str += '      <ul class="ulist">'
          str += '        <li><span style="background: #fcfcd5;">Get recommendations.</span></li>'
          str += '        <li><span style="background: #fcfcd5;">See what your friends are watching.</span></li>'
          str += '        <li><span style="background: #fcfcd5;">Manage one, <strong>universal</strong> queue across <strong>all</strong> your streaming sources!</span></li>'
          str += '      </ul>'
          str += '    </div>'
          str += '    <div class="login_form_inner clearfix">'
          str += '      <form id="signup_form">'
          str += '        <div class="mb_10 clearfix">'
          str += '          <label for="fullname" class="normal left mt_7">Full Name</label>'
          str += '          <input name="fullname" type="text" value="" class="right" style="width: 182px;" />'
          str += '        </div>'
          str += '        <div class="mb_10 clearfix">'
          str += '          <label for="email" class="normal left mt_7">Email</label>'
          str += '          <input name="email" type="text" value="" class="right" style="width: 182px;" />'
          str += '        </div>'
          str += '        <div class="mb_10">'
          str += '          <label for="password" class="normal left mt_7">Password</label>'
          str += '          <input name="password" type="password" value="" class="right" style="width: 182px;" />'
          str += '        </div>'
          str += '        <div id="signup_form_error" class="clearfix form_error" style="float:right;width:190px;margin-top:7px;">'
          str += '        </div>'
          str += '        <div class="clearfix">'
          str += '          <div style="float:right;width:194px;">'
          str += '            <input type="submit" value="Signup" class="button mt_7 left">'
          str += '          </div>'
          str += '        </div>'
          str += ''
          str += '        <hr class="mt_10 mb_10" />'
          str += '        '
          str += '        <a class="facebook_button_modal right">'
          str += '          <img src="/images/facebook_button_L.gif" width=194 height=25 />'
          str += '        </a>'
          str += '      </form>'
          str += '    </div>'
          str += '  </div>'
          str += '</div>'
          str += ''

        $(str).modal({
          overlayClose: true,
          autoResize: true,
          overlayCss: {backgroundColor:'#000', opacity: 1},
          position: ['10%'],
          });

        $('a.facebook_button_modal').click(function () {
          var scope = "email";
          FB.login(function(response) {
              if (response.session) {
                if (response.perms) {
                // user is logged in and granted some permissions.
                // perms is a comma separated list of granted permissions
                  var dict = {success: function (data) {$.modal.close(); signupSuccess(data)}}
                  $.get("/auth/ajax_login", evalAjaxResponse(dict));
                } else {
                // user is logged in, but did not grant any permissions
                } 
              } else {
                // user is not logged in
              }
          }, {perms:scope});
        });

        $('form#login_form').submit(function () {
          $.post("/auth/ajax_login_submit", $(this).serialize(),
            evalAjaxResponse({
              error: function (data) {
                $('#login_form_error').html(data);
                modalResize();
              },
              success: function (data) {
                mptrack('Modal login');
                $.modal.close();
                if (loginSuccess) {
                  loginSuccess(data);
                } else {
                  signupSuccess(data);
                }
              }
            })
          );
          // returning false stops the form from being submitted
          return false;
        });

        $('form#signup_form').submit(function () {
          $.post("/auth/register_submit", $(this).serialize(),
            evalAjaxResponse({
              error: function (data) {
                $('#signup_form_error').html(data);
                modalResize();
              },
              success: function (data) {
                  $.modal.close();
                  if (signupSuccess) {
                    signupSuccess(data);
                  } else {
                    window.location.reload();
                  };
              }
            })
          );
          // returning false stops the form from being submitted
          return false;
        });
      }

      function ajaxLogin(query, fns) {
        var repeatQuery = function () {
          $.post(query.path, query.params, evalAjaxResponse(fns));
        };
        var spawnModal = function () {
          mptrack('Action pops signup/login')
          spawnLoginModal(repeatQuery);
        };
        var dict = {fail: spawnModal, success: repeatQuery};
        $.get("/auth/ajax_login", evalAjaxResponse(dict));
      }

      function evalAjaxResponse(fns) {
        return function (response) {
          for (var key in response) {
            if (key == 'login') {
              ajaxLogin(response[key], fns);
            } else if (fns.hasOwnProperty(key)) {
              fns[key](response[key]);
            }
          }
        }
      }

      // Media Search
      $('#search').autocomplete("/browse/media_autocomplete?top_search", function() {window.location = $(this).attr('href')});

      

      
      
      $(document).ready(function () {

        $('.search_button').live('click', function() {
          var q = $(this).parent().find('input').val()
          if (q != '' && q != 'Search for a Movie, Show, Director, Actor...') {
            window.location = "/search?q=" + q;
          }
        });

        var hovercount = new Date().getTime();
        var in_hover = false;
      
        var load_hovercard = function(attach) {
          var time = new Date().getTime();
          if (attach != in_hover || (new Date().getTime() - hovercount < 500)) {
            return
          }

          var id = '#' + attach.attr('id') + 'hover';
          var hovercard = $(id);
          if (hovercard.length) {
            position_hovercard(attach, hovercard);
            hovercard.stop(true).show().animate({opacity: 1}, 200);
          } else {
            var response = {success: function (data) {
                              $data = $(data);
                              $data.css('opacity', 0);
                              $('body').append($data);
                              position_hovercard(attach, $data);
                              $data.stop(true).show().animate({opacity: 1}, 200);
                            }}
            $.get('/home/hovercard', {id: attach.attr('id')}, evalAjaxResponse(response))
          }
        }

        $('.has_hovercard').live('mouseenter', function() {
          var $this = $(this);
          in_hover = $this;
          hovercount = new Date().getTime();
          $('.hovercard').stop(true).css('opacity', 0).hide();
          setTimeout(function () {load_hovercard($this)}, 600);
        }).live('mouseleave', function() {
          in_hover = false;
          $('.hovercard').stop(true).css('opacity', 0).hide();
          var $this = $(this);
        });

        // Positions hovercard appropriately for the current browser window
        var position_hovercard = function(item, hovercard) {
          var $this = item;
          var ear = hovercard.find('.hovercard_ear');
          var offset = $this.offset();

          if (offset['left'] - $(window).scrollLeft() + $this.outerWidth() + hovercard.outerWidth() + 10 > $(window).width()) {
            var left = offset['left'] - hovercard.outerWidth() - 20;
            ear.addClass('right').removeClass('left');
          } else {
            var left = offset['left'] + $this.outerWidth() + 20;
            ear.addClass('left').removeClass('right');
          }
          hovercard.css('left', left);

          var vert_center = offset['top'] + ($this.outerHeight() - hovercard.outerHeight()) / 2;
          var vert_bottom = $(window).height() - hovercard.outerHeight() - 10 + $(window).scrollTop();
          var vert_top = $(window).scrollTop() + 10;
          var ear_center = (hovercard.outerHeight() - 19) / 2;

          if (offset['top'] + ($this.outerHeight() - hovercard.outerHeight()) / 2 - 5 < $(window).scrollTop()) {
            var top = vert_top;     
            ear.css('top', Math.max(ear_center - vert_top + vert_center, 16));
          } else if (offset['top'] + ($this.outerHeight() + hovercard.outerHeight()) / 2 + 5 > $(window).height() + $(window).scrollTop()) {
            var top = vert_bottom;    
            ear.css('top', Math.min(ear_center - vert_bottom + vert_center, hovercard.outerHeight() - 35));
          } else {
            var top = vert_center;
            ear.css('top', ear_center);
          }
          hovercard.css('top', top);
        }
        
        $('.signup_link').click(function () {
          spawnLoginModal(function () {window.location = '/sources?new'}, function () {window.location.reload()});
          return false;
        })

        // Counting
        var adjust_count = function () {
          $(this).closest('.countable').find('span#char_count').html(200 - $(this).val().length);
        }

        $('textarea', $('.countable')).live('keyup', adjust_count).live('keydown', adjust_count).live('keypress', adjust_count).live('focus', adjust_count);
        var countable_modal = "<div class='m_10 modal_container'><h3 class='sub_heading mr_15 ml_15 mb_5'>Your review must be under 200 characters long.</h3><p class='faded ml_15 mr_15' style='width: 340px;'>You'll be able to add an optional longer review after submitting this 200-character review.</p><div class='clearfix mr_15'><a onclick='$.modal.close()' class='button right delete_list'>OK</a></div></div>";

        // General Autocomplete
        $(document).keydown(function (e) {
          if (e.keyCode == 40) {
            if ($('ul.dropdown_options').not('.hide').children('.selected').removeClass('selected').next().addClass('selected').length || $('ul.dropdown_options').not('.hide').children().first().addClass('selected').focus().length) {
              return false;
            }
          } else if (e.keyCode == 38) {
            if ($('ul.dropdown_options').not('.hide').children('.selected').removeClass('selected').prev().addClass('selected').length || $('ul.dropdown_options').not('.hide').children().last().addClass('selected').focus().length) {
              return false;
            }
          } else if (e.keyCode == 13) {
            $('ul.dropdown_options').not('.hide').children('.selected').click();
            // There is no false here because otherwise you cannot put newlines in textareas
          }
          return true;
        });

        $('li', $('ul.dropdown_options')).live('mouseenter', function () {
          $(this).siblings().removeClass('selected');
          $(this).addClass('selected');
        })

        $('.dropdown').click(function () {
          // Clear all existing open dropdowns first
          if ($(this).parent().hasClass('dropdown_active')) {
            $(this).parent().removeClass('dropdown_active').end().find('ul.dropdown_options').addClass('hide');
          } else {
            $('.dropdown').parent().removeClass('dropdown_active');
            $('ul.dropdown_options').addClass('hide');
            $(this).parent().addClass('dropdown_active');
            $(this).find('ul.dropdown_options').removeClass('hide');
          }
        });

        $(document).mousedown(function (event) {
          if (!$(event.target).closest('ul.dropdown_options').length && !$(event.target).closest('.dropdown').length) {
              var dropdown = $('.dropdown');
              dropdown.parent().removeClass('dropdown_active');
              $('ul.dropdown_options').addClass('hide');
          }
        });

        $('.section_collapse').live('click', function () {
          var $this = $(this);
          var container = $this.closest('.section_container');
          if (container.hasClass('muted')) {
            container.removeClass('muted');
            container.find('.section_body').slideDown(200);
          } else {
            container.addClass('muted');
            container.find('.section_body').slideUp(200);
          }
          $.get('/home/update_view_settings', {'nick': $this.attr('nick')});
        });

        $('.netflix_link').live('click', function() { mptrack('Watch', {'type': 'netflix'}); });
        $('.hulu_link').live('click', function() { mptrack('Watch', {'type': 'hulu'}); });
        $('.hulu-plus_link').live('click', function() { mptrack('Watch', {'type': 'huluplus'}); });
        $('.itunes_link').live('click', function() { mptrack('Watch', {'type': 'itunes'}); });
        $('.amazon_link').live('click', function() { mptrack('Watch', {'type': 'amazon'}); });

        // Feedback form
        $('.feedback').live('click', function(){
          var text = $(this).attr('prompt');
          var feedback = function(response) {
            $.modal(response, {overlayClose: true, onShow: function () {
              if (text) {
                $('form#send_feedback textarea').html(text + '\n\n').selectRange(text.length+2,text.length+2);
              }
              $('form#send_feedback').submit(function () {
              var success = function (response) {
                $('span#modal_error').html('');
                $('#send_feedback').html('');
                $('#modal_success').html(response);
                modalResize();
                setTimeout(function() {
                    $.modal.close();
                }, 2000);
              };
                var error = function (response) {$('span#modal_error').html(response);modalResize();};
                $.post("/home/send_feedback", $(this).serialize(), evalAjaxResponse({success: success, error:error}));
                return false;
              })
            }})
          }
          $.get("/home/feedback", {}, evalAjaxResponse({feedback: feedback}));
          return false;
        })

        // Form Submitting
        // This is needed for IE
        /*
        $('form input:password').live('keydown', function (e) {
          if (e.keyCode == 13) {
            $(this).closest('form').submit();
          }
        })
        */

        $('#header_login_form').submit(function () {
          $.post("/auth/ajax_login_submit", $(this).serialize(),
            evalAjaxResponse({
              error: function (data) {
                $('#header_login_form_error').html(data);
              },
              success: function (data) {window.location.reload()}
            })
          );
          // returning false stops the form from being submitted
          return false;
        });

          // Signup/Login modal tabs
          $('#modal_signup_tab').live('click', function() {
              $('#modal_login_tab').removeClass('active');
              $('#modal_login_tab').html('<span class="medium">Have an account? <a>Login</a>.</span>').addClass('mt_12').addClass('right').removeClass('left');
              $('#modal_signup_tab').html('<h2>Signup</h2>').removeClass('mt_12').removeClass('right').addClass('left');
              $('#modal_login').hide();
              $(this).addClass('active');
              $('#modal_signup').show();
              modalResize();
          });
          $('#modal_login_tab').live('click', function() {
              $('#modal_signup_tab').removeClass('active');
              $('#modal_signup_tab').html('<span class="medium">No account yet? <a>Signup</a>.</span>').addClass('mt_12').addClass('right').removeClass('left');
              $('#modal_login_tab').html('<h2>Login</h2>').removeClass('mt_12').removeClass('right').addClass('left');
              $('#modal_signup').hide();
              $(this).addClass('active');
              $('#modal_login').show();
              modalResize();
          });

          // Login dropdown
          $('.header_dropdown div.header_dropdown_main').click(function () {
              var outer = $(this).parent();
              if (outer.hasClass('active')) {
                outer.removeClass('active')
                .find('.header_dropdown_content').addClass('hide');
              } else {
                outer.addClass('active')
                .find('.header_dropdown_content').removeClass('hide');
                    outer.find('input[name=email]').focus();
              }
          });

          $('a.facebook_button').click(function () {
            var scope = "email";
            FB.login(function(response) {
                if (response.session) {
                  if (response.perms) {
                  // user is logged in and granted some permissions.
                  // perms is a comma separated list of granted permissions
                    var dict = {success: function (data) {$.modal.close(); window.location.reload()}}
                    $.get("/auth/signup_facebook", evalAjaxResponse(dict));
                  } else {
                  // user is logged in, but did not grant any permissions
                  } 
                } else {
                  // user is not logged in
                }
            }, {perms:scope});
          });

          // Set profile/settings/logout dropdown to larger width of name if applicable.
          
          $(document).mousedown(function (event) {
            if (!$(event.target).closest('.header_dropdown').length && !$(event.target).closest('.header_dropdown_content').length) {
                $('div.header_dropdown').removeClass('active')
                .find('.header_dropdown_content').addClass('hide');
            }
            if (!$(event.target).closest('.share_dropdown').length && !$(event.target).closest('.share').length) {
                $('div.share').removeClass('active')
                .find('.share_dropdown').addClass('hide');
            }
          });

          $('.removable_poster').live('mouseover', function () {
              $(this).find('.hover_x').removeClass('hide')
                     .end()
                     .find('.hover_x_bg').removeClass('hide');
          }).live('mouseout', function () {
              $(this).find('.hover_x').addClass('hide')
                     .end()
                     .find('.hover_x_bg').addClass('hide');
          });

          // Liking
          $('.like_count.off').live('click', function () {
            var heart = $(this);
            var type = heart.attr('type');
            if (!heart.hasClass('self')) {
                var review = heart.closest('.review');
                var response = {success: function () {
                  heart.html(parseInt(heart.html()) + 1);
                  heart.removeClass('off').addClass('on');
                  heart.attr('title', 'Click to unmark this ' + type + ' as helpful.');
                  heart.tipsy('hide');
                  mptrack('like');
                }}
                $.get('/home/like', {id: review.attr('id')}, evalAjaxResponse(response));
            }
          })

          $('.like_count.on').live('click', function () {
            var heart = $(this);
            var type = heart.attr('type');
            if (!heart.hasClass('self')) {
                var review = heart.closest('.review');
                var response = {success: function () {
                  heart.html(parseInt(heart.html()) - 1);
                  heart.removeClass('on').addClass('off');
                  heart.attr('title', 'Click to mark this ' + type + ' as helpful.');
                  heart.tipsy('hide');
                  mptrack('unlike');
                }}
                $.get('/home/unlike', {id: review.attr('id')}, evalAjaxResponse(response));
            }
          })

          // Behavior for submitting a review
          var review_form_submit = function () {
            var form = $(this).closest('form');
            var textarea = form.find('textarea');
            if (textarea.val().length > 200) {
              $.modal(countable_modal);
              return false;
            } else if ($.trim(textarea.val()) == '') {
              form.find('.cancel_review').click();
              return false;
            }
            var success = function (response) {
              /*
              form.closest('.review_box').replaceWith(response);
              form.closest('.review_box').find('textarea').autoResize({animate: false, extraSpace: 15});
              */
              mptrack('review');
              // Redirect to one_review
              window.location = response;
            }
            $.post('/home/add_quip', form.serialize(), evalAjaxResponse({success: success}));
            return false;
          }

          // This submission does not work in IE right now
          $('form.review_input_form').live('submit', review_form_submit);

          // Basic stuff for the interaction of the editable form
          $('.edit_link').live('click', function () {
            var parent = $(this).closest('.editable');
            parent.find('form.edit_form').removeClass('hide');
            parent.find('.edit_main').addClass('hide'); 
            parent.find('textarea').autoResize({animate: false, extraSpace: 15}).keydown();
          });

          $('.edit_cancel').live('click', function () {
            var parent = $(this).closest('.editable');
            parent.find('form.edit_form').addClass('hide');
            parent.find('.edit_main').removeClass('hide'); 
          });

          // For things like hiding long descriptions
          $('a.reveal_link', $('span.long_text')).live('click', function () {
            var root = $(this).closest('span.long_text');
            root.find('span.spacer_text').remove();
            $(this).remove();
            root.find('span.hidden_text').removeClass('hide');
            mptrack('reveal_description');
            return false;
          });

          // Like on review page
          $('.like.off').live('click', function(e) {
            var $this = $(this);
            var response = {success: function (data) {
                              $data = $(data);
                              $this.replaceWith($data);
                              $data.mouseover();
                            }}
            $.get('/home/like', {id: $this.attr('id')}, evalAjaxResponse(response))
          })

          $('.like.on').live('click', function(e) {
            var $this = $(this);
            var response = {success: function (data) {
                              $data = $(data);
                              $this.replaceWith($data);
                            }}
            $.get('/home/unlike', {id: $this.attr('id')}, evalAjaxResponse(response));
          }).live('mouseover', function(e) {
            var $this = $(this);
              $this.css('width', $this.css('width'));
              $this.find('div:last').html('Unlike');
          }).live('mouseout', function(e) {
            var $this = $(this);
            $this.find('div:last').html('You Like');
          });

          // Small Like
          $('.small_like.off').live('click', function(e) {
            var $this = $(this);
            var success = function (data) {
              $this.removeClass('off').addClass('on').html(parseInt($this.html()) + 1); 
            }
            $.get('/home/like', {id: $this.closest('.review').attr('id')}, evalAjaxResponse({success: success}))
          })

          $('.small_like.on').live('click', function(e) {
            var $this = $(this);
            var success = function (data) {
              $this.removeClass('on').addClass('off').html(parseInt($this.html()) - 1); 
            }
            $.get('/home/unlike', {id: $this.closest('.review').attr('id')}, evalAjaxResponse({success: success}));
          })

          // Reel
          var alter_reel = function (id, add, response) {
            if (add) {
              var u = "/home/reel";
            } else {
              var u = "/home/unreel";
            }
            $.get(u, {id: id}, evalAjaxResponse(response));
          }

          $('.reel.off').live('click', function(e) {
            var $this = $(this);
            var response = {success: function (data) {
                              $data = $(data);
                              $this.replaceWith($data);
                              $data.mouseover();
                              mptrack('media_action', {'type': 'watch_off'});
                              if (window.checkScroll != undefined) {
                                checkScroll();
                              }
                              if (load_suggs != undefined) {
                                load_suggs($this.attr('id'));
                              }
                            }}
            $.get('/home/reel', {id: $this.attr('id')}, evalAjaxResponse(response))
          })

          $('.reel.on').live('click', function(e) {
            var $this = $(this);
            var response = {success: function (data) {
                              $data = $(data);
                              $this.replaceWith($data);
                              mptrack('media_action', {'type': 'watch_on'});
                            }}
            $.get('/home/unreel', {id: $this.attr('id')}, evalAjaxResponse(response));
          });

          // Small On-hover Add Watchlist
          $('.small_add').live('click', function (event) {

            var $this = $(this);
            
            var toggle_add = function() {
              if ($this.hasClass('on')) {
                $this.removeClass('on');
                $this.addClass('on_hover');
                if ($this.hasClass('small_add') && !$this.closest('.active').length) {
                  $this.addClass('hide');
                }
              } else {
                $this.addClass('on');
                $this.removeClass('on_hover');
              };
            }

            var response = {success: toggle_add};
            var id = $this.closest('.hover_container').attr('id');
            alter_reel(id, !$this.hasClass('on'), response);
            event.preventDefault();
            return false;
          });

          // Follow
          $('.follow.off').live('click', function(e) {
            var $this = $(this);
            $this.tipsy('hide');
            var response = {success: function (data) {
                              $data = $(data);
                              $this.replaceWith($data);
                              $data.mouseover();
                              mptrack('follow_user', {'type': 'off'});
                            }}
            $.get('/home/follow', {id: $this.attr('id')}, evalAjaxResponse(response))
          })

          $('.follow.on').live('click', function(e) {
            var $this = $(this);
            var response = {success: function (data) {
                              $this.replaceWith(data);
                              mptrack('follow_user', {'type': 'on'});
                            }}
            $.get('/home/unfollow', {id: $this.attr('id')}, evalAjaxResponse(response))
          }).live('mouseover', function(e) {
            var $this = $(this);
            $this.css('width', $this.css('width'));
            $this.find('div:last').html('Unfollow');
          }).live('mouseout', function(e) {
            var $this = $(this);
            $this.find('div:last').html('Following');
          });

          // Not Interested (aka... skip / ignore)
          $('.ignore.off').live('click', function(e) {
            var $this = $(this);
            $this.tipsy('hide');
            var response = {success: function (data) {
                              $data = $(data);
                              $this.replaceWith($data);
                              $data.mouseover();
                            }}
            $.get('/home/ignore', {id: $this.attr('id')}, evalAjaxResponse(response))
          })

          $('.ignore.on').live('click', function(e) {
            var $this = $(this);
            var response = {success: function (data) {
                              $this.replaceWith(data);
                            }}
            $.get('/home/unignore', {id: $this.attr('id')}, evalAjaxResponse(response))
          });
          

          // Show Follow
          $('.show_follow.off').live('click', function(e) {
            var favorite = $(this);
            favorite.tipsy('hide');
            var response = {success: function (data) {
                              favorite.replaceWith(data);
                              mptrack('media_action', {'type': 'follow_off'});
                            }}
            $.get('/home/follow_show', {id: favorite.attr('id')}, evalAjaxResponse(response))
          })

          $('.show_follow.on').live('click', function(e) {
            var favorite = $(this);
            var response = {success: function (data) {
                              favorite.replaceWith(data);
                              mptrack('media_action', {'type': 'follow_on'});
                            }}
            $.get('/home/unfollow_show', {id: favorite.attr('id')}, evalAjaxResponse(response))
          })

          // Sharing Behavior
          // Facebook
          $('.share .facebook').live('click', function(e) {
            var response = {success: function (data) {
                              FB.ui(data, function(response) {
                                if (response && response.post_id) {
                                  // This means that the request went through
                                  mptrack('facebook', {'type': 'recommend'});
                                }
                              })}
                            };
            $.get('/share/facebook_recommend', {id: $(this).closest('.rater_container').attr('id')}, evalAjaxResponse(response));
            return false;
          });

          $('.share_review .facebook').live('click', function(e) {
            var response = {success: function (data) {
                              FB.ui(data, function(response) {
                                if (response && response.post_id) {
                                  // This means that the request went through
                                  mptrack('facebook', {'type': 'share_review'});
                                }
                              })}
                            };
            $.get('/share/facebook_review', {id: $(this).closest('.share_review').attr('id')}, evalAjaxResponse(response));
            return false;
          });

          $('.share_review .twitter').live('click', function(e) {
            var success = function (response) {
              var str = document.createElement('div');
              twttr.anywhere(function (T) {
                T(str).tweetBox({height: 100, width: 400, label: "Tweet this review", defaultContent: response});
                $(str).modal({minHeight:170, minWidth: 410, overlayClose:true});
              });
              mptrack('twitter', {'type': 'share_review'});
            }
            $.get('/share/twitter_review', {id: $(this).closest('.share_review').attr('id')}, evalAjaxResponse({success: success}));
            return false;
          })

          $('.share .twitter').live('click', function () {
            var success = function (response) {
              var str = document.createElement('div');
              twttr.anywhere(function (T) {
                T(str).tweetBox({height: 100, width: 400, label: 'Recommend on Twitter', defaultContent: response});
                $(str).css('padding', '10px').modal({minHeight:193, minWidth: 430, overlayClose:true});
                modalResize();
              });
              mptrack('twitter', {'type': 'recommend'});
            }
            $.get("/share/twitter_recommend", {id: $(this).closest('.rater_container').attr('id')}, evalAjaxResponse({success: success}));
            return false;
          });

          // See all
          $('a.see_all').click(function () {
            $(this).parent().next().children().removeClass('hide').show();
            $(this).remove();
          });

          // Reveal all
          $('a.reveal_all').click(function () {
            $(this).parent().children().removeClass('hide').show();
            $(this).remove();
          });

          $('.tipsy_n').tipsy({live: true, gravity: 'n'});
          $('.tipsy_s').tipsy({live: true, gravity: 's'});
          $('.tipsy_e').tipsy({live: true, gravity: 'e'});
          $('.tipsy_w').tipsy({live: true, gravity: 'w'});

          // Time Zones
          $.get('/home/tz', {tz: new Date().getTimezoneOffset()});

          $('a.logout').click(function () {
            setTimeout("$.get('/auth/logout', function () {window.location='/'})", 1000);
            mptrack('logout');
            FB.logout(function () {
              $.get('/auth/logout', function () {window.location='/'})
            })
            return false;
          })

          

          // Facebook Init
          window.fbAsyncInit = function () {
            FB.init({appId: '120416227995298', status: true, cookie: true,
                        xfbml: true});
          };
          (function() {
            var e = document.createElement('script'); e.async = true;
            e.src = document.location.protocol +
              '//connect.facebook.net/en_US/all.js';
            document.getElementById('fb-root').appendChild(e);
          }());

          (function() {
            var e = document.createElement('script'); e.async = true;
            e.src = document.location.protocol +
              "//platform.twitter.com/anywhere.js?id=otaH6BissRiIyOmEzGKMag&v=1";
            document.getElementById('fb-root').appendChild(e);
          }());

          (function() {
            var e = document.createElement('script'); e.async = true;
            e.src = document.location.protocol +
              "//jsapi.netflix.com/us/api/js/api.js";
            document.getElementById('fb-root').appendChild(e);
          }());

      });


      //NEW JS

        $('.trailer').click(function () {
           var youtube_src = $(this).attr('yt_target');
           str = "<div><object style='height:390px;width:640px;'><param name='movie' value='" + youtube_src + "?version=3&autoplay=1'><param name='allowFullScreen' value='true'><param name='allowScriptAccess' value='always'><embed src='" + youtube_src + "?version=3&autoplay=1' type='application/x-shockwave-flash' allowfullscreen='true' allowScriptAccess='always' width='640' height='390'></object></div>"
           $(str).modal({overlayClose:true});
        });

        var star_classes = {
                            '1': 'red',
                            '2': 'red',
                            '3': 'yellow',
                            '4': 'green',
                            '5': 'green'
                            };

        var star_descriptions = {
                                 '1': "Bad. Wouldn't recommend.",
                                 '2': "OK. Nothing special here.",
                                 '3': "Decent. Worth a watch.",
                                 '4': "Great. Would definitely recommend.",
                                 '5': "Excellent. An absolute must see!",
                                 }

        // Fn to color stars on mouse-over
        var color_stars = function() {
          $this = $(this);
          var parent = $this.parent();
          var star_class = star_classes[$this.attr('rating')];
          parent.children()
                .removeClass('grey red yellow green black')
                .each(function() {
                  if ($(this).attr('rating') > $this.attr('rating')) {
                    $(this).addClass('grey');
                  } else {
                    $(this).addClass(star_class);
                  };
                });
          parent.next('.rater_meta').html(star_descriptions[$this.attr('rating')]);
        };
       
        
        var rating_share_string = '<a class="vlink clear_rating left" title="Clear your rating.">clear</a><div class="left ml_20">&laquo; Share your rating:</div><div class="share left ml_10" style="margin-top:-3px;"><img class="twitter" src="/images/twitter_16.png" /> <img class="facebook" src="/images/facebook_16.png" /> </div>'

        // Fn to color stars on mouse-out
        var uncolor_stars = function() {
          var $this = $(this);
          var parent = $this.parent();
          parent.children()
                .removeClass('grey red yellow green black')
                .each(function() {
                  if ($(this).attr('rating') > parent.attr('rating')) {
                    $(this).addClass('grey');
                  } else {
                    $(this).addClass('black');
                  };  
                });
          if (parent.attr('rating') == 0) {
            parent.next('.rater_meta').html('&laquo Your rating');
          } else {
            parent.next('.rater_meta').html(rating_share_string);
          };
        };

        // Fn to set star rating state once a user clicks a star
        var set_stars = function(event) {
          var $this = $(this);
          var parent = $this.parent();
          var rating = $this.attr('rating');
          var container = $this.closest('.rater_container')

          var success = function (response) {
            parent.children()
                  .removeClass('grey red yellow green black')
                  .each(function() {
                    if ($(this).attr('rating') > $this.attr('rating')) {
                      $(this).addClass('grey');
                    } else {
                      $(this).addClass('black');
                    };
                  });
            parent.attr('rating', $this.attr('rating'));
            parent.next('.rater_meta').html(rating_share_string);
            parent.closest('.rater_container').siblings('.textarea_container').slideDown();
            mptrack('Rate');
            if (window.checkScroll != undefined) {
              checkScroll();
            }
          }

          $.get('/home/rate', {type: 'medium', id: container.attr('id'), rating: rating}, evalAjaxResponse({success: success}));
          event.preventDefault();
        };

        $('.write_review').live('click', function () {
          $(this).parent().siblings('.textarea_container').slideDown();
        })

        // Bind the star rating functions
        $('.rater div').live('mouseenter', color_stars)
                       .live('mouseleave', uncolor_stars)
                       .live('click', set_stars);

        $('.clear_rating').live('click', function() {
          $this = $(this);
          var container = $this.closest('.rater_container');
          var success = function () {
            var rater = container.find('.rater');
            container.siblings('.textarea_container').slideUp();
            rater.attr('rating', 0);
            rater.children().mouseout();
          }
          
          $.get('/home/rate', {type: 'medium', id: container.attr('id'), rating: 0}, evalAjaxResponse({success: success}));
        });

        $('.cancel_review').live('click', function() {
          var container = $(this).closest('.textarea_container');
          container.slideUp();
        })

        var hover_show = function() {
          $(this).addClass('active').find('.on_hover').removeClass('hide');
        }

        var hover_hide = function() {
          $(this).removeClass('active').find('.on_hover').addClass('hide');
        }

        $('.small_item_block').live('mouseenter', hover_show)
                              .live('mouseleave', hover_hide);

        $('.hover_container').live('mouseenter', hover_show)
                              .live('mouseleave', hover_hide);

        $('textarea').focus(function () {
          $(this).closest('.textarea_container').find('.on_focus').removeClass('hide');
        }).blur(function () {
          $(this).closest('.textarea_container').find('.on_focus').addClass('hide');
        });
  
        // Textarea clearing code
        $('textarea[name="review"]').focus(function () {
          if ($.trim($(this).val()) == 'Explain your rating in 200-characters?') {
             $(this).html('').focus();
          }
        })
    </script>
    
    <script type="text/javascript"> var mp_protocol = (('https:' == document.location.protocol) ? 'https://' : 'http://'); document.write(unescape('%3Cscript src="' + mp_protocol + 'api.mixpanel.com/site_media/js/api/mixpanel.js" type="text/javascript"%3E%3C/script%3E')); </script><script src="https://api.mixpanel.com/site_media/js/api/mixpanel.js" type="text/javascript"></script> <script type="text/javascript"> try {  var mpmetrics = new MixpanelLib('ccc2bdd53cb63f22161fee00ca2304f1'); } catch(err) { null_fn = function () {}; var mpmetrics = {  track: null_fn,  track_funnel: null_fn,  register: null_fn,  register_once: null_fn, register_funnel: null_fn }; } </script>
  












<!-- Nav Tab States -->






<!-- Subnav Tab States -->







<script language="javascript" type="text/javascript" src="https://s3.amazonaws.com/static.chartbeat.com/js/chartbeat.js"></script></body></html>