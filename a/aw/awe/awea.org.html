<!--The following is the downloaded HTML source of the awea.org privacy policy that was archived on 2012-06-23.
 Please check the original snapshot on the Wayback Machine (https://web.archive.org/web/20120623085809id_/http%3A//www.awea.org/privacy.cfm) for the most accurate reproduction.-->

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"><!-- Content Copyright American Wind Energy Association --><!-- Page generated 2012-05-18 13:12:53 by CommonSpot Build 6.1.0.222 (2011-03-13 20:01:21) --><!-- JavaScript & DHTML Code Copyright 1998-2011 PaperThin, Inc.  All rights reserved --><head> <title>Privacy Policy</title> <meta name="Description" id="Description" content="Privacy Policy">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="Keywords" id="Keywords" content="AWEA, American Wind Energy Association, Privacy Policy">
<meta name="Generator" id="Generator" content="CommonSpot Content Server Build 6.1.0.222">

<link rel="stylesheet" href="/ui/awea/css/all.css" type="text/css">
<link rel="stylesheet" href="/ui/awea/css/ataglance.css" type="text/css">
<link rel="stylesheet" href="/ui/awea/css/awea-styles.css" type="text/css">
<style type="text/css">
	.mw { color:#000000;font-family:Verdana,Arial,Helvetica;font-weight:bold;font-size:xx-small;text-decoration:none; }
	a.mw:link	{color:#000000;font-family:Verdana,Arial,Helvetica;font-weight:bold;font-size:xx-small;text-decoration:none;}
	a.mw:visited	{color:#000000;font-family:Verdana,Arial,Helvetica;font-weight:bold;font-size:xx-small;text-decoration:none;}
	a.mw:hover	{color:#0000FF;font-family:Verdana,Arial,Helvetica;font-weight:bold;font-size:xx-small;text-decoration:none;}
</style> <script type="text/javascript" async="" src="https://ssl.google-analytics.com/ga.js"></script><script type="text/javascript">
<!--
	var gMenuControlID = 0;
	var menus_included = 0;
	var jsDlgLoader = '/loader.cfm';
	var jsSiteID = 1;
	var jsSubSiteID = 1;
	var js_gvPageID = 7546;
	var jsPageID = 7546;
	var jsPageSetID = 0;
	var jsPageType = 0;
	var jsControlsWithRenderHandlers = ",3,4,37,1408,1491,1501,1501,1501,1543,1543,1641,1687,1687,1687,1699,1699,1699,1722,1738,1738,1738,5746,10603,10609,10827,11186,11304,11525,14833,14853,15390,15541,15621,15705,";
	var jsDefaultRenderHandlerProps = ",1687_1,1722_1,1738_1,1738_1,";
	var jsAuthorizedControls = ",1,2,3,4,6,7,8,9,10,11,16,18,20,21,22,23,25,26,27,28,29,30,31,34,36,37,38,39,40,41,42,43,44,45,46,47,50,51,52,53,54,1408,1491,1501,1543,1641,1687,1699,1722,1738,1906,5746,10603,10609,10827,11148,11186,11304,11525,12060,13686,14833,14853,15390,15541,15621,15705,";
	var jsCustomRenderHandlerPairs = "";
	var jsStandardRenderHandlers = "";
	var jsSiteSecurityCreateControls = 0;
	var jsShowRejectForApprover = 0;

	document.CS_StaticURL = "http://www.awea.org/";
	document.CS_DynamicURL = "http://www.awea.org/";
// -->
</script>
<script type="text/javascript" src="/commonspot/javascript/browser-all.js"></script> 

<link rel="shortcut icon" type="image/x-icon" href="/ui/awea/images/favicon.ico">
<link rel="stylesheet" type="text/css" href="/ui/awea/css/reset.css">
<link rel="stylesheet" type="text/css" href="/ui/awea/css/all.css">
<link rel="stylesheet" type="text/css" href="/ui/awea/css/accordion.css">

<style>
body {
  text-align: center;
  background: url(/ui/awea/images/bg.jpg) center top repeat-x; 
}
</style>



<!--[if lte IE 6]>
  <link rel="stylesheet" type="text/css" href="/ui/awea/css/ie.css" />
  <script type="text/javascript" src="/ui/awea/js/iepngfix_tilebg.js"></script>
<![endif]-->

<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>

<script type="text/javascript" src="/ui/awea/js/jquery.tipTip.min.js"></script>
<script type="text/javascript" src="/ui/awea/js/jquery.easing.1.3.js"></script>
<script type="text/javascript" src="/ui/awea/js/jquery.cycle.all.min.js"></script>
<script type="text/javascript" src="/ui/awea/js/jquery.tabs.js"></script>
<script type="text/javascript" src="/ui/awea/js/functions.js"></script>
<script type="text/javascript" src="/ui/awea/js/accordion.js"></script>



	<script type="text/javascript">
	//<![CDATA[  
	  $j(window).load(function(){
	    // Home slider 
	    $j("#home_slider").cycle({
	      pager:  '#home_slider_nav',
	      fx: 'scrollLeft',
	      timeout: 5000
	    });
		
	//To set the video toggle to always open on page load - Remove the // on the next three lines.
	//$j("a#toggle").addClass('clicked');
	//$j("a#toggle").css('background-image', 'url(images/img_toggle_click.png)');
	//$j("#video_toggle").slideToggle("slow");
		
	
	
		$j("a#toggle").click(function(){
			if($j(this).attr('class')=='clicked'){
				$j(this).removeClass('clicked');
				$j(this).css('background-image', 'url(/ui/awea/images/img_toggle.png)');
			}else{
				$j(this).addClass('clicked');
				$j(this).css('background-image', 'url(/ui/awea/images/img_toggle_click.png)');
			}
			$j("#video_toggle").slideToggle("slow");
			}
		);
	  });
	//]]>
</script>




<script type="text/javascript" src="http://partner.googleadservices.com/gampad/google_service.js">
</script>
<script type="text/javascript">
GS_googleAddAdSenseService("ca-pub-1980858508108791");
GS_googleEnableAllServices();
</script>
<script type="text/javascript">
GA_googleAddSlot("ca-pub-1980858508108791", "Content_Page_01");
GA_googleAddSlot("ca-pub-1980858508108791", "Content_Page_02");
GA_googleAddSlot("ca-pub-1980858508108791", "Content_Page_03");
GA_googleAddSlot("ca-pub-1980858508108791", "Homepage01");
GA_googleAddSlot("ca-pub-1980858508108791", "Homepage02");
GA_googleAddSlot("ca-pub-1980858508108791", "Homepage03");
GA_googleAddSlot("ca-pub-1980858508108791", "Small_Wind_01");
GA_googleAddSlot("ca-pub-1980858508108791", "Small_Wind_02");
GA_googleAddSlot("ca-pub-1980858508108791", "Small_Wind_03");
GA_googleAddSlot("ca-pub-1980858508108791", "Member_Center_01");
GA_googleAddSlot("ca-pub-1980858508108791", "Member_Center_02");
GA_googleAddSlot("ca-pub-1980858508108791", "Member_Center_03");
</script>
<script type="text/javascript">
GA_googleFetchAds();
</script>



<script type="text/javascript">
 
	  $j(document).ready(function(){
		
			function addLinkTag(id, url) {
			  var linkTag = document.createElement("link");                  
			  // Add script object attributes
			  linkTag.setAttribute("type", "text/css");
			  linkTag.setAttribute("href", url);
			  linkTag.setAttribute("id", id);
			  linkTag.setAttribute("rel", "stylesheet");
			  linkTag.setAttribute("charset", "utf-8");
			  // Write tag to the head
			  var head = document.getElementsByTagName("head").item(0);
			  head.appendChild(linkTag); 
				
		   }
		   
		   if ($j('.workshop').length) {
			
				   addLinkTag('workshop1', '/ui/awea/css/workshop_home.css');
				   addLinkTag('workshop2', '/ui/awea/css/ataglance.css');
				   addLinkTag('workshop3', '/ui/awea/css/jquery.tabs.css');
		   }
	  });
	  
					
	
</script>
		
		
<link rel="stylesheet" href="/commonspot/commonspot.css" type="text/css" id="cs_maincss"> <script id="null" type="text/javascript" src="/commonspot/javascript/lightbox/overrides.js">/* 
 * overrides.js   Copyright PaperThin, Inc.
 */
	
checkDlg = function()
{
	ResizeWindow();
}

CloseWindow = function()
{
	top.commonspot.lightbox.closeCurrent();
}

cs_OpenURLinOpener = function(workUrl)
{
	OpenURLInOpener(workUrl);
}

doCPOpenInOpener = function(workUrl)
{
	OpenURLInOpener(workUrl);
}

DoFocus = function(){};

handleLoad = function()
{
	ResizeWindow();
}

if (typeof handleLoad != 'function')
{
	handleLoad = function()
	{
		ResizeWindow();
	}
}	

csExtendedWindow = function(name, url, windowProps)
{
	var wnd = window.open(url, name, windowProps);
}
	
newWindow = function(name, url, customOverlayMsg, openInWindow, windowProps)
{
	var customOverlayMsg = customOverlayMsg ? customOverlayMsg : null;	
	var openInWindow = openInWindow ? openInWindow : false;
	var windowProps = windowProps ? windowProps : null;
	var wnd = top;
	var opr;
	var url = typeof url != 'undefined' ? url : '';
	if (openInWindow == true)
	{
		var wnd = window.open(url, name, windowProps);
		return wnd;
	}
	if (url.indexOf('/commonspot/dashboard/') == 0 || url.indexOf('controls/imagecommon/add-image') > 0)
	{	
		if (!top.commonspot.util.browser.valid)
		{
			alert('This functionality requires Internet Explorer versions 9 (or later) or Firefox Extended Support Release (ESR) versions or Safari 6 or 7 (only on Mac OS) or Chrome 31 (or later).');
			return;
		}
		var setupComplete = checkDashboardSetup();
		if (!setupComplete)
		{
			setTimeout(function(){
				newWindow(name, url, customOverlayMsg);
			},1);
			return;
		}	
	}	

	if (top.commonspot && top.commonspot.lightbox)
	{
		if (top.commonspot.lightbox.stack.length > 0)
			opr = top.commonspot.lightbox.stack.last().getWindow();	    
		top.commonspot.lightbox.openDialog(url, null, name, customOverlayMsg, null, opr);
		wnd = top.commonspot.lightbox.stack.last().getWindow();
	}
	return wnd;
}

OpenURLandClose = function(workUrl)
{
	var openerWin = top.commonspot.lightbox.getOpenerWindow();
	openerWin.location.href = workUrl;
	if (document.getElementById("leavewindowopen").checked == false)
	{
		setTimeout('window.close()', 250);
	}
}

OpenURLInOpener = function(workUrl)
{
	var openWin = top.commonspot.lightbox.getOpenerWindow();
	if (openWin)
	{
		openWin.location.href = workUrl;
	}	
}

RefreshAndCloseWindow = function(clearQueryParams)
{
	clearQueryParams = clearQueryParams ? clearQueryParams : 0;
	var openWin, openFrame;
	if (clearQueryParams)
	{
		ResetParentWindow();
		return;
	}
	try // without this try-catch IE throws Access Denied for dialogs called from site-admin
	{
		if (top.commonspot.util.browser.chrome || top.commonspot.util.browser.safari) //
		{
			openFrame = top.commonspot.lightbox.getOpenerLightboxFrame();
			// next line are exceptions to this special case, re accurev 17450 and 17894
			var doSpecialCase = openFrame
					&& (openFrame.src.indexOf('/dashboard/dialogs/siteadmin/metadata-form-addedit.html') === -1)
					&& (openFrame.src.indexOf('/commonspot/dashboard/null') === -1);
			if (doSpecialCase)
				openFrame.src = openFrame.contentWindow.location.href;
			else
			{
				openWin = top.commonspot.lightbox.getOpenerWindow();
				if (openWin)
					openWin.location.reload();			
			}
		}
		else
		{
			openWin = top.commonspot.lightbox.getOpenerWindow();
			if (openWin)
				openWin.location.reload();
		}
	}
	catch(e) {}	
	CloseWindow();
}

ResetParentWindow = function()
{
	var pWin = top.commonspot.lightbox.getOpenerWindow();
	try // without this try-catch IE throws Access Denied for dialogs called from site-admin
	{
		if (pWin)
		{
			var addPageInLView = 0;
			var pSearch = pWin.location.search;
			if (pSearch.indexOf('cs_pgIsInLView=1') >= 0)
				addPageInLView = 1;
			var pHref = pWin.location.href;
			if (pHref.length && pSearch.length)
				pHref = pHref.replace(pSearch, '');
			if (addPageInLView)
				pHref = pHref + '?cs_pgIsInLView=1';
			if (pHref != pWin.location.href)
				pWin.location.href = pHref;
			else
				pWin.location.reload();
		}	
	}
	catch(e) {}	
	CloseWindow();	
}


RefreshParentWindow = function()
{
	var openerWin = top.commonspot.lightbox.getOpenerWindow();
	pageid = openerWin.js_gvPageID;
	if (pageid > 0)
	{
		openerWin.document.cookie = "scrollPage=" + pageid;
		openerWin.document.cookie = "scrollX=" + cd_scrollLeft;
		openerWin.document.cookie = "scrollY=" + cd_scrollTop;
	}
	openerWin.location.reload();
	DoFocus(self);
	DoFocusDone=1;	// not done, but we don't want the focus
}

ResizeWindow = function(doRecalc, curTab)
{
	if (typeof ResizeWindowSafe != 'undefined')		// this variable is set in dlgcommon-head for legacy dialogs (initially set to 0, then to 1 upon calling dlgcommon-foot)
	{ 
		if (ResizeWindowSafe == 1)
			ResizeWindow_Meat(doRecalc, curTab);  // this function is defined in over-rides.js
		else
			ResizeWindowCalledCount = ResizeWindowCalledCount + 1;
	}
	else
		ResizeWindow_Meat(doRecalc, curTab);  // this function is defined in over-rides.js
}


ResizeWindow_Meat = function(doRecalc, currentTab)
{
	var maintable = document.getElementById('MainTable');
	if (maintable)
	{
		if (doRecalc)
		{
			if (top.commonspot)
			{
				top.commonspot.lightbox.initCurrentServerDialog(currentTab);
				ResizeWindow_Meat();
			}	
		}
		else
		{
			fixMinHeightAndWidth(maintable);
			if (top.commonspot)
			{
				top.commonspot.lightbox.initCurrent(maintable.offsetWidth+5, maintable.offsetHeight + 42);
				fixFooterWidth(maintable.offsetWidth,maintable.offsetHeight + 40);
			}	
		}	
		// to fix IE7 insanity! without this, in ie7 the maintable is not getting its gray background set.
		var mClass = maintable.className;
		if (mClass.indexOf('csMainTable') < 0)
			mClass += ' csMainTable';
		maintable.className = mClass;	
	}	
}	

fixMinHeightAndWidth = function(maintable)
{
	var curScript;
	var minWidth = 300;
	var minHeight = 130;
	// first check if there are tabs rendered in the dialog
	try
	{
		var ele = maintable.getElementsByClassName('cs_tab_active');
		if (ele.length > 2) 
			minWidth = 550;	
	}
	catch(e){};		
	// check if calendar field is rendered if so, we need the ht to be at least ht of the calendar.	
	var jsScripts = document.getElementsByTagName('SCRIPT');
	for (var i=0; i<jsScripts.length; i++)
	{
		curScript = jsScripts[i];
		try
		{
			if (curScript.src && (curScript.src).indexOf('calendar.js') >0)
				minHeight = 180;
		}
		catch(e){};
	
	}	
	if (maintable.offsetHeight < minHeight)
		maintable.style.height = minHeight+'px';
	else
		maintable.style.height = '';
	if (maintable.offsetWidth < minWidth)
		maintable.style.width = minWidth+'px';	
};

fixFooterWidth = function() 
{
	var proxyBtnTable = document.getElementById('clsProxyButtonTable');
	var maintable = document.getElementById('MainTable');
	//debugger;
	if (proxyBtnTable && maintable && proxyBtnTable.offsetWidth > (maintable.offsetWidth+10))
	{
		maintable.style.width = proxyBtnTable.offsetWidth + 'px';
		top.commonspot.lightbox.initCurrent(proxyBtnTable.offsetWidth, maintable.offsetHeight + 40);
	}
};

setthefocus = function(){};


checkDashboardSetup = function()
{
	if (top.commonspot.clientUI && top.commonspot.dialog && top.commonspot.dialog.server)
		return true;

	
	doDashboardSetup();
}

doDashboardSetup = function()
{
	if (parent.window.document.getElementById("hiddenframeDiv"))
		return true;
	if (document.parentWindow)
		var curWin = document.parentWindow;
	else
		var curWin = window;	
	var iframeDiv = curWin.parent.parent.document.createElement('div');
	iframeDiv.id = 'hiddenframeDiv';
	iframeDiv.style.left = '-1000px';
	iframeDiv.style.top = '-1000px';
	
	var iframeHTML = '<iframe src="/commonspot/dashboard/hidden_iframe.html" name="hidden_frame" id="hidden_frame" width="1" height="1" scrolling="no" frameborder="0"></iframe>';
	iframeDiv.innerHTML = iframeHTML;
	var hiddenFrame = iframeDiv.childNodes[0];
	parent.window.document.body.appendChild(iframeDiv);
	return true;
}

	
convertHrefToOnclick = function(doc, elemID)
{
	var newOC,existingOC,href,shown,style,isJS,itms;
	var elemID = elemID ? elemID : null;
	var doc = doc ? doc : document;
	if (elemID)
		itms = document.getElementById(elemID).getElementsByTagName('a');
	else
		itms = document.getElementsByTagName('a');
	for (var i=0; i<itms.length; i++)
	{
		elem = itms[i];
		href = elem.getAttribute('href');
		isJS = /javascript/.test(href);
		style = elem.style;
		shown = style ? style.display : '';
		// walk the links only if they have a href attrib and it is displayed	
		if (href && shown!='none' && href != '#' && isJS) 
		{
			newOC = href.replace(/javascript:/gi, '');
			if (newOC == ';') // handle situation where we have just javascript:; in href attribute
				newOC = '';
			existingOC = elem.getAttribute('onclick');
			// replace when newOC is not empty and not already in existingOC OR when there is no existingOC
			if ((existingOC && newOC != '' && existingOC.indexOf(newOC) == -1) || !existingOC )
				existingOC = (existingOC ? (existingOC + ';') : '') + newOC;
			elem.setAttribute('onclick', existingOC);
			elem.setAttribute('href', 'javascript:;');					
			//elem.removeAttribute('href');
		}		
	}
}

if (typeof(onLightboxLoad) == "undefined")
{
	/**
	* Hook that gets called by lightbox whenever the dialog gets loaded
	*/
	onLightboxLoad = function() 
	{	
		try{
			var rootDiv = document.getElementById('cs_commondlg')
		}catch(e){ 
			// $ function is not defined when there is an error. 
			// in that case, just return so we can show the error msg.
			return; 
		}	
		convertHrefToOnclick(document);
		if (rootDiv)
		{	 
			// Check if we have buttons
			
			var outerDiv = document.getElementById('clsPushButtonsDiv');
			var tableEle = document.getElementById('clsPushButtonsTable');
			var otherBtns = top.commonspot.util.dom.getElementsByClassName('clsDialogButton', document);
			if (tableEle || otherBtns.length)
			{
				// Remove existing "proxy" buttons first
				var btnHolder = document.getElementById('clsProxyButtonHolder');
				if (btnHolder)
				{
					btnHolder.parentNode.removeChild(btnHolder);
				}
				
				// check if cf debug is on
				var arr = top.commonspot.util.dom.getElementsByClassName('cfdebug', document);
				// Append a new <div> that will contain the "proxy" buttons
				var dom = document.createElement('div');
				dom.id = "clsProxyButtonHolder";
				dom.innerHTML = '<table id="clsProxyButtonTable" border="0" cellspacing="2" cellpadding="0"><tr><td id="clsProxySpellCheckCell" nowrap="nowrap"></td><td id="clsProxyButtonCell" nowrap="nowrap"></td></tr></table>';				
				if (arr.length > 0) 	// stick in after root div and before CF debug table
				{
					/*
						IE ver < 10 has problem with appending node before a script node. to get around it we add a div 
						node around	the script tags we have after rootDiv (dlgcommon-foot.cfm) and manipulate its innerHTML
						however, non-ie browsers has problem with manipulating innerHTML so doing it ol'way
					*/
					if (top.commonspot.util.browser.ie && top.commonspot.util.browser.version < 10)
					{
						var inHTML = dom.outerHTML + rootDiv.nextSibling.innerHTML;
						rootDiv.nextSibling.innerHTML = inHTML;
					}
					else
						rootDiv.parentNode.insertBefore(dom, rootDiv.nextElementSibling);
				}	
				else
					rootDiv.parentNode.appendChild(dom);

				proxySpellChecker($('clsProxySpellCheckCell'));
				proxyPushButtons($('clsProxyButtonCell'));
				// Hide the "real" buttons
				if (outerDiv)
					outerDiv.style.display='none';
				if (tableEle)
					tableEle.style.display='none';
			}
		}
	}
}	

proxyPushButtons = function(targetNode)
{
	var cellNode = $('clsProxyButtonCell');
	var buttons = $$('#clsPushButtonsTable input[type="submit"]', '#clsPushButtonsTable input[type="button"]');
	var moreButtons = top.commonspot.util.dom.getElementsByClassName('clsDialogButton', document, 'INPUT');
	var addClose = 0;
	for (var i=0; i<moreButtons.length; i++)
	{
		// lame! but FF is not happy with concat arrays feature;
		buttons.push(moreButtons[i]);
	}
	if ((buttons.length == 1 && buttons[0].value == 'Help') || buttons.length == 0)
		addClose = 1;
	cleanRadioAndCheckBoxes($$('#MainTable input[type="checkbox"]', '#MainTable input[type="radio"]'));
	var doneButtons = [];
	var buttonString = [];
	for(var i=0; i<buttons.length; i++)
	{
		buttons[i].style.display = 'none';
		var buttonText = buttons[i].value.replace(/^\s+|\s+$/g, '');
		buttonString[i] = buttonText.toLowerCase();
	}  
	// show prev button
	var indexButton = arrayIndexOf(buttonString,'prev');
	var proxyIndex = 1;
	if (indexButton != -1 && arrayIndexOf(doneButtons,'prev') == -1)    
	{
	  cellNode.appendChild(createProxyButton(buttons[indexButton],proxyIndex++));
	  doneButtons.push('prev');
	}

	// show next button
	indexButton = arrayIndexOf(buttonString,'next');
	if (indexButton != -1 && arrayIndexOf(doneButtons,'next') == -1)    
	{
	  cellNode.appendChild(createProxyButton(buttons[indexButton],proxyIndex++));
	  doneButtons.push('next');
	}      
    // show all misc. buttons that are not submit and not cancel or close
	for(var i=0; i<buttons.length; i++)
	{
		buttonText = buttons[i].value.replace(/^\s+|\s+$/g, '');
		if (buttonText != 'Help' && 
		      buttonText != 'Close' &&
				buttonText != 'No' &&
		      buttonText != 'Cancel' &&
		      buttons[i].type == 'button' &&
				arrayIndexOf(doneButtons,buttonText) == -1)
		{
			cellNode.appendChild(createProxyButton(buttons[i],proxyIndex++));
			doneButtons.push(buttonText);
		}
	}
     
     
	// show all submit buttons that are not cancel or close
	for(var i=0; i<buttons.length; i++)
	{
		buttonText = buttons[i].value.replace(/^\s+|\s+$/g, '');
		if (buttonText != 'Help' && 
					buttonText != 'Close' &&
					buttonText != 'No' &&
					buttonText != 'Cancel' &&
					buttons[i].type == 'submit' &&
					arrayIndexOf(doneButtons,buttonText) == -1)
		{
			cellNode.appendChild(createProxyButton(buttons[i],proxyIndex++));
			doneButtons.push(buttonText);
		}
	}     

	// show cancel and close buttons
	for(var i=0; i<buttons.length; i++)
	{
		buttonText = buttons[i].value.replace(/^\s+|\s+$/g, '');
		if (buttonText != 'Help' && arrayIndexOf(doneButtons,buttonText) == -1)
		{
			cellNode.appendChild(createProxyButton(buttons[i],proxyIndex++));
			doneButtons.push(buttonText);
		}   
	}  

	if (arrayIndexOf(doneButtons, 'cancel') != -1 || arrayIndexOf(doneButtons, 'close') != -1)
		addClose = 0;
	
	// show close button if there are no buttons in the lighbox
	if (addClose && cellNode)
	{
		var closeNode = {
			value: 'Close',
			className: 'clsCloseButton',
			type: 'button',
			name: 'Close'
		};
		cellNode.appendChild(createProxyButton(closeNode,proxyIndex++));
	} 
}

cleanRadioAndCheckBoxes = function(buttons)
{
   var cName = "";
   for (var i=0; i<buttons.length; i++)
   {
      cName = buttons[i].className;
      if (cName.indexOf('clsNoBorderInput')==-1)
      {
         buttons[i].className = cName+' clsNoBorderInput';
      }
   }
}
proxySpellChecker = function(targetNode)
{
	var boxNode = $('OldSpellCheckOn');
	// Proxy the node only if it's visible (it could be hidden)
	if (boxNode && (boxNode.type == 'checkbox'))
	{
		var proxyLabel = document.createElement('label');
		var proxyBox = document.createElement('input');
		proxyBox.setAttribute('id', 'SpellCheckOn');
		proxyBox.setAttribute('name', 'SpellCheckOn');
		proxyBox.setAttribute('type', 'checkbox');
		proxyBox.setAttribute('value', 1);
		proxyBox.className = 'clsNoBorderInput';
		proxyBox.onclick = function(){
			var o = $('OldSpellCheckOn');
			if (o)
				o.checked = this.checked;
		};
		proxyLabel.appendChild(proxyBox);
		proxyLabel.appendChild(document.createTextNode('Check Spelling'));
		targetNode.appendChild(proxyLabel);
		// Reflect original's status
		proxyBox.checked = boxNode.checked;
	}
}
			
/**
 * Helper method. Generate a proxy DOM node out of an original button
 * @param buttonNode   (node). Required. The original button DOM node
 * @return node
 */
createProxyButton = function(buttonNode,index)
{

	/*
	 Buttons must be styled to look as links. 
	 Since this can be tricky accross browsers, we wrap a <span> around the buttons 
	*/
	
	// Use trimmed value for text
	var buttonText = buttonNode.value.replace(/^\s+|\s+$/g, '');
	var newButtonText = buttonText;
	if (buttonText == 'OK' || buttonText == 'Finish')
		newButtonText = 'Save';    

	var proxyContainer = document.createElement('span');
	proxyContainer.id = 'proxyButton' + index; 
	if (buttonNode.title)
		proxyContainer.title = buttonNode.title;
	proxyContainer.className = buttonNode.className;  
	if ((buttonText == 'Cancel' || buttonText == 'Close') && 
				(buttonNode.className.indexOf('clsPushButton') >= 0 || buttonNode.className.indexOf('clsCancelButton') >= 0 || buttonNode.className.indexOf('clsCloseButton') >= 0)){
	  proxyContainer.className = 'cls'+buttonText+'Button';
	}

	var proxyBox = document.createElement('input');
	if (buttonNode.type == 'submit' && typeof buttonNode.click == 'function'){
	  proxyBox.setAttribute('type', 'button');
	}
	else{
		proxyBox.setAttribute('type', buttonNode.type);
	}   
	proxyBox.setAttribute('name', buttonNode.name);
	proxyBox.setAttribute('value', newButtonText);
	proxyBox.setAttribute('id', buttonText);

	if (newButtonText=='Cancel' || newButtonText=='Close')
	{
	  proxyContainer.onclick = function()
	  {
		if (typeof buttonNode.click == 'function' || typeof buttonNode.click == 'object')
		{
			buttonNode.click();
		}
		else
	      top.commonspot.lightbox.closeCurrent();
	  }
	}   
	else   
	{
		proxyContainer.onclick = function()
		{
			if (typeof buttonNode.click == 'function' || typeof buttonNode.click == 'object')
			{
				buttonNode.click();
			}	
			return false;
		}
	}		
	proxyBox.onmouseover = function()
	{
		this.style.textDecoration = 'underline';
		return false;
	}
	proxyBox.onmouseout = function()
	{
		this.style.textDecoration = 'none';
		return false;
	}	
	proxyContainer.appendChild(proxyBox);
	return proxyContainer;
}
/**
* Helper method.    Return index of an element in an array NOT case-sensitive.
* @param _this      Required. Array
 * @param x          Required. key
* @return index      
*/
arrayIndexOf = function(_this,x) 
{
   for(var i=0;i<_this.length;i++) 
   {
   	if (_this[i].toLowerCase()==x.toLowerCase()) 
   		return i;
   }
   return-1;
}   	
		

if (typeof(onLightboxResize) == "undefined")
{
	
	/**
	 * Hook that gets called by lightbox whenever the dialog gets resized
	 * @param w         (int). Required. Width
	 * @param h         (int). Required. Height
	 */
	onLightboxResize = function(w, h)
	{
		// Remove margins from the dialog's body
		document.body.style.margin = 0;
		document.body.style.padding = 0;
		var rootDiv = document.getElementById('cs_commondlg');
		if (rootDiv)
		{
			main_table = document.getElementById('MainTable');
			if (main_table && main_table.style)
			{
				main_table.style.width = (w-35)+'px';
				rootDiv.style.width = (w-10)+'px';
				main_table.style.height = (h -45) + 'px';
				main_table.style.marginTop = 0;
				rootDiv.style.marginTop = '10px';
				rootDiv.style.height = (h -37) + 'px';
			}	
				
			// Add scrollbars to the main box
			rootDiv.style.overflow = 'auto';
		}
	}

}

/*
     FILE ARCHIVED ON 22:38:43 Mar 29, 2019 AND RETRIEVED FROM THE
     INTERNET ARCHIVE ON 07:28:05 Feb 24, 2020.
     JAVASCRIPT APPENDED BY WAYBACK MACHINE, COPYRIGHT INTERNET ARCHIVE.

     ALL OTHER CONTENT MAY ALSO BE PROTECTED BY COPYRIGHT (17 U.S.C.
     SECTION 108(a)(3)).
*/
/*
playback timings (ms):
  LoadShardBlock: 52.931 (3)
  PetaboxLoader3.datanode: 1241.402 (4)
  exclusion.robots.policy: 0.125
  exclusion.robots: 0.134
  RedisCDXSource: 46.107
  CDXLines.iter: 11.684 (3)
  PetaboxLoader3.resolve: 63.411
  captures_list: 113.946
  esindex: 0.026
  load_resource: 1253.893
*/</script><script id="cs_util_js" type="text/javascript" src="/commonspot/javascript/util.js">/* 
 * overrides.js   Copyright PaperThin, Inc.
 */
	
checkDlg = function()
{
	ResizeWindow();
}

CloseWindow = function()
{
	top.commonspot.lightbox.closeCurrent();
}

cs_OpenURLinOpener = function(workUrl)
{
	OpenURLInOpener(workUrl);
}

doCPOpenInOpener = function(workUrl)
{
	OpenURLInOpener(workUrl);
}

DoFocus = function(){};

handleLoad = function()
{
	ResizeWindow();
}

if (typeof handleLoad != 'function')
{
	handleLoad = function()
	{
		ResizeWindow();
	}
}	

csExtendedWindow = function(name, url, windowProps)
{
	var wnd = window.open(url, name, windowProps);
}
	
newWindow = function(name, url, customOverlayMsg, openInWindow, windowProps)
{
	var customOverlayMsg = customOverlayMsg ? customOverlayMsg : null;	
	var openInWindow = openInWindow ? openInWindow : false;
	var windowProps = windowProps ? windowProps : null;
	var wnd = top;
	var opr;
	var url = typeof url != 'undefined' ? url : '';
	if (openInWindow == true)
	{
		var wnd = window.open(url, name, windowProps);
		return wnd;
	}
	if (url.indexOf('/commonspot/dashboard/') == 0 || url.indexOf('controls/imagecommon/add-image') > 0)
	{	
		if (!top.commonspot.util.browser.valid)
		{
			alert('This functionality requires Internet Explorer versions 9 (or later) or Firefox Extended Support Release (ESR) versions or Safari 6 or 7 (only on Mac OS) or Chrome 31 (or later).');
			return;
		}
		var setupComplete = checkDashboardSetup();
		if (!setupComplete)
		{
			setTimeout(function(){
				newWindow(name, url, customOverlayMsg);
			},1);
			return;
		}	
	}	

	if (top.commonspot && top.commonspot.lightbox)
	{
		if (top.commonspot.lightbox.stack.length > 0)
			opr = top.commonspot.lightbox.stack.last().getWindow();	    
		top.commonspot.lightbox.openDialog(url, null, name, customOverlayMsg, null, opr);
		wnd = top.commonspot.lightbox.stack.last().getWindow();
	}
	return wnd;
}

OpenURLandClose = function(workUrl)
{
	var openerWin = top.commonspot.lightbox.getOpenerWindow();
	openerWin.location.href = workUrl;
	if (document.getElementById("leavewindowopen").checked == false)
	{
		setTimeout('window.close()', 250);
	}
}

OpenURLInOpener = function(workUrl)
{
	var openWin = top.commonspot.lightbox.getOpenerWindow();
	if (openWin)
	{
		openWin.location.href = workUrl;
	}	
}

RefreshAndCloseWindow = function(clearQueryParams)
{
	clearQueryParams = clearQueryParams ? clearQueryParams : 0;
	var openWin, openFrame;
	if (clearQueryParams)
	{
		ResetParentWindow();
		return;
	}
	try // without this try-catch IE throws Access Denied for dialogs called from site-admin
	{
		if (top.commonspot.util.browser.chrome || top.commonspot.util.browser.safari) //
		{
			openFrame = top.commonspot.lightbox.getOpenerLightboxFrame();
			// next line are exceptions to this special case, re accurev 17450 and 17894
			var doSpecialCase = openFrame
					&& (openFrame.src.indexOf('/dashboard/dialogs/siteadmin/metadata-form-addedit.html') === -1)
					&& (openFrame.src.indexOf('/commonspot/dashboard/null') === -1);
			if (doSpecialCase)
				openFrame.src = openFrame.contentWindow.location.href;
			else
			{
				openWin = top.commonspot.lightbox.getOpenerWindow();
				if (openWin)
					openWin.location.reload();			
			}
		}
		else
		{
			openWin = top.commonspot.lightbox.getOpenerWindow();
			if (openWin)
				openWin.location.reload();
		}
	}
	catch(e) {}	
	CloseWindow();
}

ResetParentWindow = function()
{
	var pWin = top.commonspot.lightbox.getOpenerWindow();
	try // without this try-catch IE throws Access Denied for dialogs called from site-admin
	{
		if (pWin)
		{
			var addPageInLView = 0;
			var pSearch = pWin.location.search;
			if (pSearch.indexOf('cs_pgIsInLView=1') >= 0)
				addPageInLView = 1;
			var pHref = pWin.location.href;
			if (pHref.length && pSearch.length)
				pHref = pHref.replace(pSearch, '');
			if (addPageInLView)
				pHref = pHref + '?cs_pgIsInLView=1';
			if (pHref != pWin.location.href)
				pWin.location.href = pHref;
			else
				pWin.location.reload();
		}	
	}
	catch(e) {}	
	CloseWindow();	
}


RefreshParentWindow = function()
{
	var openerWin = top.commonspot.lightbox.getOpenerWindow();
	pageid = openerWin.js_gvPageID;
	if (pageid > 0)
	{
		openerWin.document.cookie = "scrollPage=" + pageid;
		openerWin.document.cookie = "scrollX=" + cd_scrollLeft;
		openerWin.document.cookie = "scrollY=" + cd_scrollTop;
	}
	openerWin.location.reload();
	DoFocus(self);
	DoFocusDone=1;	// not done, but we don't want the focus
}

ResizeWindow = function(doRecalc, curTab)
{
	if (typeof ResizeWindowSafe != 'undefined')		// this variable is set in dlgcommon-head for legacy dialogs (initially set to 0, then to 1 upon calling dlgcommon-foot)
	{ 
		if (ResizeWindowSafe == 1)
			ResizeWindow_Meat(doRecalc, curTab);  // this function is defined in over-rides.js
		else
			ResizeWindowCalledCount = ResizeWindowCalledCount + 1;
	}
	else
		ResizeWindow_Meat(doRecalc, curTab);  // this function is defined in over-rides.js
}


ResizeWindow_Meat = function(doRecalc, currentTab)
{
	var maintable = document.getElementById('MainTable');
	if (maintable)
	{
		if (doRecalc)
		{
			if (top.commonspot)
			{
				top.commonspot.lightbox.initCurrentServerDialog(currentTab);
				ResizeWindow_Meat();
			}	
		}
		else
		{
			fixMinHeightAndWidth(maintable);
			if (top.commonspot)
			{
				top.commonspot.lightbox.initCurrent(maintable.offsetWidth+5, maintable.offsetHeight + 42);
				fixFooterWidth(maintable.offsetWidth,maintable.offsetHeight + 40);
			}	
		}	
		// to fix IE7 insanity! without this, in ie7 the maintable is not getting its gray background set.
		var mClass = maintable.className;
		if (mClass.indexOf('csMainTable') < 0)
			mClass += ' csMainTable';
		maintable.className = mClass;	
	}	
}	

fixMinHeightAndWidth = function(maintable)
{
	var curScript;
	var minWidth = 300;
	var minHeight = 130;
	// first check if there are tabs rendered in the dialog
	try
	{
		var ele = maintable.getElementsByClassName('cs_tab_active');
		if (ele.length > 2) 
			minWidth = 550;	
	}
	catch(e){};		
	// check if calendar field is rendered if so, we need the ht to be at least ht of the calendar.	
	var jsScripts = document.getElementsByTagName('SCRIPT');
	for (var i=0; i<jsScripts.length; i++)
	{
		curScript = jsScripts[i];
		try
		{
			if (curScript.src && (curScript.src).indexOf('calendar.js') >0)
				minHeight = 180;
		}
		catch(e){};
	
	}	
	if (maintable.offsetHeight < minHeight)
		maintable.style.height = minHeight+'px';
	else
		maintable.style.height = '';
	if (maintable.offsetWidth < minWidth)
		maintable.style.width = minWidth+'px';	
};

fixFooterWidth = function() 
{
	var proxyBtnTable = document.getElementById('clsProxyButtonTable');
	var maintable = document.getElementById('MainTable');
	//debugger;
	if (proxyBtnTable && maintable && proxyBtnTable.offsetWidth > (maintable.offsetWidth+10))
	{
		maintable.style.width = proxyBtnTable.offsetWidth + 'px';
		top.commonspot.lightbox.initCurrent(proxyBtnTable.offsetWidth, maintable.offsetHeight + 40);
	}
};

setthefocus = function(){};


checkDashboardSetup = function()
{
	if (top.commonspot.clientUI && top.commonspot.dialog && top.commonspot.dialog.server)
		return true;

	
	doDashboardSetup();
}

doDashboardSetup = function()
{
	if (parent.window.document.getElementById("hiddenframeDiv"))
		return true;
	if (document.parentWindow)
		var curWin = document.parentWindow;
	else
		var curWin = window;	
	var iframeDiv = curWin.parent.parent.document.createElement('div');
	iframeDiv.id = 'hiddenframeDiv';
	iframeDiv.style.left = '-1000px';
	iframeDiv.style.top = '-1000px';
	
	var iframeHTML = '<iframe src="/commonspot/dashboard/hidden_iframe.html" name="hidden_frame" id="hidden_frame" width="1" height="1" scrolling="no" frameborder="0"></iframe>';
	iframeDiv.innerHTML = iframeHTML;
	var hiddenFrame = iframeDiv.childNodes[0];
	parent.window.document.body.appendChild(iframeDiv);
	return true;
}

	
convertHrefToOnclick = function(doc, elemID)
{
	var newOC,existingOC,href,shown,style,isJS,itms;
	var elemID = elemID ? elemID : null;
	var doc = doc ? doc : document;
	if (elemID)
		itms = document.getElementById(elemID).getElementsByTagName('a');
	else
		itms = document.getElementsByTagName('a');
	for (var i=0; i<itms.length; i++)
	{
		elem = itms[i];
		href = elem.getAttribute('href');
		isJS = /javascript/.test(href);
		style = elem.style;
		shown = style ? style.display : '';
		// walk the links only if they have a href attrib and it is displayed	
		if (href && shown!='none' && href != '#' && isJS) 
		{
			newOC = href.replace(/javascript:/gi, '');
			if (newOC == ';') // handle situation where we have just javascript:; in href attribute
				newOC = '';
			existingOC = elem.getAttribute('onclick');
			// replace when newOC is not empty and not already in existingOC OR when there is no existingOC
			if ((existingOC && newOC != '' && existingOC.indexOf(newOC) == -1) || !existingOC )
				existingOC = (existingOC ? (existingOC + ';') : '') + newOC;
			elem.setAttribute('onclick', existingOC);
			elem.setAttribute('href', 'javascript:;');					
			//elem.removeAttribute('href');
		}		
	}
}

if (typeof(onLightboxLoad) == "undefined")
{
	/**
	* Hook that gets called by lightbox whenever the dialog gets loaded
	*/
	onLightboxLoad = function() 
	{	
		try{
			var rootDiv = document.getElementById('cs_commondlg')
		}catch(e){ 
			// $ function is not defined when there is an error. 
			// in that case, just return so we can show the error msg.
			return; 
		}	
		convertHrefToOnclick(document);
		if (rootDiv)
		{	 
			// Check if we have buttons
			
			var outerDiv = document.getElementById('clsPushButtonsDiv');
			var tableEle = document.getElementById('clsPushButtonsTable');
			var otherBtns = top.commonspot.util.dom.getElementsByClassName('clsDialogButton', document);
			if (tableEle || otherBtns.length)
			{
				// Remove existing "proxy" buttons first
				var btnHolder = document.getElementById('clsProxyButtonHolder');
				if (btnHolder)
				{
					btnHolder.parentNode.removeChild(btnHolder);
				}
				
				// check if cf debug is on
				var arr = top.commonspot.util.dom.getElementsByClassName('cfdebug', document);
				// Append a new <div> that will contain the "proxy" buttons
				var dom = document.createElement('div');
				dom.id = "clsProxyButtonHolder";
				dom.innerHTML = '<table id="clsProxyButtonTable" border="0" cellspacing="2" cellpadding="0"><tr><td id="clsProxySpellCheckCell" nowrap="nowrap"></td><td id="clsProxyButtonCell" nowrap="nowrap"></td></tr></table>';				
				if (arr.length > 0) 	// stick in after root div and before CF debug table
				{
					/*
						IE ver < 10 has problem with appending node before a script node. to get around it we add a div 
						node around	the script tags we have after rootDiv (dlgcommon-foot.cfm) and manipulate its innerHTML
						however, non-ie browsers has problem with manipulating innerHTML so doing it ol'way
					*/
					if (top.commonspot.util.browser.ie && top.commonspot.util.browser.version < 10)
					{
						var inHTML = dom.outerHTML + rootDiv.nextSibling.innerHTML;
						rootDiv.nextSibling.innerHTML = inHTML;
					}
					else
						rootDiv.parentNode.insertBefore(dom, rootDiv.nextElementSibling);
				}	
				else
					rootDiv.parentNode.appendChild(dom);

				proxySpellChecker($('clsProxySpellCheckCell'));
				proxyPushButtons($('clsProxyButtonCell'));
				// Hide the "real" buttons
				if (outerDiv)
					outerDiv.style.display='none';
				if (tableEle)
					tableEle.style.display='none';
			}
		}
	}
}	

proxyPushButtons = function(targetNode)
{
	var cellNode = $('clsProxyButtonCell');
	var buttons = $$('#clsPushButtonsTable input[type="submit"]', '#clsPushButtonsTable input[type="button"]');
	var moreButtons = top.commonspot.util.dom.getElementsByClassName('clsDialogButton', document, 'INPUT');
	var addClose = 0;
	for (var i=0; i<moreButtons.length; i++)
	{
		// lame! but FF is not happy with concat arrays feature;
		buttons.push(moreButtons[i]);
	}
	if ((buttons.length == 1 && buttons[0].value == 'Help') || buttons.length == 0)
		addClose = 1;
	cleanRadioAndCheckBoxes($$('#MainTable input[type="checkbox"]', '#MainTable input[type="radio"]'));
	var doneButtons = [];
	var buttonString = [];
	for(var i=0; i<buttons.length; i++)
	{
		buttons[i].style.display = 'none';
		var buttonText = buttons[i].value.replace(/^\s+|\s+$/g, '');
		buttonString[i] = buttonText.toLowerCase();
	}  
	// show prev button
	var indexButton = arrayIndexOf(buttonString,'prev');
	var proxyIndex = 1;
	if (indexButton != -1 && arrayIndexOf(doneButtons,'prev') == -1)    
	{
	  cellNode.appendChild(createProxyButton(buttons[indexButton],proxyIndex++));
	  doneButtons.push('prev');
	}

	// show next button
	indexButton = arrayIndexOf(buttonString,'next');
	if (indexButton != -1 && arrayIndexOf(doneButtons,'next') == -1)    
	{
	  cellNode.appendChild(createProxyButton(buttons[indexButton],proxyIndex++));
	  doneButtons.push('next');
	}      
    // show all misc. buttons that are not submit and not cancel or close
	for(var i=0; i<buttons.length; i++)
	{
		buttonText = buttons[i].value.replace(/^\s+|\s+$/g, '');
		if (buttonText != 'Help' && 
		      buttonText != 'Close' &&
				buttonText != 'No' &&
		      buttonText != 'Cancel' &&
		      buttons[i].type == 'button' &&
				arrayIndexOf(doneButtons,buttonText) == -1)
		{
			cellNode.appendChild(createProxyButton(buttons[i],proxyIndex++));
			doneButtons.push(buttonText);
		}
	}
     
     
	// show all submit buttons that are not cancel or close
	for(var i=0; i<buttons.length; i++)
	{
		buttonText = buttons[i].value.replace(/^\s+|\s+$/g, '');
		if (buttonText != 'Help' && 
					buttonText != 'Close' &&
					buttonText != 'No' &&
					buttonText != 'Cancel' &&
					buttons[i].type == 'submit' &&
					arrayIndexOf(doneButtons,buttonText) == -1)
		{
			cellNode.appendChild(createProxyButton(buttons[i],proxyIndex++));
			doneButtons.push(buttonText);
		}
	}     

	// show cancel and close buttons
	for(var i=0; i<buttons.length; i++)
	{
		buttonText = buttons[i].value.replace(/^\s+|\s+$/g, '');
		if (buttonText != 'Help' && arrayIndexOf(doneButtons,buttonText) == -1)
		{
			cellNode.appendChild(createProxyButton(buttons[i],proxyIndex++));
			doneButtons.push(buttonText);
		}   
	}  

	if (arrayIndexOf(doneButtons, 'cancel') != -1 || arrayIndexOf(doneButtons, 'close') != -1)
		addClose = 0;
	
	// show close button if there are no buttons in the lighbox
	if (addClose && cellNode)
	{
		var closeNode = {
			value: 'Close',
			className: 'clsCloseButton',
			type: 'button',
			name: 'Close'
		};
		cellNode.appendChild(createProxyButton(closeNode,proxyIndex++));
	} 
}

cleanRadioAndCheckBoxes = function(buttons)
{
   var cName = "";
   for (var i=0; i<buttons.length; i++)
   {
      cName = buttons[i].className;
      if (cName.indexOf('clsNoBorderInput')==-1)
      {
         buttons[i].className = cName+' clsNoBorderInput';
      }
   }
}
proxySpellChecker = function(targetNode)
{
	var boxNode = $('OldSpellCheckOn');
	// Proxy the node only if it's visible (it could be hidden)
	if (boxNode && (boxNode.type == 'checkbox'))
	{
		var proxyLabel = document.createElement('label');
		var proxyBox = document.createElement('input');
		proxyBox.setAttribute('id', 'SpellCheckOn');
		proxyBox.setAttribute('name', 'SpellCheckOn');
		proxyBox.setAttribute('type', 'checkbox');
		proxyBox.setAttribute('value', 1);
		proxyBox.className = 'clsNoBorderInput';
		proxyBox.onclick = function(){
			var o = $('OldSpellCheckOn');
			if (o)
				o.checked = this.checked;
		};
		proxyLabel.appendChild(proxyBox);
		proxyLabel.appendChild(document.createTextNode('Check Spelling'));
		targetNode.appendChild(proxyLabel);
		// Reflect original's status
		proxyBox.checked = boxNode.checked;
	}
}
			
/**
 * Helper method. Generate a proxy DOM node out of an original button
 * @param buttonNode   (node). Required. The original button DOM node
 * @return node
 */
createProxyButton = function(buttonNode,index)
{

	/*
	 Buttons must be styled to look as links. 
	 Since this can be tricky accross browsers, we wrap a <span> around the buttons 
	*/
	
	// Use trimmed value for text
	var buttonText = buttonNode.value.replace(/^\s+|\s+$/g, '');
	var newButtonText = buttonText;
	if (buttonText == 'OK' || buttonText == 'Finish')
		newButtonText = 'Save';    

	var proxyContainer = document.createElement('span');
	proxyContainer.id = 'proxyButton' + index; 
	if (buttonNode.title)
		proxyContainer.title = buttonNode.title;
	proxyContainer.className = buttonNode.className;  
	if ((buttonText == 'Cancel' || buttonText == 'Close') && 
				(buttonNode.className.indexOf('clsPushButton') >= 0 || buttonNode.className.indexOf('clsCancelButton') >= 0 || buttonNode.className.indexOf('clsCloseButton') >= 0)){
	  proxyContainer.className = 'cls'+buttonText+'Button';
	}

	var proxyBox = document.createElement('input');
	if (buttonNode.type == 'submit' && typeof buttonNode.click == 'function'){
	  proxyBox.setAttribute('type', 'button');
	}
	else{
		proxyBox.setAttribute('type', buttonNode.type);
	}   
	proxyBox.setAttribute('name', buttonNode.name);
	proxyBox.setAttribute('value', newButtonText);
	proxyBox.setAttribute('id', buttonText);

	if (newButtonText=='Cancel' || newButtonText=='Close')
	{
	  proxyContainer.onclick = function()
	  {
		if (typeof buttonNode.click == 'function' || typeof buttonNode.click == 'object')
		{
			buttonNode.click();
		}
		else
	      top.commonspot.lightbox.closeCurrent();
	  }
	}   
	else   
	{
		proxyContainer.onclick = function()
		{
			if (typeof buttonNode.click == 'function' || typeof buttonNode.click == 'object')
			{
				buttonNode.click();
			}	
			return false;
		}
	}		
	proxyBox.onmouseover = function()
	{
		this.style.textDecoration = 'underline';
		return false;
	}
	proxyBox.onmouseout = function()
	{
		this.style.textDecoration = 'none';
		return false;
	}	
	proxyContainer.appendChild(proxyBox);
	return proxyContainer;
}
/**
* Helper method.    Return index of an element in an array NOT case-sensitive.
* @param _this      Required. Array
 * @param x          Required. key
* @return index      
*/
arrayIndexOf = function(_this,x) 
{
   for(var i=0;i<_this.length;i++) 
   {
   	if (_this[i].toLowerCase()==x.toLowerCase()) 
   		return i;
   }
   return-1;
}   	
		

if (typeof(onLightboxResize) == "undefined")
{
	
	/**
	 * Hook that gets called by lightbox whenever the dialog gets resized
	 * @param w         (int). Required. Width
	 * @param h         (int). Required. Height
	 */
	onLightboxResize = function(w, h)
	{
		// Remove margins from the dialog's body
		document.body.style.margin = 0;
		document.body.style.padding = 0;
		var rootDiv = document.getElementById('cs_commondlg');
		if (rootDiv)
		{
			main_table = document.getElementById('MainTable');
			if (main_table && main_table.style)
			{
				main_table.style.width = (w-35)+'px';
				rootDiv.style.width = (w-10)+'px';
				main_table.style.height = (h -45) + 'px';
				main_table.style.marginTop = 0;
				rootDiv.style.marginTop = '10px';
				rootDiv.style.height = (h -37) + 'px';
			}	
				
			// Add scrollbars to the main box
			rootDiv.style.overflow = 'auto';
		}
	}

}

/*
     FILE ARCHIVED ON 22:38:43 Mar 29, 2019 AND RETRIEVED FROM THE
     INTERNET ARCHIVE ON 07:28:05 Feb 24, 2020.
     JAVASCRIPT APPENDED BY WAYBACK MACHINE, COPYRIGHT INTERNET ARCHIVE.

     ALL OTHER CONTENT MAY ALSO BE PROTECTED BY COPYRIGHT (17 U.S.C.
     SECTION 108(a)(3)).
*/
/*
playback timings (ms):
  LoadShardBlock: 52.931 (3)
  PetaboxLoader3.datanode: 1241.402 (4)
  exclusion.robots.policy: 0.125
  exclusion.robots: 0.134
  RedisCDXSource: 46.107
  CDXLines.iter: 11.684 (3)
  PetaboxLoader3.resolve: 63.411
  captures_list: 113.946
  esindex: 0.026
  load_resource: 1253.893
*/</script><link id="buttons_css" type="text/css" href="/commonspot/dashboard/css/buttons.css" rel="stylesheet"><link id="cs_lightbox_css" type="text/css" href="/commonspot/javascript/lightbox/lightbox.css" rel="stylesheet"><script id="cs_lightbox_js" type="text/javascript" src="/commonspot/javascript/lightbox/lightbox.js">/**
 * commonspot.lightbox: lightbox package
 */
if (typeof commonspot == 'undefined')
	commonspot = {};
commonspot.lightbox = {};
// Stack holding the currently opened lightboxes
commonspot.lightbox.stack = [];
// Defaults for size and position
commonspot.lightbox.DEFAULT_TOP = 20;
commonspot.lightbox.DIALOG_DEFAULT_WIDTH = 100;
commonspot.lightbox.DIALOG_DEFAULT_HEIGHT = 100;
commonspot.lightbox.WINDOW_MARGINS = 30;
// Constrains from XHTML/CSS and images
commonspot.lightbox.FURNITURE_HEIGHT = 70;
commonspot.lightbox.FURNITURE_WIDTH = 20;
commonspot.lightbox.CORNERS_WIDTH = 20;
// constant to request no overlay msg
commonspot.lightbox.NO_OVERLAY_MSG = 'NONE';
commonspot.lightbox.helpDlg = null;

var _startX = 0; // mouse starting positions 
var _startY = 0; 
var _offsetX = 0; // current element offset 
var _offsetY = 0; 
var _dragElement; // needs to be passed from OnMouseDown to OnMouseMove 
var _oldZIndex = 0; // we temporarily increase the z-index during drag 
var _debug = top.document.getElementById('debug');

/**
 * Adjust layout. To call if vieport's dimensions changed
 */
commonspot.lightbox.adjustLayout = function()
{
	for(var i = 0; i < commonspot.lightbox.stack.length; i++)
		commonspot.lightbox.stack[i].adjustLayout();
};

commonspot.lightbox.openURL = function(options)
{
	var options = options || {};
	var defaultOptions =
	{
		title: "Custom Dialog",
		subtitle: "",
		helpId: "",
		width: 100,
		name: 'customDlg',
		height: 50,
		hasMaximizeIcon: true,
		hasCloseIcon: true,
		hasHelpIcon: false,
		hasReloadIcon: false,
		url: "/commonspot/dashboard/dialogs/blank-dialog.html",
		dialogType: "dialog"
	};	
	commonspot.util.merge(options, defaultOptions);
	var hideClose = !options.hasCloseIcon;
	var hideHelp = !options.hasHelpIcon;
	var hideReload = !options.hasReloadIcon;
	var dlgObj = commonspot.lightbox.openDialog(defaultOptions.url, hideClose, options.name, commonspot.lightbox.NO_OVERLAY_MSG, options.dialogType, null, hideHelp, hideReload);

	commonspot.lightbox.initCurrent(defaultOptions.width, defaultOptions.height, {title: options.title, subtitle: options.subtitle, reload: options.hasReloadIcon, helpId: options.helpId, maximize: options.hasMaximizeIcon}); 
	dlgObj.iframeNode.src = options.url;
	setTimeout(function() {
		commonspot.lightbox.resizeCurrent(options.width, options.height);
	}, 50);
}

commonspot.lightbox.openDialogWithParams = function(url, params, hideClose, name, customOverlayMsg, dialogType, opener, hideHelp, hideReload)
{
	commonspot.lightbox.openDialog (url, hideClose, name, customOverlayMsg, dialogType, opener, hideHelp, hideReload, params)
}

/**
 * Open either a url or a document DOM inside a lightbox
 * @param url  (string). Required
 * @param hideClose  (boolean). Optional. Set it to true to remove the close button from furniture's top right corner
 * @param hideHelp (boolean). Optional. Set it to true for the dialogs that do not need the Help Button and the QAHelp Processing.
 */
commonspot.lightbox.openDialog = function(url, hideClose, name, customOverlayMsg, dialogType, opener, hideHelp, hideReload, params)
{
	var url = url ? url : null;
	var hideClose = hideClose ? hideClose : null;
	var hideHelp = arguments[6] ? arguments[6] : null;
	var hideReload = arguments[7] ? arguments[7] : null;
	var name = name ? name : null;
	if (name == 'error')
		name = 'dlg_error';
	customOverlayMsg = customOverlayMsg ? customOverlayMsg : null;
	dialogType = dialogType || 'dialog';
	var dlgOpener = opener ? opener : null;
	if (params)
		url += ((url.indexOf('?') === -1) ? '?' : '&') + 'cs_useLightboxParams=1';
	var options = {
		url: url,
		hideClose: hideClose,
		name: name,
		customOverlayMsg: customOverlayMsg,
		dialogType: dialogType,
		opener: dlgOpener,
		hideHelp: hideHelp,
		hideReload: hideReload,
		params: params || {}
	};
	commonspot.lightbox.stack.push(commonspot.lightbox.dialogFactory.getInstance(options));
	/*
	commented for 6.0 this should be live in 6.x when we want spellcheck for the spry dialogs.
	code in dashboard\dialogs\pageview\create-work-request.html is left as-is as an example.
	setTimeout(function(){
		if (commonspot.lightbox.stack.length)
			commonspot.lightbox.addSpellCheckButton(commonspot.lightbox.stack.last().getWindow().document);	
	},50);
	*/
	return commonspot.lightbox.stack[commonspot.lightbox.stack.length - 1];
};

/**
 * Changes the URL of the lightbox to a SPRY dialog
 * @param url  (string). Required
 */
commonspot.lightbox.loadSpryURL = function(url)
{
	var win = commonspot.lightbox.stack.last().getWindow();
	win.location.href = url;
};

/**
 * Changes the URL of the lightbox to a Legacy dialog
 * 
 * @param loaderParamsString (string): arguments to pass to loader
 * @param customVarValues (value object, optional): custom dynamic argument values
 * 
 * loaderParamsString is everything after the '?', including csModule=whatever.cfm
 * can include {varName} placeholders to be filled in when this is called
 * there are two kinds of vars:
 * 	- standard ones we do always
 * 		pageID for now, maybe others some day
 * 	- custom ones whose values are passed in customVarValues value object
 * 		customVarValues should be in the form {fldName1: fldValue1, fldName2: fldValue2,...}
 * 		{fldName1} in loaderParamsString will be replaced with fldValue1, etc
 */
commonspot.lightbox.loadLegacyURL = function(loaderParamsString, customVarValues, bNewWindow)
{
	// replace any std var placeholders w real values
	var pageID = commonspot.data.uiState.lview.dsCurrentPage.getCurrentRow().pageid;
	loaderParamsString = loaderParamsString.replace('{pageID}', pageID);
	
	// replace any custom dynamic arguments with passed values
	for(var fld in customVarValues)
		loaderParamsString = loaderParamsString.replace('{' + fld + '}', customVarValues[fld]);
	
	var win = commonspot.lightbox.stack.last().getWindow();
	if( bNewWindow )
		commonspot.dialog.server.show(loaderParamsString);
	else
	{
		// get loader, build url
		var loader = commonspot.clientUI.state.location.getLoaderURL('subsiteurl');
		var url = loader + '?' + loaderParamsString;	
	
		win.location.href = url;
	}
};

/*
 * Loads a full url (url with /{sitename}/loader.cfm?csmodule={template}
 */
commonspot.lightbox.loadLegacyFullURL = function(url)
{
	var win = commonspot.lightbox.stack.last().getWindow();
	win.location.href = url;
};

/*
 * returns the lightbox object representing the topmost window, ignoring alerts if requested
 */
commonspot.lightbox.getCurrent = function(includeAlerts)
{
	if (commonspot.lightbox.stack.length === 0)
		return;
	if (typeof includeAlerts === 'undefined')
		includeAlerts = true;
	if (includeAlerts)
		return commonspot.lightbox.stack.last();
	else
	{
		var endPos = commonspot.lightbox.stack.length - 1;
		for (var i = endPos; i >= 0; i--)
		{
			if (commonspot.lightbox.stack[i].dialogType !== 'alert')
				return commonspot.lightbox.stack[i];
		}
	}
}

/**
 * Get window object of topmost lightbox, ignoring alerts if requested
 */
commonspot.lightbox.getCurrentWindow = function(includeAlerts)
{
	var currentDlg = commonspot.lightbox.getCurrent(includeAlerts);
	if (currentDlg)
		return currentDlg.getWindow();
	else
		return window;	
};

/*
	dlgs can call this method to get params from either URL query string or lightbox stack, like this:
		var queryParams = commonspot.lightbox.getParams(window.location);
	returns {} if none are found

	to pass params into the lightbox stack, open the dlg like this:
		commonspot.lightbox.openDialogWithParams(url, paramsObject);
	you can also call commonspot.lightbox.openDialog, passing all optional args up to and including params
		if you do this, pay attention to the notes below about including cs_useLightboxParams=1 in the dlg URL

	IMPORTANT NOTES
	this looks for stack params ONLY if the dlg search string contains '&' or '?' then 'cs_useLightboxParams=1'
		when that URL param is passed, ONLY stack params are returned, all other URL params are ignored
		when it's not passed, NO stack params are returned
	that means something MUST pass 'cs_useLightboxParams=1' as a URL parameter if the dlg uses stack params
		commonspot.lightbox.openDialogWithParams() does this automatically
		if you're using commonspot.lightbox.openDialog() instead, you have to include it in the passed URL
	done this way in case a lightbox dlg navigates, so the destination dlg doesn't see params still in the stack
		don't want to erase them, or reloading the dlg won't work
*/
commonspot.lightbox.getParams = function(dlgLocation)
{
	if (dlgLocation.search && typeof dlgLocation.search === 'string' && dlgLocation.search.match(commonspot.lightbox.getParams.useParamsRegex))
		return commonspot.lightbox.getStackParams(dlgLocation);
	return commonspot.lightbox.parseQueryString(dlgLocation.search);
};
commonspot.lightbox.getParams.useParamsRegex = /[?&]cs\_useLightboxParams=1/i;

commonspot.lightbox.parseQueryString = function(queryString)
{
	var params = {};
	queryString.replace
	(
		commonspot.lightbox.parseQueryString.reDecode,
		function($0, $1, $2, $3)
		{
			if ($1 !== '')
				params[$1] = decodeURIComponent($2.replace(commonspot.lightbox.parseQueryString.rePlus, ' '));
		}
	);
	return params;
};
commonspot.lightbox.parseQueryString.reDecode = /[?&]?([^=&]*)=?([^&]*)/g;
commonspot.lightbox.parseQueryString.rePlus = /\+/g;

commonspot.lightbox.getStackParams = function(dlgLocation)
{
	var dlgURLKey = commonspot.lightbox.getStackParams.getURLKey(dlgLocation);
	var stack = commonspot.lightbox.stack;
	var i;
	for (i = stack.length - 1; i >= 0; i--)
	{
		if (dlgURLKey === stack[i].dlgURLKey)
			return stack[i].params || {};
	}
	return {};
};

commonspot.lightbox.getStackParams.getURLKey = function(dlgURL) // dlgURL can be a string or a document location object
{
	/*
		dlgURL is null when openEmptyLightBox() is called, iframe navigates later, or a document gets built on the fly
		need to not blow up, so we have to return some fixed value
		if there's more than one dlg like this on the stack, and one besides the highest one gets stack params, they'll be read from the wrong stack frame
		that's a lot of unlikely conditions that'd have to happen for it to break, hopefully we're ok
	*/
	if (dlgURL === null)
		return 'NULL'; // has to be something not false-y
	var url = (typeof dlgURL === 'string') ? dlgURL : dlgURL.pathname;
	var matches = url.match(commonspot.lightbox.getStackParams.getURLKey.reCSModule);
	if (matches && matches.length >= 2)
		return matches[1].toLowerCase(); // returns csmodule=/path/to/module
	return url.replace(commonspot.lightbox.getStackParams.getURLKey.reURLParams, '').toLowerCase(); // strip off url params
}
commonspot.lightbox.getStackParams.getURLKey.reCSModule = /[?&](csmodule=[^&]*)(?:&|$)/i;
commonspot.lightbox.getStackParams.getURLKey.reURLParams = /\?.*/;


/**
 * Close the topmost lightbox
 */
commonspot.lightbox.closeCurrent = function(setFocus,wnd)
{
	var setFocus = typeof setFocus == 'undefined' ? 1 : setFocus;
	if (commonspot.lightbox.stack.length > 0)
	{
		if (top.commonspot.lightbox.stack.length>1 && setFocus)
			activateFields(top.commonspot.lightbox.stack[top.commonspot.lightbox.stack.length-2].getWindow());	
	
		var currentDialog = commonspot.lightbox.stack.last();

		currentDialog.close(); 
	}
	
	if (commonspot.clientUI && commonspot.clientUI.isURLError)
	{
		commonspot.clientUI.state.mode.urlHash.setHashFromModeAndPage();
		commonspot.clientUI.isURLError = false;
	}
	if (wnd)
		wnd.focus();
};

// function called when 'X' close btn image is clicked
// tries to do what dlg's own cancel or close btn would do, else just closes
commonspot.lightbox.closeBtnOnClick = function()
{
	try
	{
		var dlgWin = commonspot.lightbox.getCurrentWindow();
		var doc = dlgWin.document;
	}
	catch(e)
	{
		dlgWin = null;
	}
	if(!dlgWin)
	{
		commonspot.lightbox.closeCurrent();
		return;
	}	
	var closeBtn = doc.getElementById('closeButton') || doc.getElementById('Close');
	var cancelBtn = doc.getElementById('cancelButton');
	var btn = cancelBtn ? cancelBtn : closeBtn;
	
	if(!btn)
		commonspot.lightbox.closeCurrent();
	else if(btn.onclick)
		btn.onclick();
	else
		btn.click();
}

/**
 * Close the topmost lightbox and reload the parent Dialog
 */
commonspot.lightbox.closeCurrentWithReload = function()
{
	if (commonspot.lightbox.stack.length > 0)
	{
		var currentDialog = commonspot.lightbox.stack.last();
		currentDialog.close();
		
		// Get next existing dialog and reload it  
		if (commonspot.lightbox.stack.length != 0)
		{
		 	var nextExistingWindow = commonspot.lightbox.stack.last(); 
		 	nextExistingWindow.getWindow().location.reload();
		}
		else
			commonspot.lightbox.reloadPage();
	}
};

/**
 * Close the parent of topmost lightbox
 */
commonspot.lightbox.closeParent = function()
{
	var pos = commonspot.lightbox.stack.length - 2;
	if (pos >= 0)
		commonspot.lightbox.stack[pos].close();
};

/**
 * Close all parent lightboxes
 */
commonspot.lightbox.closeParentDialogs = function()
{
	var endPos = commonspot.lightbox.stack.length - 2;
	for (var i = endPos; i >= 0; i--)
		commonspot.lightbox.stack[i].close();
}

/**
 * Close all lightboxes, and refresh the innermost one
 * @param closeCount  int is the number of child dialogs to close
 */
commonspot.lightbox.closeChildDialogsWithReload = function(closeCount)
{
	var curCount = 0;
	for (var i = commonspot.lightbox.stack.length-1; i >= 0; i--)
	{
		if (curCount <= closeCount)
		{
			commonspot.lightbox.stack[i].close();  
			curCount++;
		}	
		else
			break;
	}
	// Get next existing dialog and reload it  
	if (commonspot.lightbox.stack.length != 0)
	{
	 	var nextExistingWindow = commonspot.lightbox.stack.last(); 
	 	nextExistingWindow.getWindow().location.reload();
	}		
};

/**
 * Close all lightboxes, apart the innermost one
 */
commonspot.lightbox.closeChildDialogs = function()
{
	for(var i = commonspot.lightbox.stack.length-1; i > 0; i--)
	{
		commonspot.lightbox.stack[i].close();  
	}
};

/**
 * Close all child lightboxes from given position
 */
commonspot.lightbox.closeChildDlgsFromPosition = function(currPos)
{
	if (typeof currPos === 'undefined')
		currPos = -1;  //if pass nothing, close all... ??
		
	var endPos = commonspot.lightbox.stack.length - 1;
	
	for (var i=endPos; i > currPos; i--)
		commonspot.lightbox.stack[i].close();
};

/**
 * Close given number of lightboxes 
 */
commonspot.lightbox.closeTopChildDialogs = function(count)
{
	if (!count)
		return;
	start = commonspot.lightbox.stack.length - 1;
	end = ((start - count) > -1) ? (start - count) : -1;

	for(var i = start; i > end; i--)
	{
		commonspot.lightbox.stack[i].close();
	}	
};

/**
 * Close all lightboxes
 */
commonspot.lightbox.closeAllDialogs = function()
{
	var endPos = commonspot.lightbox.stack.length - 1;
	
	for (var i = endPos; i >= 0; i--)
		commonspot.lightbox.stack[i].close();  
};


/*
	Close dialogs that are not in given names list.
*/
commonspot.lightbox.closeAllButThese = function(fNames)
{
	var fNames = typeof fNames != 'undefined' ? ','+fNames+',' : '';
	if (fNames == '')
		commonspot.lightbox.closeAllDialogs();
	else
	{
		var endPos = commonspot.lightbox.stack.length - 1;
		var curDlg;
		var curDlgName;
		for (var i = endPos; i >= 0; i--)
		{
			curDlg = commonspot.lightbox.stack[i];
			curDlgName = ',' + curDlg.frameName + ',';
			if (fNames.indexOf(curDlgName) == -1)
				curDlg.close();
		}
	}	
};

/*
	Close dialogs that are in given names list.
*/
commonspot.lightbox.closeTheseDialogs = function(fNames)
{
	var fNames = typeof fNames != 'undefined' ? ','+fNames+',' : '';
	if (fNames == '')
		return;
	else
	{
		var endPos = commonspot.lightbox.stack.length - 1;
		var curDlg;
		var curDlgName;
		for (var i = endPos; i >= 0; i--)
		{
			curDlg = commonspot.lightbox.stack[i];
			curDlgName = ',' + curDlg.frameName + ',';
			if (fNames.indexOf(curDlgName) >= 0)
				curDlg.close();
		}
	}	
};

/**
 * Close current lightbox, and run function with passed name in opener window
 * Useful for dialogs than want to do something in opener window in response to actions that close the dlg
 * Can't close dlg first, or code won't run, but want it closed before actions start
 * Example: /dashboard/dialogs/common/js/tree-edit.js confirmUnsavedChanges()
 */
commonspot.lightbox.closeAndRunOpenerFn = function(fnName)
{
	var opener = commonspot.lightbox.getOpenerWindow();
	opener.setTimeout(opener.eval(fnName), 0);
	commonspot.lightbox.closeCurrent();
};

commonspot.lightbox.reloadPage = function()
{
	var pFrame = top.document.getElementById('page_frame');
	if (pFrame)
		pFrame.contentWindow.location.reload();	
	else if (!commonspot.lview)
		window.location.reload();
};
commonspot.lightbox.reloadAdmin = function()
{
	var pFrame = top.document.getElementById('admin_iframe');
	if (pFrame)
		pFrame.contentWindow.location.reload();	
	else if (!commonspot.lview)
		window.location.reload();
};

/**
 * Resize, setup and show the dialog inside the topmost lightbox
 * @param w			  (int). Required. Width of the dialog
 * @param h			  (int). Required. Height of the dialog
 * @param dialogInfo  (object). Required. Info about required for dialog's furniture 
 * {title (string), subtitle (string), helpId (string), close (boolean), reload (boolean), maximize (boolean)}
 * @param closeCallback (string). Optional. A callback function to be called on dialog's close 
 * @param includeAlerts (boolean). Optional, default false. Affects topmost non-alert lightbox unless this is true.
 */
commonspot.lightbox.initCurrent = function(w, h, dialogInfo, closeCallback, includeAlerts)
{
	var currentDialog = commonspot.lightbox.getCurrent(includeAlerts);
	if(currentDialog)
	{
		if ((typeof closeCallback != 'undefined') && (closeCallback != '') && (currentDialog.hasCloseButton)) 
			currentDialog.closeImg.onclick = function(){ currentDialog.getWindow()[closeCallback]();};
		
		currentDialog.resize(w, h);
		currentDialog.show();
		if(dialogInfo)
		{
			// Populate the furniture
			currentDialog.setUpFurniture(dialogInfo);
		}
		currentDialog.getWindow().focus();
		currentDialog.origWidth = currentDialog.width;
		currentDialog.origHeight = currentDialog.height;

		if(currentDialog.showQAButtons)
			commonspot.lightbox.getQAStatus(currentDialog);
	}
};

/**
 * Dialogs that have a DOM handler (typically server ones) should call this to let the handler do its job
 * Additionally, it extract info from the dialog to populate the furniture
 */
commonspot.lightbox.initCurrentServerDialog = function(index)
{
	if (commonspot.lightbox.stack.length > 0)
	{
		var currentDialog = commonspot.lightbox.stack.last();
		var win = currentDialog.getWindow();
		// Extract info from the dialog	
		var dialogInfo = commonspot.lightbox.extractServerDialogInfo(win, index);
		if (dialogInfo.maximize)
			commonspot.lightbox.stack.last().hasMaxButton = true;
		else
			commonspot.lightbox.stack.last().hasMaxButton = false;
		if(win.onLightboxLoad)
		{
			win.onLightboxLoad();
		}	
		currentDialog.setUpFurniture(dialogInfo);
		commonspot.lightbox.stack.last().origWidth = currentDialog.width;
		commonspot.lightbox.stack.last().origHeight = currentDialog.height;
	}
};

/**
*  function called by maximize / restore button of a lighbox dialog 
*  @param iconObj. Required. A reference to the maximize/restore button object
*/
commonspot.lightbox.callResize = function(iconObj,forceAction)
{
	var currentDialog = commonspot.lightbox.stack.last();
	if (!iconObj)
		iconObj = document.getElementById('restoreImg_' + currentDialog.zIndexCounter);
	var tmpClassName = iconObj.className;
	var curAction = forceAction ? forceAction : null;
	if (!curAction)
		curAction = tmpClassName.indexOf('ico_maximize')>-1 ? 'maximize' : 'minimize';

	if (curAction == 'maximize')
	{
		// resize window to max size
		tmpClassName=tmpClassName.replace('ico_maximize','ico_pop');
		iconObj.title='Restore Down';
		var maxVals = commonspot.lightbox.getMaxSize();
		currentDialog.resize(maxVals.width-60, maxVals.height);
	}
	else if (curAction == 'minimize')
	{
		// restore window to its original size
		tmpClassName=tmpClassName.replace('ico_pop','ico_maximize');
		iconObj.title='Maximize';
		//commonspot.lightbox.recalcLightboxSizeByPos(commonspot.lightbox.stack.length-1);
		currentDialog.resize(currentDialog.origWidth, currentDialog.origHeight);
	}
	iconObj.className = tmpClassName;
	var win = currentDialog.getWindow();

	if (typeof win.HandleOnResize == 'function')
		setTimeout(function(){
			win.HandleOnResize();
		}, 150);
};



commonspot.lightbox.forceResizeWindow = function(forceAction)
{
	var currentDialog = commonspot.lightbox.stack.last();
	if (currentDialog)
	{
		var iconObj = document.getElementById('restoreImg_' + currentDialog.zIndexCounter);
		if (iconObj)
			commonspot.lightbox.callResize(iconObj,forceAction);	
	}
};

/**
 * Extract information from a server dialog that will be used to set up the furniture (title, subtitle etc)
 * @param win			(window). Required. A reference to the dialog's window object
 */
commonspot.lightbox.extractServerDialogInfo = function(win, index)
{
	var doc = win.document;
	// index is defined when coming from page with tabs. without this index we are not updating
	// the lightbox subtitle.
	if (typeof index == 'undefined')
		var index = 0;
	var info = {
		title: '',
		subtitle: '',
		maximize: false,
		reload: true,
		close: true
	};
	var titleCell = '';	
	var subtitleCell = '';
	var errorCells = '';
	//debugger;
	titleCell = commonspot.util.dom.getElementsByClassName("cs_dlgTitle",doc)[index];

	if(titleCell)
	{
		info.title = titleCell.innerHTML;
		titleCell.style.display = 'none';
	}
	
	subtitleCell = commonspot.util.dom.getElementsByClassName('cs_dlgDesc',doc)[index];
	if (!subtitleCell && index && index > 0) // if tabs are involved but requested tab doesn't have its own subtitle, use the first (probably only) one
		subtitleCell = commonspot.util.dom.getElementsByClassName('cs_dlgDesc',doc)[0];
	if(subtitleCell)
	{
		info.subtitle = '<div>' + subtitleCell.innerHTML + '</div>';
		subtitleCell.style.display = 'none';
	}
	
	errorCells = commonspot.util.dom.getElementsByClassName('cs_lightboxServerDlgError',doc);
	for(var i = 0; i < errorCells.length; i++)
	{
		info.subtitle += '<div class="cs_dlgError">' + errorCells[i].innerHTML + '</div>';
		errorCells[i].style.display = 'none';
	}
	
	// Help id should be stored inside a global JavaScript variable in the dialog
	if(win.DIALOG_HELP_ID)
		info.helpId = win.DIALOG_HELP_ID;
	if (win.DIALOG_NO_HELP)
		info.hideHelp = 1;
		
	var mainTable = win.document.getElementById('MainTable');
	
	if (mainTable && mainTable.className && (mainTable.className).indexOf('allowMaximize')>-1)
		info.maximize = true;
		
	if (mainTable && mainTable.className && (mainTable.className).indexOf('hideReload')>-1)
		info.reload = false;

	if (mainTable && mainTable.className && (mainTable.className).indexOf('hideClose')>-1)
		info.close = false;
		
	return info;
};

/**
 * Resize the dialog inside the topmost lightbox
 * @param w			(int). Required. Width
 * @param h			(int). Required. Height
 */
commonspot.lightbox.resizeCurrent = function(w, h)
{
	if (commonspot.lightbox.stack.length > 0)
	{
		var currentDialog = commonspot.lightbox.stack.last();
		currentDialog.resize(w, h);
		commonspot.lightbox.stack.last().origWidth = currentDialog.width;
		commonspot.lightbox.stack.last().origHeight = currentDialog.height;
	}
};

/**
 * Resize the dialog inside the topmost lightbox
 * @param w			(int). Required. Width
 * @param h			(int). Required. Height
 */
commonspot.lightbox.recalcLightboxSizeByPos = function(pos)
{
	if (commonspot.lightbox.stack.length > pos && commonspot.lightbox.stack.length > 0)
	{
		var currentDialog = commonspot.lightbox.stack[pos];
		var win = currentDialog.getWindow();
		var maintable = win.document.getElementById('MainTable');
		if(maintable)
			currentDialog.resize(maintable.offsetWidth, maintable.offsetHeight + 65);
		else
		{
			maintable = win.document.getElementById('pagelistContainerDiv');
			if(maintable)
				currentDialog.resize(maintable.offsetWidth - 20, maintable.offsetHeight + 81);
		}
	}
};

/**
 * Return the frame name of the topmost dialog, null if no dialog is opened
 */
commonspot.lightbox.getFrameName = function()
{
	if (commonspot.lightbox.stack.length > 0)
	{
		var currentDialog = commonspot.lightbox.stack.last();
		return currentDialog.getFrameName();
	}
	else
	{
		return null;
	}
};

/**
 * Return the max size currently available for a lightbox
 * @return {width, height}
 */
commonspot.lightbox.getMaxSize = function()
{
	var maxSize = {};
	var winDimensions = commonspot.lightbox.getWinSize();
	maxSize.height = winDimensions.height - commonspot.lightbox.FURNITURE_HEIGHT - commonspot.lightbox.WINDOW_MARGINS;
	maxSize.width = winDimensions.width - commonspot.lightbox.FURNITURE_WIDTH;
	return maxSize;
};


/**
 * Return the opener window of the topmost dialog, null if no opener
 * Actually, we only know top window's real opener if it was passed into dialogFactory.getInstance or openDialog
 * 	mostly nobody does that, except newWindow, in overrides.js, passes the current window as opener
 * If we don't have real opener, or if ignoreOpenerProperty is true, we return window of next-to-top lightbox
 */
commonspot.lightbox.getOpenerWindow = function(ignoreOpenerProperty)
{
		if (commonspot.lightbox.stack.length > 1)
		{
			// Opened by another dialog
			var thisDialog = commonspot.lightbox.stack.last();
			if (thisDialog.opener && !ignoreOpenerProperty)
				return thisDialog.opener;
			var previousDialog = commonspot.lightbox.stack[commonspot.lightbox.stack.length - 2];
			return previousDialog.getWindow();
		}
		else
			return commonspot.lightbox.getVisibleFrameWindow(); // not true in admin modes, but needed to create a pg from there
};

/*
* some cases chrome and safari need this.
*/
commonspot.lightbox.getOpenerLightboxFrame = function()
{
	var iframeNode = null;
	if (commonspot.lightbox.stack.length > 1)
		iframeNode = commonspot.lightbox.stack[commonspot.lightbox.stack.length - 2].iframeNode;
	return iframeNode;
};

/**
* checks who amin-frame or lview-frame who is visible and returns that
**/
commonspot.lightbox.getVisibleFrameWindow = function()
{
	// for now, just returning pageFrame as there are few situations where this logic is not right.
	return commonspot.lightbox.getPageWindow();
	
	var cursection;
	var modes = ['mycs','lview','admin'];
	// not sure here for mycs, returning page_frame is correct or not. when we decide what is correct, we should change the first element of the below array to it.
	var windows = ['page_frame','page_frame','admin_iframe'];
	for (var i=0; i<modes.length; i++)
	{
		cursection = top.document.getElementById(modes[i]);
		curWin = top.document.getElementById(windows[i]).contentWindow;	
			
		try
		{
			curDisplay = cursection.style.display;		
		}
		catch(e)
		{
			curDisplay = 'none';
		}
	
		if (curDisplay != 'none')
			return curWin;
	}
};

/**
*	returns contentWindow of page-frame
*/
commonspot.lightbox.getPageWindow = function()
{
	var pFrame = top.document.getElementById('page_frame');
	var win, href;
	try
	{
		if (pFrame)
		{
			win = pFrame.contentWindow;
			href = win.location.href; // this is only a feeler to check if this is IE9 and has access denied problem
			return win;
		}
		else
			return top;
	}
	catch(e)
	{
		return top;
	}
};

/**
*	returns contentWindow of admin-frame
*/
commonspot.lightbox.getAdminWindow = function()
{
	var win = top.document.getElementById('admin_iframe').contentWindow;
	return (win ? win : null);
};

// returns next-to-top lightbox object (NOT its window)
// DOES NOT honor explicit opener property of lightbox object
commonspot.lightbox.getNextToTopDlg = function(returnOpenerWhenEmpty)
{
	var pos = commonspot.lightbox.stack.length - 2;
	var parentDialog = null;
	if (pos >= 0)
		parentDialog = commonspot.lightbox.stack[pos];
	else
	{
		if (returnOpenerWhenEmpty)
			return commonspot.lightbox.getPageWindow();
	}	
	return parentDialog;
}

// keep closing parent dlgs until we find one with requested callback, then return it
commonspot.lightbox.findCallbackInAncestorWindow = function(callback,closeParents)
{
	var maxCount = commonspot.lightbox.stack.length;
	if (callback.substr(0, 6) === 'local:') // if callback begins w 'local:', it's a function in current window itself, else it's in some ancestor window
		return commonspot.lightbox.getCurrentWindow()[callback.substr(6)];

	closeParents = typeof closeParents != 'undefined' ? closeParents : 1;
	var parentDlg, dlgCallback, pWindow, shouldBreak=0, count=0;
	var lightbox = commonspot.lightbox; // local ref, so we don't lose it as dlgs close; calling code should do the same to run callback
	var pageWindow = lightbox.getPageWindow();
	while((parentDlg = lightbox.getNextToTopDlg(true)) && !shouldBreak && count < maxCount)
	{
		count++;
		if (typeof parentDlg.getWindow == 'function')
		{
			pWindow = parentDlg.getWindow();
			shouldBreak = pWindow == pageWindow ? 1 : 0;
			dlgCallback = pWindow[callback];
			if (!dlgCallback) // walk the inner frames
			{
				for (var i=0; i<pWindow.frames.length; i++)
				{
						dlgCallback = pWindow.frames[i][callback];
						if (dlgCallback)
							break;
				}
			}			
		}	
		else
		{
			shouldBreak = parentDlg == pageWindow ? 1 : 0;
			dlgCallback = parentDlg[callback];
		}	
			
		if (dlgCallback)
			return dlgCallback;
		else
		{
			if (closeParents)
				parentDlg.close();
		}	
	}
	return null; // didn't find callback, oops
}

commonspot.lightbox.getWindowWithCallbackFunction = function(callback, checkIframes, iFrameID)
{
	var curWin,i,iFrObj,iFrWin;
	var cFrames = typeof checkIframes == 'undefined' ? 0 : 1;
	var frameID = typeof iFrameID == 'undefined' ? '' : iFrameID;
	for (i=commonspot.lightbox.stack.length-1; i>=0; i--)
	{
		curWin = commonspot.lightbox.stack[i].getWindow();
		if (typeof curWin[callback] == 'function')
			return curWin;
		if (cFrames && frameID.length)
		{
			iFrObj = curWin.document.getElementById(frameID);
			if (iFrObj)
			{
				try
				{
					iFrWin = iFrObj.contentWindow;
					if (iFrWin)
					{
						if (typeof iFrWin[callback] == 'function')
							return iFrWin;
					}
				}
				catch (e) {};
			}
		} 	
	}
	return null;
}
/*
 * Function to handle specific key presses.
 */
commonspot.lightbox.handleDialogKeys = function(e)
{
	if(!commonspot.lightbox.getCurrent().hasCloseButton)
		return;
	var code;
	
	if (!e) 
		var e = window.event; // Get event.

	// Get key code.
	if (e.keyCode) 
		code = e.keyCode;
	else if (e.which) 
		code = e.which;
	
	switch (code) 
	{
		case 27: // Escape key
			commonspot.lightbox.closeBtnOnClick();
			break;
	}
}		
/*
* should this go in a sperate namespace and file ??
*/
var commonspotData = {};
commonspot.lightbox.getQAStatus = function(dlgObj)
{
	if (!e) 
		var e = window.event; // Get event.
	dlgObj.QAStatusUpdated = true;	
	var args = {};	
	var temp = '';
	var obsArr = [];
	var win = dlgObj.getWindow();
	var frName = dlgObj.getFrameName();
	var frObj;
	/* we should have this somewhere common
		these are the titles that multiple dialogs can have. so do not expect them to be unique 
	*/
	var generalDialogTitles = ('CommonSpot Error,Debug Help Status,CommonSpot Message,About CommonSpot,CommonSpot Security Exception').split(",");;
	if (frName == 'error')
		return;
	var formFlds = win.document.getElementsByName("fromlongproc");
	if (formFlds.length)
	{
		//there may be more than 1
		for(var i=0;i<formFlds.length;i++)
		{
			if (formFlds[i].value == 1)
				return;
		}
	}
	obsArr = document.getElementsByName(frName);
	for (var i=0; i<obsArr.length; i++)
	{
		if (obsArr[i].tagName.toLowerCase() == 'iframe')
			frObj = obsArr[i];
	}
	if (!frObj)
		return;
	var hashArgs = commonspot.util.getHashArgs();
	if (!hashArgs)
		return;
	var mode = hashArgs.mode || commonspot.clientUI.state.mode.MYCS;	
	var LOADER_URL;
	// Set loader appropriately (based on Server Admin mode or not).
	if (mode != 'server_admin')
	{
		var url = hashArgs.url;
		if (url.length > 0)
			LOADER_URL = commonspot.clientUI.state.location.getPathFromUrlStr(url) + 'loader.cfm';
	}
	else
		LOADER_URL = '/commonspot/admin/loader.cfm';
	if (!LOADER_URL || commonspot.data.Users_GetUserInfo.getCurrentRow().name == '')
	{	
		commonspot.lightbox.hideQAElements('All');
		return;		
	}
	args.widgetName = dlgObj.headerTitle.innerHTML;
	args.widgetNameSrc = 'Request.params.csModule';
	args.queryString = '';
	args.statusType = "QA";
	args.formParams = '';
	args.helpObjectType = 'CFMDialog';
	args.helpObjectTitle = (args.widgetName != '') ? args.widgetName : win.document.title;
	if (args.widgetName == '')
		args.widgetName = args.helpObjectTitle;
	if ((generalDialogTitles.indexOf(win.document.title) >= 0)
				|| ((win.document.title).indexOf('Debug Help Status') == 0))
	{
		commonspot.lightbox.hideQAElements('All');
		return;	
	}	
	args.moduleName = unescape(frObj.src.toLowerCase());
	if (args.moduleName != '')
	{
		// first remove any protocol (if found) from the module name
		var index = args.moduleName.match(/^\s*https?:\/\/[^\/]*/);
		args.moduleName = args.moduleName.replace(index,''); 
		index = args.moduleName.indexOf('csmodule');
		if (index >= 0) // legacy
		{
			args.widgetNameSrc = "Request.params.csModule";
			temp = args.moduleName.substring(index);
			// look for csmodule=
			var begin = temp.indexOf('csmodule=');
			if (begin >= 0)
				begin = begin+9;
			// remove any query string part after csmodule value
			var end = temp.indexOf('&');
			if (begin>=0 && end>=0 && end>begin) // get just csmodule part if there is querystring
				args.moduleName = temp.substring(begin,end);
			else if (begin>=0) // get csmodule part
				args.moduleName = temp.substring(begin);	
		}	
		else //spry
		{
			index = args.moduleName.indexOf('/commonspot/dashboard/');
			if (index >= 0)
			{
				args.moduleName = args.moduleName.substring(index);
				index = args.moduleName.indexOf('?');
				if (index >= 0)
					args.moduleName = args.moduleName.substring(0,index);
				args.widgetNameSrc = "SPRY Dialog URL";
				args.helpObjectType = "AJAXDialog";
			}	
		}
	}
	if (!args.widgetName.length)
	{
		commonspot.lightbox.hideQAElements('All');
		return;
	}	
	commonspotData.DebugHelp_getHelpObjectStatus = new commonspot.spry.Dataset({ xpath: commonspot.data.ARRAY_XPATH });	
	var collectionOptions = {closeOnError: 0, overlayElementID: '', onCompleteCallback: commonspot.lightbox.onCompleteCallback_GetHelpObjectStatus};
	var cmd = commonspot.ajax.commandEngine.commandCollectionFactory.getInstance(LOADER_URL, collectionOptions);
	cmdOptions = {datasetRoot: commonspotData, datasetName: 'DebugHelp_getHelpObjectStatus'};	
	cmd.add('DebugHelp', 'getHelpObjectStatus', args,  cmdOptions); 
	cmd.send();		

}

commonspot.lightbox.onCompleteCallback_GetHelpObjectStatus = function()
{
	if(this.hasAnyError)
	{
		commonspot.lightbox.hideQAElements('All');
		return;  
	}	
	var data = commonspotData.DebugHelp_getHelpObjectStatus.getData()[0];
	if (!data)
	{
		commonspot.lightbox.hideQAElements('All');
		return;
	}	
	var frName = commonspot.lightbox.stack.last().getFrameName();
	var statusMsg = window.document.getElementById('QAStatusMsg_' + frName);
	var statusIcon = window.document.getElementById('statusIcon_' + frName);
	var qaIcon = window.document.getElementById('qaIcon_' + frName);
	var reportsIcon = window.document.getElementById('reportsIcon_' + frName);
	var mapStatus = data["helpmodulestatus"];
	var intMapStatus;
	var statusText = "";
	var statusColor = 'green';
	switch(mapStatus)
	{
		case "AutoMapped":
			statusText = "AUTO";
			statusColor = 'lightgreen';
			intMapStatus = 1;
			break;
		case "Mapped":
			statusText = "MAP";
			statusColor = 'lightgreen';
			intMapStatus = 2;
			break;
		case "MappedBroken":
			statusText = "MAP-B";
			statusColor = 'tomato';
			intMapStatus = 3;
			break;
		case "MappedCanBeAuto":
			statusText = "MAP-A?";
			statusColor = 'yellow';
			intMapStatus = 4;
			break;
		case "NeedsMapDuplicate":
			statusText = "NO MAP-DUP";
			statusColor = 'tomato';
			intMapStatus = 5;
			break;
		case "NeedsMapNone":
			statusText = "NO MAP-NONE";
			statusColor = 'tomato';
			intMapStatus = 6;
			break;
	}
	if (statusMsg)
	{
		statusMsg.style.backgroundColor = statusColor;
		statusMsg.innerHTML = statusText;
		statusMsg.onclick = function(e) 
		{
			var event = e || window.event;	
		   if(typeof event.stopPropagation!='undefined')
		      event.stopPropagation();
		   else
		      event.cancelBubble=true;			
			commonspot.lightbox.openDialog('/commonspot/dashboard/dialogs/common/map-dialog.html?HelpObjectID=' + data["helpobjectid"],false, null, null, null, null, true);
		};	
	}
	if (intMapStatus >= 5)
	{
		var eleList = 'docIcon_'+frName+',qaIcon_'+frName;
		//commonspot.lightbox.hideQAElements(eleList);
	}

	var color = (data["statuscategorycolor"] == '' ? 'red' : data["statuscategorycolor"]).toLowerCase();
	var type = data["statustype"];
	if (statusIcon)
	{
		statusIcon.onclick = function(e)
		{
			var event = e || window.event;
			if(typeof event.stopPropagation!='undefined')	
				event.stopPropagation();
			else
				event.cancelBubble=true;
			commonspot.lightbox.openDialog('/commonspot/dashboard/dialogs/common/module-mapping-status-report.html',false, null, null, null, null, true);
		}
	}
	if (qaIcon)	
	{
		// if (type == 'QA' || type == '') // check current record type (can be 'QA' or 'Doc'
			qaIcon.src = '/commonspot/private/' + color + '.png';	
		qaIcon.onclick = function(e)
		{
			var event = e || window.event;	
		   if(typeof event.stopPropagation!='undefined')
		      event.stopPropagation();
		   else
		      event.cancelBubble=true;	
			commonspot.lightbox.openDialog('/commonspot/dashboard/dialogs/common/debug-status.html' +
											'?HelpObjectID=' + data["helpobjectid"] +
											'&HelpObjectTitle=' + escape(data["helpobjecttitle"]) +
											'&HelpObjectType=' + data["helpobjecttype"] +
											'&MappingCount=' + data["mappingcount"] +
											'&WidgetName=' + escape(data["widgetname"]) +
											'&StatusType=QA' +
											'&WidgetNameSource=' + escape(data["widgetnamesrc"]),false, null, null, null, null, true);
		}
	}
	if (reportsIcon)
	{
		reportsIcon.onclick = function(e)
		{
			var event = e || window.event;	
		   if(typeof event.stopPropagation!='undefined')
		      event.stopPropagation();
		   else
		      event.cancelBubble=true;			
			commonspot.lightbox.openDialog('/commonspot/dashboard/dialogs/common/help-status-report.html' +
											'?HelpObjectID=' + data["helpobjectid"] +
											'&HelpObjectTitle=' + escape(data["helpobjecttitle"]) +
											'&HelpObjectType=' + data["helpobjecttype"] +
											'&MappingCount=' + data["mappingcount"] +
											'&WidgetName=' + escape(data["widgetname"]) +
											'&WidgetNameSource=' + escape(data["widgetnamesrc"]),false, null, null, null, null, true);
		}
	}

}
/**
 * Singleton, object factory for lightboxed dialogs
 */
commonspot.lightbox.dialogFactory = {};
commonspot.lightbox.dialogFactory.zIndexCounter = 1000;


/**
 * Factory method for lightboxed dialogs
 * @param url			(string). Required
 * @param hideClose  (boolean). Optional. Set it to true to remove the close button from furniture's top right corner
 */
commonspot.lightbox.dialogFactory.getInstance = function(args)
{
	// args: url, hideClose, name, customOverlayMsg, dialogType, opener, hideHelp, hideReload, params
	var dialogObj = {dialogType: args.dialogType, opener: args.opener};
	var bodyNode = top.document.getElementsByTagName('body')[0];
	var nextZindex = commonspot.lightbox.dialogFactory.zIndexCounter +1;
	var overlayMsg = 'Loading...';
	var overlayTitle = 'Loading, please wait';
	var cVal = commonspot.util.cookie.readCookie('REGISTERDIALOGS');
	var onClick; 
	if (args.customOverlayMsg)
		overlayMsg = overlayTitle = args.customOverlayMsg;
	if(overlayMsg != commonspot.lightbox.NO_OVERLAY_MSG)
		commonspot.lightbox.loadingMsg.show(overlayMsg, overlayTitle);
	dialogObj.dlgURLKey = commonspot.lightbox.getStackParams.getURLKey(args.url);
	dialogObj.params = args.params;
	dialogObj.zIndexCounter = nextZindex;
	dialogObj.top = commonspot.lightbox.DEFAULT_TOP;
	/*		dmerrill 2014-08-01: next line is nonsense, has no effect, but it was there forever
	I guess maybe it clarifies (?!?) the intent to use those fields later
	there's nothing I can change it to that actually does something w/o altering the behavior, so I'm just commenting it out*/
	//dialogObj.boxWidth, dialogObj.width, dialogObj.height, dialogObj.left;
	dialogObj.frameName = args.name ? args.name : 'lightboxFrame_' + nextZindex;
	dialogObj.hasCloseButton = true;
	dialogObj.showQAButtons = (cVal == 'ON');
	if (args.hideHelp){
		dialogObj.showQAButtons = false;}
	dialogObj.hasMaxButton = true;
	if(args.hideClose)
	{
		dialogObj.hasCloseButton = false;
		dialogObj.hasMaxButton = false;
	}

	var onclick = function(e) {
	   var event = e || window.event;	 
	   if(typeof event.stopPropagation!='undefined')
	      event.stopPropagation();
	   else
	      event.cancelBubble=true;		
	};
	// Create the overlay layer
	dialogObj.overlayDiv = commonspot.util.dom.addToDom({objType:'DIV', objID: 'lightboxOverlay_' + nextZindex, objClass:'lightboxOverlay', objOnClick: onclick, objParent:bodyNode});
	
	dialogObj.overlayDiv.style.opacity = '.45';
	dialogObj.overlayDiv.style.filter='alpha(opacity=45);';
	dialogObj.overlayDiv.style.zIndex = nextZindex;
	dialogObj.overlayDiv.style.height = commonspot.util.dom.getWinScrollSize().height + 'px';
	
	// Main container
	dialogObj.divNode = top.document.createElement('div');
	dialogObj.divNode.className = 'lightboxContainer drag';
	dialogObj.divNode.onclick = function(e) { 
	   var event = e || window.event;	 
	   if(typeof event.stopPropagation!='undefined')
	      event.stopPropagation();
	   else
	      event.cancelBubble=true;	
	}
	dialogObj.divNode.style.zIndex = nextZindex +1;
	dialogObj.divNode.style.top = '-5000px';
	var thisZIndex = nextZindex+2;
	
	// Top corners
	dialogObj.topCorners = commonspot.util.dom.addToDom({objType:'DIV', objID: 'lightboxTopCorner_' + nextZindex, objClass:'lightboxTopCorner', objHTML:commonspot.lightbox.generateHTMLcorners('t'), objParent:dialogObj.divNode});	
	dialogObj.topCorners.style.zIndex = thisZIndex;
	// Header section
	dialogObj.header = top.document.createElement('div');
	dialogObj.header.className = 'lightboxHeader';
	dialogObj.header.id = 'lightboxHeader_' + nextZindex;
	dialogObj.header.onmousedown = OnMouseDown;
	dialogObj.header.onmouseup = OnMouseUp;
	
	// Title 
	dialogObj.titleContainer = commonspot.util.dom.addToDom({objType:'DIV', objClass:'lightboxTitleContainer', objParent:dialogObj.header});	

	// Header Title
	dialogObj.headerTitle = commonspot.util.dom.addToDom({objType:'H1', objParent:dialogObj.titleContainer});	

	// Top icons
	dialogObj.iconsContainer = top.document.createElement('div');
	dialogObj.iconsContainer.className = 'lightboxIconsContainer';

	// help icon
	if (!args.hideHelp)
	{
		dialogObj.helpImg = commonspot.util.dom.addToDom({objType:'SPAN', objID:'help_img', objClass:'ico_help actionMontageIcon', objTitle:'Help', objParent:dialogObj.iconsContainer});	
	}	

	// qa icons
	if (dialogObj.showQAButtons)
	{
		dialogObj.QAiconsContainer = commonspot.util.dom.addToDom({objType:'DIV', objClass: 'QAIconsContainer', objParent:dialogObj.iconsContainer});

		dom = commonspot.util.dom.addToDom({objType:'SPAN', objID:'QAStatusMsg_'+dialogObj.frameName, objClass:'statusMsg', objParent:dialogObj.QAiconsContainer});

		dom = commonspot.util.dom.addToDom({objType:'IMG', objID:'statusIcon_'+dialogObj.frameName, objClass:'statusIconClass', objTitle:'Mapping Report', objParent:dialogObj.QAiconsContainer});
		dom.src = ('/commonspot/dashboard/icons/application_view_detail.png');

		dom = commonspot.util.dom.addToDom({objType:'IMG', objID:'qaIcon_'+dialogObj.frameName, objClass:'qaIconClass', objTitle:'QA status', objParent:dialogObj.QAiconsContainer});
		dom.src = ('/commonspot/private/white.png');
		
		dom = commonspot.util.dom.addToDom({objType:'IMG', objID:'reportsIcon_'+dialogObj.frameName, objClass:'reportIconClass', objTitle:'Status Report', objParent:dialogObj.QAiconsContainer});
		dom.src = ('/commonspot/dashboard/icons/table_sort.png');
	}
	
	// Reload icon
	if (!args.hideReload)
	{	
		onClick = function()
		{
			var dialogWin = dialogObj.getWindow();
			if(dialogWin)
			{
				var dialogSrc = (dialogObj.iframeNode.src).indexOf('commonspot/dashboard/')>=0 ? 'spry' : 'legacy';
				if ((commonspot.util.browser.chrome || commonspot.util.browser.safari) && dialogSrc == 'legacy')
				{
					if (dialogWin.spanArray)
					{
						var curSpan;
						var forms;
						var i = 0;
						var j = 0;
						var refreshDone = false;
						var curID;
						while (j < dialogWin.spanArray.length) // multi-tab (custome element > render mode dialog)
						{
							curID = dialogWin.spanArray[j];
							curSpan = dialogWin.$(curID);
							if (curSpan && curSpan.style && curSpan.style.display != 'none')
							{
								forms = eval("dialogWin.$$('#" + curID + " form')"); //returns nodelist
								if (forms.length)
								{
									while(i < forms.length)
									{
										forms[i].reset();
										i++;
										refreshDone = true;
									}
								}
							}	
							j++;
						}
					}
					if (dialogWin.document.forms || !refreshDone) // multi-tab or single dialog with top-level form
					{
						var j = 0;
						while (j < dialogWin.document.forms.length)
						{
							dialogWin.document.forms[j].reset();
							refreshDone = true;
							j++;
						}
					}

					if (!refreshDone)
					{
						var iframeNode = commonspot.lightbox.stack.last().iframeNode;
						//debugger;
						if (iframeNode)
							iframeNode.src = iframeNode.src;
						else							
							dialogWin.location.reload();  // catch all
					}	
					else
					{
						var onLoadFunction = dialogWin.document.body.onload;
						if (typeof onLoadFunction == 'function')
							onLoadFunction();
					}
				}
				else
					dialogWin.location.reload();
			}
		}
		dialogObj.reloadImg = commonspot.util.dom.addToDom({objType:'SPAN', objID:'reloadImg_'+nextZindex, objClass:'ico_arrow_refresh_small actionMontageIcon', objTitle:'Refresh', objParent:dialogObj.iconsContainer, objOnClick:onClick});
	}
		
	
	// Maximize / Restore icon
	if(dialogObj.hasMaxButton)
	{
		onClick = function(event){
			var event = event || window.event;	 
			var target = (event && event.target) || (event && event.srcElement);
			commonspot.lightbox.callResize(target);
		};
		dialogObj.maxImg = commonspot.util.dom.addToDom({objType:'SPAN', objID:'restoreImg_' + nextZindex, objClass:'ico_maximize actionMontageIcon', objTitle:'Maximize', objParent:dialogObj.iconsContainer, objOnClick:onClick});

		dialogObj.maxImg.style.display = 'none';
	}
	
	// Close icon
	if(dialogObj.hasCloseButton)
	{
		onClick = commonspot.lightbox.closeBtnOnClick;
		dialogObj.closeImg = commonspot.util.dom.addToDom({objType:'SPAN', objID:'closeImg_'+nextZindex, objClass:'ico_close actionMontageIcon', objTitle:'Close', objParent:dialogObj.iconsContainer, objOnClick:onClick});	
	}

	// blank space to right of right most icon
	dialogObj.blankImg = commonspot.util.dom.addToDom({objType:'SPAN', objClass:'ico_blank noactionMontageIcon', objParent:dialogObj.iconsContainer});	
		
	dialogObj.header.appendChild(dialogObj.iconsContainer);
	if (dialogObj.showQAButtons)
		dialogObj.header.appendChild(dialogObj.QAiconsContainer);
	if (!args.hideHelp)
		dialogObj.helpImg.innerHTML = '&nbsp;';
	if (!args.hideReload)	
		dialogObj.reloadImg.innerHTML = '&nbsp;';
	if(dialogObj.hasMaxButton)
		dialogObj.maxImg.innerHTML = '&nbsp;';
	if(dialogObj.hasCloseButton)	
		dialogObj.closeImg.innerHTML = '&nbsp;';
	dialogObj.blankImg.innerHTML = '&nbsp;';
		
	// subtitle
	dialogObj.subTitleContainer = commonspot.util.dom.addToDom({objType:'DIV', objClass:'lightboxSubTitleContainer', objParent:dialogObj.header});

	// header subtitle
	dialogObj.headerSubtitle = commonspot.util.dom.addToDom({objType:'H2', objParent:dialogObj.subTitleContainer});
	
	dialogObj.divNode.appendChild(dialogObj.header);
	
	onclick = function(e) { 
	   var event = e || window.event;	 
	   if(typeof event.stopPropagation!='undefined')
	      event.stopPropagation();
	   else
	      event.cancelBubble=true;	
	};

	// iframe container
	dialogObj.iframeDiv = commonspot.util.dom.addToDom({objType:'DIV', objOnClick: onclick, objID: 'iframeContainer_' + nextZindex, objClass:'iframeContainer', objParent:dialogObj.divNode});
	dialogObj.divNode.id = 'lightboxContainer_' + nextZindex;
	dialogObj.iframeDiv.style.zIndex = thisZIndex;

	// iframe
	var iframeHTML = '<iframe class="lightboxIframe" scrolling="no" frameborder="0" src="' + args.url + '" name="' + dialogObj.frameName + '" id="' + dialogObj.frameName + '">';
	// Here we use innerHTML instead of DOM to work around a weird IE's bug, where borders are displayed for <iframe> created with DOM methods
	dialogObj.iframeDiv.innerHTML = iframeHTML;
	// We need to store a pointer tothe <iframe> DOM node
	dialogObj.iframeNode = dialogObj.iframeDiv.childNodes[0];

	
	// Bottom corners
	dialogObj.bottomCorners = commonspot.util.dom.addToDom({objType:'DIV', objID: 'lightboxBottomCorner_' + nextZindex, objClass:'lightboxBottomCorner', objHTML:commonspot.lightbox.generateHTMLcorners('b'), objParent:dialogObj.divNode});	
	dialogObj.bottomCorners.style.zIndex = thisZIndex;
	// Append everything to the body
	bodyNode.appendChild(dialogObj.divNode);
	
	// The header act as "handle" for dragging
	//dialogObj.draggable = new Draggable($(dialogObj.divNode), {handle: $(dialogObj.header), starteffect: false, endeffect: false, zindex: 9999999 });
	
	// Adjust the size of the ovelay layer to fill the whole vieport
	dialogObj.adjustLayout = function()
	{
		dialogObj.overlayDiv.style.height = commonspot.lightbox.getWinSize().height + 'px';
	}
	
	dialogObj.close = function()
	{
		commonspot.lightbox.loadingMsg.hide();
		try
		{
			//element.parentNode.removeChild(element);
			dialogObj.divNode.parentNode.removeChild(dialogObj.divNode);
			dialogObj.overlayDiv.parentNode.removeChild(dialogObj.overlayDiv);
			//EventCache.flushLightBoxEvents(nextZindex);
		}
		catch(e){}
		var index = commonspot.lightbox.stack.indexOf(dialogObj);
		commonspot.lightbox.stack.splice(index, 1);
		// fix IE8 "frozen" fields, by focusing topmost lightbox window if there is one
		var curWin = commonspot.lightbox.getCurrentWindow();
		if (!curWin)
			curWin = window;
		
		activateFields(curWin);
			
	}
	
	// This hides the lightbox dialog and overlay
	dialogObj.hideLightbox = function(delay)	
	{
		setTimeout(function(){ 
		$(dialogObj.divNode).hide();
		$(dialogObj.overlayDiv).hide();
		}, delay );
	}
	
	dialogObj.getFrameName = function()
	{
		return dialogObj.frameName;
	}
	dialogObj.getLightboxContainer = function()
	{
		return dialogObj.divNode;
	}
	dialogObj.getWindow = function()
	{
		return dialogObj.iframeNode.contentWindow;
	}
	
	dialogObj.resize = function(w, h)
	{
		var maxHeight = commonspot.lightbox.getMaxSize().height;
		var maxWidth = commonspot.lightbox.getMaxSize().width;
		
		if(h > maxHeight)
			h = maxHeight;
			
		w = w + commonspot.lightbox.FURNITURE_WIDTH;
		dialogObj.boxWidth = w + commonspot.lightbox.FURNITURE_WIDTH;
		dialogObj.width = w;
		if(dialogObj.boxWidth > maxWidth)
		{
			dialogObj.boxWidth = maxWidth;
			dialogObj.width = maxWidth - commonspot.lightbox.FURNITURE_WIDTH;
		}	
		
		dialogObj.height = h;			
		try
		{
			var dialogWin = dialogObj.getWindow();
			doc = dialogWin.doc;
			// If the dialog contains a onResize hook, call it
			if(dialogWin.onLightboxResize)
				dialogWin.onLightboxResize(dialogObj.width, dialogObj.height);
		}
		catch (e){}
		dialogObj.left = (commonspot.lightbox.getWinSize().width / 2) - (dialogObj.boxWidth / 2);
		var topSpacer = dialogObj.topCorners.childNodes[1];
		var bottomSpacer = dialogObj.bottomCorners.childNodes[1];
		topSpacer.style.width = (dialogObj.boxWidth -commonspot.lightbox.CORNERS_WIDTH) + 'px';
		bottomSpacer.style.width = (dialogObj.boxWidth -commonspot.lightbox.CORNERS_WIDTH) + 'px';
		dialogObj.divNode.style.left = dialogObj.left + 'px';
		dialogObj.divNode.style.width = dialogObj.boxWidth + 'px';
		dialogObj.iframeNode.style.width = dialogObj.width + 'px';
		dialogObj.iframeNode.style.height = dialogObj.height-3 + 'px';
		if (dialogObj.showQAButtons)
		{
			var rr = dialogObj.iconsContainer.style.width;
			dialogObj.QAiconsContainer.style.right = rr;
		}
	}
	
	dialogObj.show = function()
	{
		if (window == top) // not in dashboard
		{
			var wnd = commonspot.lightbox.getWinSize();
			if (typeof wnd.scrollY == 'number')
				dialogObj.divNode.style.top = (dialogObj.top + wnd.scrollY) + 'px';
			else
				dialogObj.divNode.style.top = dialogObj.top + 'px';
		}
		else
			dialogObj.divNode.style.top = dialogObj.top + 'px';
		commonspot.lightbox.loadingMsg.hide();
		dialogObj.iframeNode.style.visibility = 'visible';
		// Handle key events at the window level
		var dlgWin = dialogObj.getWindow();
		dlgWin.onkeydown = commonspot.lightbox.handleDialogKeys;
	//	activateFields(dlgWin);
	}
	
	dialogObj.setUpFurniture = function(info)
	{
		if(info.title)
		{
			dialogObj.headerTitle.innerHTML = info.title;
			if ((args.hideHelp || info.hideHelp) && dialogObj.helpImg)
			{
				dialogObj.helpImg.style.visibility = 'hidden';
				dialogObj.helpImg.style.display = 'none';
			}
			if (!args.hideHelp && !info.hideHelp)
			{
				dialogObj.helpImg.style.visibility = 'visible';
				dialogObj.helpImg.style.display = 'inline';
				var helpId = info.title || info.helpId;
				if (info.forceHelpID && info.helpId)
					helpId = info.helpId;
				if(helpId)
				{
					dialogObj.helpImg.onclick = function()
					{
						var loaderUrl = commonspot.clientUI.state.location.getLoaderURL('subsiteurl');
						var dialogUrl = loaderUrl + '?csModule=help/openhelp&CSHelpID=' + encodeURIComponent(helpId);
						var winSize = top.commonspot.util.dom.getWinSize();			
						var argsStr = "menubar=0,location=0,scrollbars=1,status=0,resizable=1,width=" + (winSize.width-100) + ",height=" + (winSize.height-40);
						if (commonspot.lightbox.helpDlg && !commonspot.lightbox.helpDlg.closed)
							commonspot.lightbox.helpDlg.location.href = dialogUrl;
						else
							commonspot.lightbox.helpDlg = window.open(dialogUrl,'helpDlg',argsStr);
						commonspot.lightbox.helpDlg.focus();
					}
				}				
			}

		}
		if(info.subtitle.length)
		{
			(dialogObj.headerSubtitle).innerHTML = info.subtitle;
			(dialogObj.headerSubtitle).style.display = '';
		}	
		else
			(dialogObj.headerSubtitle).style.display = 'none';
		
		if (typeof(info.close) == 'undefined')
			info.close = true;

		if (typeof(info.reload) == 'undefined')
			info.reload = true;
			
		if (args.hideReload)
			info.reload = false;					
		if(info.maximize)
		{
			dialogObj.maxImg.style.visibility = 'visible';
			dialogObj.maxImg.style.display = 'inline';
		}	
		else
		{
			if( dialogObj.maxImg )
			{
				dialogObj.maxImg.style.display = 'none';
				dialogObj.maxImg.style.visibility = '';
			}
			dialogObj.hasMaxButton = false;
		}
				
		if(info.reload)
		{
			dialogObj.reloadImg.style.display = 'inline';
			dialogObj.reloadImg.style.visibility = 'visible';
		}

		if(typeof dialogObj.closeImg == 'undefined'){}
		else if(info.close)
		{
			dialogObj.closeImg.style.visibility = 'visible';
			dialogObj.closeImg.style.display = 'inline';
		}
		else
			dialogObj.closeImg.style.display = 'none';
	}
	
	dialogObj.showCrash = function()
	{
		var maxVals = commonspot.lightbox.getMaxSize();
		dialogObj.resize(maxVals.width-60, maxVals.height);
		dialogObj.iframeNode.style.overflow = "scroll";
		dialogObj.show();
		commonspot.dialog.client.alert("We're sorry, an error has occurred.<br />Close this message to view the available details.<br />Please see your server logs for more information.");
	};
	
	// Set initial size
	dialogObj.resize(commonspot.lightbox.DIALOG_DEFAULT_WIDTH, commonspot.lightbox.DIALOG_DEFAULT_HEIGHT);
	// Update z-index counter
	commonspot.lightbox.dialogFactory.zIndexCounter = commonspot.lightbox.dialogFactory.zIndexCounter +2;
	return dialogObj;
};

commonspot.lightbox.addSpellCheckButton = function(vDoc)
{
	var forms = vDoc.forms;
	var hasSpellcheck = false;
	var allFields = [];
	var noSpellCheckFlds = '';
	if (!forms.length)
		return;
		
	var spellCheckData = commonspot.data.SpellCheck_GetSettings.getData()[0];	
	if(!spellCheckData || !spellCheckData.enablespellcheck)
		return;
		
	var fld = vDoc.getElementById('noSpellCheckFields');
	if (fld && fld.value)
		noSpellCheckFlds = ',' + fld.value + ',';
		
	if (!hasSpellcheck)
	{
		for (var i=0; i<forms[0].elements.length; i++)
		{
			fld = forms[0].elements[i];
			fldStr = ',' + fld.name + ',';
			if ((fld.type == "text" || fld.type == "textarea") && (noSpellCheckFlds.indexOf(fldStr) == -1))
			{
				hasSpellcheck = true;
				break;
			}	
		}
	}	
	if (!hasSpellcheck)
		return;
	footer = vDoc.getElementById('dialogFooter');

	if (footer && hasSpellcheck)
	{
		var isChecked = "";
			isChecked = ' checked="checked"';
		if (spellCheckData.defaultstate == 'Enforce spell check')
			isChecked += ' disabled="disabled"';
		var dom = top.document.createElement('div');
		dom.id = 'spellCheckContainer';
		var label = top.document.createElement('label');
		dom.appendChild(label);
		var input = top.document.createElement('input');
		input.type = 'checkbox';
		input.id = 'SpellCheckOn';
		input.name = 'SpellCheckOn';
		input.value = 1;
		if (spellCheckData.defaultstate == 'Enforce spell check' || spellCheckData.defaultstate == 'Default On')
			input.checked = true;
		if (spellCheckData.defaultstate == 'Enforce spell check')
			input.readonly = true;
		label.appendChild(input);
		var tNode = top.document.createTextNode('Spell check');
		label.appendChild(tNode);						
		footer.appendChild(dom);
	}
};
commonspot.lightbox.loadingMsg =
{
	init: function()
	{
		var dom = top.document.createElement('div');
		dom.id = 'loading_container';
		dom.style.display = 'none';
		var dom2 = top.document.createElement('div');
		dom2.id = 'loading_content';
		dom2.title = 'Loading, please wait';
		img = top.document.createElement('img');
		img.id = 'loading_img';
		img.src = '/commonspot/dashboard/images/dialog/loading.gif';
		img.title = 'Loading, please wait';
		dom3 = top.document.createElement('div');
		dom3.id = 'loading_text';
		dom2.appendChild(img);
		dom2.appendChild(dom3);
		dom.appendChild(dom2);
		return top.document.body.appendChild(dom);
	},
	onDashboardLoaded: function()
	{
		top.document.getElementById('loading_container').style.display = 'none'; // kill initial Loading msg
		// add border, which we don't want against initial plain white, and background
		var loading_content = top.document.getElementById('loading_content');
		loading_content.style.border = '1px solid #7E96AD';
		loading_content.style.background = '#fff';
	},
	show: function(overlayMsg, overlayTitle)
	{
		var loadingDiv = top.document.getElementById('loading_content');
		if (!loadingDiv)
			loadingDiv = commonspot.lightbox.loadingMsg.init();
		var loadingImg = top.document.getElementById('loading_img');
		if (loadingDiv)
		{
			loadingDiv.title = overlayTitle;
			if (loadingImg)
				loadingImg.title = overlayTitle;
			setTimeout(function()
			{
				// attach onclick event to close if this is there even after 3 secs.
				if (top.document.getElementById('loading_container').style.display != 'none')
				{
					loadingDiv.onclick = function(e) {
						var event = e || window.event;	
					   if(typeof event.stopPropagation!='undefined')
					      event.stopPropagation();
					   else
					      event.cancelBubble=true;			
						commonspot.lightbox.closeCurrent();			
					}
					var delayOverlayMsg = "Loading, please wait or click to abort";
					loadingDiv.title = delayOverlayMsg;
					if (loadingImg)
						loadingImg.title = delayOverlayMsg;
				}
			},3000);	
		}
		top.document.getElementById('loading_text').innerHTML = overlayMsg;
		top.document.getElementById('loading_container').style.display = 'block';
	},
	hide: function()
	{
		var loadingContainer = top.document.getElementById('loading_container');
		if (loadingContainer && loadingContainer.style)
			loadingContainer.style.display = 'none';
		var content = top.document.getElementById('loading_content');	
		if (content)
			content.onclick = {};
	}
};

/**
 * Helper method generate XHTML for top and bottom corners
 * @param type	(string). Required. Either 't' for top, or 'b', for bottom
 * @param width  (int). Required. Dimension of the dialog
 * @return XHTML code
 */
commonspot.lightbox.generateHTMLcorners = function(type)
{
	var cornersHTML = '';
	var spacerWidth = commonspot.lightbox.DIALOG_DEFAULT_WIDTH - commonspot.lightbox.CORNERS_WIDTH;
	cornersHTML += '<img width="10" height="10" src="/commonspot/javascript/lightbox/' + type + 'l.gif"/>';
	cornersHTML += '<img width="' + spacerWidth + '" height="10" src="/commonspot/javascript/lightbox/' + type + 'spacer.gif"/>';
	cornersHTML += '<img width="10" height="10" src="/commonspot/javascript/lightbox/' + type + 'r.gif"/>';
	return cornersHTML;
};


commonspot.lightbox.hideQAElements = function(objList)
{
	var frName = commonspot.lightbox.stack.last().getFrameName();
	var elem;
	var allObjects = "QAStatusMsg_,statusIcon_,docIcon_,qaIcon_,reportsIcon_";
	allObjects = allObjects.replace(/_/gi,"_"+frName);
	if (objList == 'All')
	{
		var objList = allObjects;
	}	
	var elems = allObjects.split(",");
	for(var i=0; i<elems.length; i++)
	{
		elem = document.getElementById(elems[i]);
		if(elem)
		{
			if (objList.indexOf(elems[i])>=0)
				elem.style.display='none';
			else
				elem.style.display='';	
		}
	}
}

commonspot.lightbox.getResizeControlState = function(name)
{
	// 1: maximized 2: normal 0: unknown
	if (typeof name == 'undefined')
		return;
	var cState = 0;
	var btnID = name + '_' + parseInt(parseInt(commonspot.lightbox.dialogFactory.zIndexCounter)-1);
	var btnObj = document.getElementById(btnID);
	var cName = (btnObj && btnObj.className) ? (btnObj.className).replace('actionMontageIcon','') : '';
	if (cName.indexOf('ico_maximize') >= 0)
		cState = 2;
	else if (cName.indexOf('ico_pop') >= 0)
		cState = 1;	
	return cState;
}
/**
 * Utility method. Returns inner size of current viewport
 * @return {width, height, scrollX, scrollY}
 */
commonspot.lightbox.getWinSize = function(checkCurrentFrameFirst, wnd)
{
	var width, height, scrollX, scrollY, pgFrame, pgWin, checkAccess;
	if (typeof checkCurrentFrameFirst == 'undefined')
		var checkCurrentFrameFirst = false;
	if (!wnd)
		var wnd = top;	
	if (checkCurrentFrameFirst)
	{
		try // need this try-catch to avoid IE 'access denied' error when there is no page context.
		{
			if (commonspot.lightbox.stack.length)
			{
				pgWin = commonspot.lightbox.stack.last().getWindow();
				checkAccess = commonspot.lightbox.stack.last().getFrameName();
			}	
			else
			{
				pgFrame = top.document.getElementById('page_frame');
				if (pgFrame)
				{
					pgWin = pgFrame.contentWindow;
					checkAccess = pgWin.name;
				}
			}
		}
		catch(e)
		{	
			pgWin = null;
			checkAccess = null;
		}	
		if (checkAccess)
			return commonspot.lightbox.getWinSize(false, pgWin);
	}
	if( typeof( wnd.innerWidth ) == 'number' ) 
	{
		//Non-IE
		width = wnd.innerWidth;
		height = wnd.innerHeight;
	} 
	else if( wnd.document.documentElement && 
				( wnd.document.documentElement.clientWidth || wnd.document.documentElement.clientHeight ) ) 
	{
		//IE 6+ in 'standards compliant mode'
		width = wnd.document.documentElement.clientWidth;
		height = wnd.document.documentElement.clientHeight;
	} 
	else if( wnd.document.body && ( wnd.document.body.clientWidth || wnd.document.body.clientHeight ) ) 
	{
		//IE 4 compatible
		width = wnd.document.body.clientWidth;
		height = wnd.document.body.clientHeight;
	}
	if( typeof( wnd.pageYOffset ) == 'number' ) 
	{
		//Netscape compliant
		scrollY = wnd.pageYOffset;
		scrollX = wnd.pageXOffset;
	} 
	else if( wnd.document.body && ( wnd.document.body.scrollLeft || wnd.document.body.scrollTop ) ) 
	{
		//DOM compliant
		scrollY = wnd.document.body.scrollTop;
		scrollX = wnd.document.body.scrollLeft;
	} 
	else if( wnd.document.documentElement && 
				( wnd.document.documentElement.scrollLeft || wnd.document.documentElement.scrollTop ) ) 
	{
		//IE6 standards compliant mode
		scrollY = wnd.document.documentElement.scrollTop;
		scrollX = wnd.document.documentElement.scrollLeft;
	}
	
	return {width: width, height: height, scrollX: scrollX, scrollY: scrollY};
};


function activateFields(win)
{
	var firstFld = null;
	var cDoc = null;
	if(win.document.forms.length)
	{
		for (var i=0; i<win.document.forms.length; i++)
		{
			commonspot.util.dom.activateAllFields(win.document.forms[i]);
		}
	}
	var iFrames = win.document.getElementsByTagName('iframe');
	// all other
	for (i=0; i<iFrames.length; i++)
	{
		try
		{
			cDoc = (iFrames[i].contentWindow || iFrames[i].contentDocument);
			if (cDoc.document)
				cDoc = cDoc.document;			
		}
		catch(e)
		{
			continue;
		}	
		if (cDoc && cDoc.forms && cDoc.forms.length)
		{
			for (var j=0; j<cDoc.forms.length; j++)
			{
				commonspot.util.dom.activateAllFields(cDoc.forms[j]);
			}
			iFrames[i].contentWindow.focus();
		}
	}

	//win.focus();
}

function InitDragDrop() 
{ 
	if( typeof OnMouseDown != 'undefined' ) 
	{
		commonspot.util.event.addEvent(document, "mousedown", OnMouseDown);
		commonspot.util.event.addEvent(document, "mouseup", OnMouseUp);
	}
	else
		setTimeout( "InitDragDrop()", 100 );
}

InitDragDrop(); 


/*
     FILE ARCHIVED ON 00:37:39 Mar 30, 2019 AND RETRIEVED FROM THE
     INTERNET ARCHIVE ON 07:28:03 Feb 24, 2020.
     JAVASCRIPT APPENDED BY WAYBACK MACHINE, COPYRIGHT INTERNET ARCHIVE.

     ALL OTHER CONTENT MAY ALSO BE PROTECTED BY COPYRIGHT (17 U.S.C.
     SECTION 108(a)(3)).
*/
/*
playback timings (ms):
  esindex: 0.017
  exclusion.robots.policy: 0.204
  PetaboxLoader3.datanode: 66.586 (4)
  captures_list: 163.789
  CDXLines.iter: 11.487 (3)
  exclusion.robots: 0.217
  PetaboxLoader3.resolve: 97.744 (2)
  load_resource: 64.206
  LoadShardBlock: 107.015 (3)
  RedisCDXSource: 40.621
*/</script><script id="cs_overrides" type="text/javascript" src="/commonspot/javascript/lightbox/overrides.js">/* 
 * overrides.js   Copyright PaperThin, Inc.
 */
	
checkDlg = function()
{
	ResizeWindow();
}

CloseWindow = function()
{
	top.commonspot.lightbox.closeCurrent();
}

cs_OpenURLinOpener = function(workUrl)
{
	OpenURLInOpener(workUrl);
}

doCPOpenInOpener = function(workUrl)
{
	OpenURLInOpener(workUrl);
}

DoFocus = function(){};

handleLoad = function()
{
	ResizeWindow();
}

if (typeof handleLoad != 'function')
{
	handleLoad = function()
	{
		ResizeWindow();
	}
}	

csExtendedWindow = function(name, url, windowProps)
{
	var wnd = window.open(url, name, windowProps);
}
	
newWindow = function(name, url, customOverlayMsg, openInWindow, windowProps)
{
	var customOverlayMsg = customOverlayMsg ? customOverlayMsg : null;	
	var openInWindow = openInWindow ? openInWindow : false;
	var windowProps = windowProps ? windowProps : null;
	var wnd = top;
	var opr;
	var url = typeof url != 'undefined' ? url : '';
	if (openInWindow == true)
	{
		var wnd = window.open(url, name, windowProps);
		return wnd;
	}
	if (url.indexOf('/commonspot/dashboard/') == 0 || url.indexOf('controls/imagecommon/add-image') > 0)
	{	
		if (!top.commonspot.util.browser.valid)
		{
			alert('This functionality requires Internet Explorer versions 9 (or later) or Firefox Extended Support Release (ESR) versions or Safari 6 or 7 (only on Mac OS) or Chrome 31 (or later).');
			return;
		}
		var setupComplete = checkDashboardSetup();
		if (!setupComplete)
		{
			setTimeout(function(){
				newWindow(name, url, customOverlayMsg);
			},1);
			return;
		}	
	}	

	if (top.commonspot && top.commonspot.lightbox)
	{
		if (top.commonspot.lightbox.stack.length > 0)
			opr = top.commonspot.lightbox.stack.last().getWindow();	    
		top.commonspot.lightbox.openDialog(url, null, name, customOverlayMsg, null, opr);
		wnd = top.commonspot.lightbox.stack.last().getWindow();
	}
	return wnd;
}

OpenURLandClose = function(workUrl)
{
	var openerWin = top.commonspot.lightbox.getOpenerWindow();
	openerWin.location.href = workUrl;
	if (document.getElementById("leavewindowopen").checked == false)
	{
		setTimeout('window.close()', 250);
	}
}

OpenURLInOpener = function(workUrl)
{
	var openWin = top.commonspot.lightbox.getOpenerWindow();
	if (openWin)
	{
		openWin.location.href = workUrl;
	}	
}

RefreshAndCloseWindow = function(clearQueryParams)
{
	clearQueryParams = clearQueryParams ? clearQueryParams : 0;
	var openWin, openFrame;
	if (clearQueryParams)
	{
		ResetParentWindow();
		return;
	}
	try // without this try-catch IE throws Access Denied for dialogs called from site-admin
	{
		if (top.commonspot.util.browser.chrome || top.commonspot.util.browser.safari) //
		{
			openFrame = top.commonspot.lightbox.getOpenerLightboxFrame();
			// next line are exceptions to this special case, re accurev 17450 and 17894
			var doSpecialCase = openFrame
					&& (openFrame.src.indexOf('/dashboard/dialogs/siteadmin/metadata-form-addedit.html') === -1)
					&& (openFrame.src.indexOf('/commonspot/dashboard/null') === -1);
			if (doSpecialCase)
				openFrame.src = openFrame.contentWindow.location.href;
			else
			{
				openWin = top.commonspot.lightbox.getOpenerWindow();
				if (openWin)
					openWin.location.reload();			
			}
		}
		else
		{
			openWin = top.commonspot.lightbox.getOpenerWindow();
			if (openWin)
				openWin.location.reload();
		}
	}
	catch(e) {}	
	CloseWindow();
}

ResetParentWindow = function()
{
	var pWin = top.commonspot.lightbox.getOpenerWindow();
	try // without this try-catch IE throws Access Denied for dialogs called from site-admin
	{
		if (pWin)
		{
			var addPageInLView = 0;
			var pSearch = pWin.location.search;
			if (pSearch.indexOf('cs_pgIsInLView=1') >= 0)
				addPageInLView = 1;
			var pHref = pWin.location.href;
			if (pHref.length && pSearch.length)
				pHref = pHref.replace(pSearch, '');
			if (addPageInLView)
				pHref = pHref + '?cs_pgIsInLView=1';
			if (pHref != pWin.location.href)
				pWin.location.href = pHref;
			else
				pWin.location.reload();
		}	
	}
	catch(e) {}	
	CloseWindow();	
}


RefreshParentWindow = function()
{
	var openerWin = top.commonspot.lightbox.getOpenerWindow();
	pageid = openerWin.js_gvPageID;
	if (pageid > 0)
	{
		openerWin.document.cookie = "scrollPage=" + pageid;
		openerWin.document.cookie = "scrollX=" + cd_scrollLeft;
		openerWin.document.cookie = "scrollY=" + cd_scrollTop;
	}
	openerWin.location.reload();
	DoFocus(self);
	DoFocusDone=1;	// not done, but we don't want the focus
}

ResizeWindow = function(doRecalc, curTab)
{
	if (typeof ResizeWindowSafe != 'undefined')		// this variable is set in dlgcommon-head for legacy dialogs (initially set to 0, then to 1 upon calling dlgcommon-foot)
	{ 
		if (ResizeWindowSafe == 1)
			ResizeWindow_Meat(doRecalc, curTab);  // this function is defined in over-rides.js
		else
			ResizeWindowCalledCount = ResizeWindowCalledCount + 1;
	}
	else
		ResizeWindow_Meat(doRecalc, curTab);  // this function is defined in over-rides.js
}


ResizeWindow_Meat = function(doRecalc, currentTab)
{
	var maintable = document.getElementById('MainTable');
	if (maintable)
	{
		if (doRecalc)
		{
			if (top.commonspot)
			{
				top.commonspot.lightbox.initCurrentServerDialog(currentTab);
				ResizeWindow_Meat();
			}	
		}
		else
		{
			fixMinHeightAndWidth(maintable);
			if (top.commonspot)
			{
				top.commonspot.lightbox.initCurrent(maintable.offsetWidth+5, maintable.offsetHeight + 42);
				fixFooterWidth(maintable.offsetWidth,maintable.offsetHeight + 40);
			}	
		}	
		// to fix IE7 insanity! without this, in ie7 the maintable is not getting its gray background set.
		var mClass = maintable.className;
		if (mClass.indexOf('csMainTable') < 0)
			mClass += ' csMainTable';
		maintable.className = mClass;	
	}	
}	

fixMinHeightAndWidth = function(maintable)
{
	var curScript;
	var minWidth = 300;
	var minHeight = 130;
	// first check if there are tabs rendered in the dialog
	try
	{
		var ele = maintable.getElementsByClassName('cs_tab_active');
		if (ele.length > 2) 
			minWidth = 550;	
	}
	catch(e){};		
	// check if calendar field is rendered if so, we need the ht to be at least ht of the calendar.	
	var jsScripts = document.getElementsByTagName('SCRIPT');
	for (var i=0; i<jsScripts.length; i++)
	{
		curScript = jsScripts[i];
		try
		{
			if (curScript.src && (curScript.src).indexOf('calendar.js') >0)
				minHeight = 180;
		}
		catch(e){};
	
	}	
	if (maintable.offsetHeight < minHeight)
		maintable.style.height = minHeight+'px';
	else
		maintable.style.height = '';
	if (maintable.offsetWidth < minWidth)
		maintable.style.width = minWidth+'px';	
};

fixFooterWidth = function() 
{
	var proxyBtnTable = document.getElementById('clsProxyButtonTable');
	var maintable = document.getElementById('MainTable');
	//debugger;
	if (proxyBtnTable && maintable && proxyBtnTable.offsetWidth > (maintable.offsetWidth+10))
	{
		maintable.style.width = proxyBtnTable.offsetWidth + 'px';
		top.commonspot.lightbox.initCurrent(proxyBtnTable.offsetWidth, maintable.offsetHeight + 40);
	}
};

setthefocus = function(){};


checkDashboardSetup = function()
{
	if (top.commonspot.clientUI && top.commonspot.dialog && top.commonspot.dialog.server)
		return true;

	
	doDashboardSetup();
}

doDashboardSetup = function()
{
	if (parent.window.document.getElementById("hiddenframeDiv"))
		return true;
	if (document.parentWindow)
		var curWin = document.parentWindow;
	else
		var curWin = window;	
	var iframeDiv = curWin.parent.parent.document.createElement('div');
	iframeDiv.id = 'hiddenframeDiv';
	iframeDiv.style.left = '-1000px';
	iframeDiv.style.top = '-1000px';
	
	var iframeHTML = '<iframe src="/commonspot/dashboard/hidden_iframe.html" name="hidden_frame" id="hidden_frame" width="1" height="1" scrolling="no" frameborder="0"></iframe>';
	iframeDiv.innerHTML = iframeHTML;
	var hiddenFrame = iframeDiv.childNodes[0];
	parent.window.document.body.appendChild(iframeDiv);
	return true;
}

	
convertHrefToOnclick = function(doc, elemID)
{
	var newOC,existingOC,href,shown,style,isJS,itms;
	var elemID = elemID ? elemID : null;
	var doc = doc ? doc : document;
	if (elemID)
		itms = document.getElementById(elemID).getElementsByTagName('a');
	else
		itms = document.getElementsByTagName('a');
	for (var i=0; i<itms.length; i++)
	{
		elem = itms[i];
		href = elem.getAttribute('href');
		isJS = /javascript/.test(href);
		style = elem.style;
		shown = style ? style.display : '';
		// walk the links only if they have a href attrib and it is displayed	
		if (href && shown!='none' && href != '#' && isJS) 
		{
			newOC = href.replace(/javascript:/gi, '');
			if (newOC == ';') // handle situation where we have just javascript:; in href attribute
				newOC = '';
			existingOC = elem.getAttribute('onclick');
			// replace when newOC is not empty and not already in existingOC OR when there is no existingOC
			if ((existingOC && newOC != '' && existingOC.indexOf(newOC) == -1) || !existingOC )
				existingOC = (existingOC ? (existingOC + ';') : '') + newOC;
			elem.setAttribute('onclick', existingOC);
			elem.setAttribute('href', 'javascript:;');					
			//elem.removeAttribute('href');
		}		
	}
}

if (typeof(onLightboxLoad) == "undefined")
{
	/**
	* Hook that gets called by lightbox whenever the dialog gets loaded
	*/
	onLightboxLoad = function() 
	{	
		try{
			var rootDiv = document.getElementById('cs_commondlg')
		}catch(e){ 
			// $ function is not defined when there is an error. 
			// in that case, just return so we can show the error msg.
			return; 
		}	
		convertHrefToOnclick(document);
		if (rootDiv)
		{	 
			// Check if we have buttons
			
			var outerDiv = document.getElementById('clsPushButtonsDiv');
			var tableEle = document.getElementById('clsPushButtonsTable');
			var otherBtns = top.commonspot.util.dom.getElementsByClassName('clsDialogButton', document);
			if (tableEle || otherBtns.length)
			{
				// Remove existing "proxy" buttons first
				var btnHolder = document.getElementById('clsProxyButtonHolder');
				if (btnHolder)
				{
					btnHolder.parentNode.removeChild(btnHolder);
				}
				
				// check if cf debug is on
				var arr = top.commonspot.util.dom.getElementsByClassName('cfdebug', document);
				// Append a new <div> that will contain the "proxy" buttons
				var dom = document.createElement('div');
				dom.id = "clsProxyButtonHolder";
				dom.innerHTML = '<table id="clsProxyButtonTable" border="0" cellspacing="2" cellpadding="0"><tr><td id="clsProxySpellCheckCell" nowrap="nowrap"></td><td id="clsProxyButtonCell" nowrap="nowrap"></td></tr></table>';				
				if (arr.length > 0) 	// stick in after root div and before CF debug table
				{
					/*
						IE ver < 10 has problem with appending node before a script node. to get around it we add a div 
						node around	the script tags we have after rootDiv (dlgcommon-foot.cfm) and manipulate its innerHTML
						however, non-ie browsers has problem with manipulating innerHTML so doing it ol'way
					*/
					if (top.commonspot.util.browser.ie && top.commonspot.util.browser.version < 10)
					{
						var inHTML = dom.outerHTML + rootDiv.nextSibling.innerHTML;
						rootDiv.nextSibling.innerHTML = inHTML;
					}
					else
						rootDiv.parentNode.insertBefore(dom, rootDiv.nextElementSibling);
				}	
				else
					rootDiv.parentNode.appendChild(dom);

				proxySpellChecker($('clsProxySpellCheckCell'));
				proxyPushButtons($('clsProxyButtonCell'));
				// Hide the "real" buttons
				if (outerDiv)
					outerDiv.style.display='none';
				if (tableEle)
					tableEle.style.display='none';
			}
		}
	}
}	

proxyPushButtons = function(targetNode)
{
	var cellNode = $('clsProxyButtonCell');
	var buttons = $$('#clsPushButtonsTable input[type="submit"]', '#clsPushButtonsTable input[type="button"]');
	var moreButtons = top.commonspot.util.dom.getElementsByClassName('clsDialogButton', document, 'INPUT');
	var addClose = 0;
	for (var i=0; i<moreButtons.length; i++)
	{
		// lame! but FF is not happy with concat arrays feature;
		buttons.push(moreButtons[i]);
	}
	if ((buttons.length == 1 && buttons[0].value == 'Help') || buttons.length == 0)
		addClose = 1;
	cleanRadioAndCheckBoxes($$('#MainTable input[type="checkbox"]', '#MainTable input[type="radio"]'));
	var doneButtons = [];
	var buttonString = [];
	for(var i=0; i<buttons.length; i++)
	{
		buttons[i].style.display = 'none';
		var buttonText = buttons[i].value.replace(/^\s+|\s+$/g, '');
		buttonString[i] = buttonText.toLowerCase();
	}  
	// show prev button
	var indexButton = arrayIndexOf(buttonString,'prev');
	var proxyIndex = 1;
	if (indexButton != -1 && arrayIndexOf(doneButtons,'prev') == -1)    
	{
	  cellNode.appendChild(createProxyButton(buttons[indexButton],proxyIndex++));
	  doneButtons.push('prev');
	}

	// show next button
	indexButton = arrayIndexOf(buttonString,'next');
	if (indexButton != -1 && arrayIndexOf(doneButtons,'next') == -1)    
	{
	  cellNode.appendChild(createProxyButton(buttons[indexButton],proxyIndex++));
	  doneButtons.push('next');
	}      
    // show all misc. buttons that are not submit and not cancel or close
	for(var i=0; i<buttons.length; i++)
	{
		buttonText = buttons[i].value.replace(/^\s+|\s+$/g, '');
		if (buttonText != 'Help' && 
		      buttonText != 'Close' &&
				buttonText != 'No' &&
		      buttonText != 'Cancel' &&
		      buttons[i].type == 'button' &&
				arrayIndexOf(doneButtons,buttonText) == -1)
		{
			cellNode.appendChild(createProxyButton(buttons[i],proxyIndex++));
			doneButtons.push(buttonText);
		}
	}
     
     
	// show all submit buttons that are not cancel or close
	for(var i=0; i<buttons.length; i++)
	{
		buttonText = buttons[i].value.replace(/^\s+|\s+$/g, '');
		if (buttonText != 'Help' && 
					buttonText != 'Close' &&
					buttonText != 'No' &&
					buttonText != 'Cancel' &&
					buttons[i].type == 'submit' &&
					arrayIndexOf(doneButtons,buttonText) == -1)
		{
			cellNode.appendChild(createProxyButton(buttons[i],proxyIndex++));
			doneButtons.push(buttonText);
		}
	}     

	// show cancel and close buttons
	for(var i=0; i<buttons.length; i++)
	{
		buttonText = buttons[i].value.replace(/^\s+|\s+$/g, '');
		if (buttonText != 'Help' && arrayIndexOf(doneButtons,buttonText) == -1)
		{
			cellNode.appendChild(createProxyButton(buttons[i],proxyIndex++));
			doneButtons.push(buttonText);
		}   
	}  

	if (arrayIndexOf(doneButtons, 'cancel') != -1 || arrayIndexOf(doneButtons, 'close') != -1)
		addClose = 0;
	
	// show close button if there are no buttons in the lighbox
	if (addClose && cellNode)
	{
		var closeNode = {
			value: 'Close',
			className: 'clsCloseButton',
			type: 'button',
			name: 'Close'
		};
		cellNode.appendChild(createProxyButton(closeNode,proxyIndex++));
	} 
}

cleanRadioAndCheckBoxes = function(buttons)
{
   var cName = "";
   for (var i=0; i<buttons.length; i++)
   {
      cName = buttons[i].className;
      if (cName.indexOf('clsNoBorderInput')==-1)
      {
         buttons[i].className = cName+' clsNoBorderInput';
      }
   }
}
proxySpellChecker = function(targetNode)
{
	var boxNode = $('OldSpellCheckOn');
	// Proxy the node only if it's visible (it could be hidden)
	if (boxNode && (boxNode.type == 'checkbox'))
	{
		var proxyLabel = document.createElement('label');
		var proxyBox = document.createElement('input');
		proxyBox.setAttribute('id', 'SpellCheckOn');
		proxyBox.setAttribute('name', 'SpellCheckOn');
		proxyBox.setAttribute('type', 'checkbox');
		proxyBox.setAttribute('value', 1);
		proxyBox.className = 'clsNoBorderInput';
		proxyBox.onclick = function(){
			var o = $('OldSpellCheckOn');
			if (o)
				o.checked = this.checked;
		};
		proxyLabel.appendChild(proxyBox);
		proxyLabel.appendChild(document.createTextNode('Check Spelling'));
		targetNode.appendChild(proxyLabel);
		// Reflect original's status
		proxyBox.checked = boxNode.checked;
	}
}
			
/**
 * Helper method. Generate a proxy DOM node out of an original button
 * @param buttonNode   (node). Required. The original button DOM node
 * @return node
 */
createProxyButton = function(buttonNode,index)
{

	/*
	 Buttons must be styled to look as links. 
	 Since this can be tricky accross browsers, we wrap a <span> around the buttons 
	*/
	
	// Use trimmed value for text
	var buttonText = buttonNode.value.replace(/^\s+|\s+$/g, '');
	var newButtonText = buttonText;
	if (buttonText == 'OK' || buttonText == 'Finish')
		newButtonText = 'Save';    

	var proxyContainer = document.createElement('span');
	proxyContainer.id = 'proxyButton' + index; 
	if (buttonNode.title)
		proxyContainer.title = buttonNode.title;
	proxyContainer.className = buttonNode.className;  
	if ((buttonText == 'Cancel' || buttonText == 'Close') && 
				(buttonNode.className.indexOf('clsPushButton') >= 0 || buttonNode.className.indexOf('clsCancelButton') >= 0 || buttonNode.className.indexOf('clsCloseButton') >= 0)){
	  proxyContainer.className = 'cls'+buttonText+'Button';
	}

	var proxyBox = document.createElement('input');
	if (buttonNode.type == 'submit' && typeof buttonNode.click == 'function'){
	  proxyBox.setAttribute('type', 'button');
	}
	else{
		proxyBox.setAttribute('type', buttonNode.type);
	}   
	proxyBox.setAttribute('name', buttonNode.name);
	proxyBox.setAttribute('value', newButtonText);
	proxyBox.setAttribute('id', buttonText);

	if (newButtonText=='Cancel' || newButtonText=='Close')
	{
	  proxyContainer.onclick = function()
	  {
		if (typeof buttonNode.click == 'function' || typeof buttonNode.click == 'object')
		{
			buttonNode.click();
		}
		else
	      top.commonspot.lightbox.closeCurrent();
	  }
	}   
	else   
	{
		proxyContainer.onclick = function()
		{
			if (typeof buttonNode.click == 'function' || typeof buttonNode.click == 'object')
			{
				buttonNode.click();
			}	
			return false;
		}
	}		
	proxyBox.onmouseover = function()
	{
		this.style.textDecoration = 'underline';
		return false;
	}
	proxyBox.onmouseout = function()
	{
		this.style.textDecoration = 'none';
		return false;
	}	
	proxyContainer.appendChild(proxyBox);
	return proxyContainer;
}
/**
* Helper method.    Return index of an element in an array NOT case-sensitive.
* @param _this      Required. Array
 * @param x          Required. key
* @return index      
*/
arrayIndexOf = function(_this,x) 
{
   for(var i=0;i<_this.length;i++) 
   {
   	if (_this[i].toLowerCase()==x.toLowerCase()) 
   		return i;
   }
   return-1;
}   	
		

if (typeof(onLightboxResize) == "undefined")
{
	
	/**
	 * Hook that gets called by lightbox whenever the dialog gets resized
	 * @param w         (int). Required. Width
	 * @param h         (int). Required. Height
	 */
	onLightboxResize = function(w, h)
	{
		// Remove margins from the dialog's body
		document.body.style.margin = 0;
		document.body.style.padding = 0;
		var rootDiv = document.getElementById('cs_commondlg');
		if (rootDiv)
		{
			main_table = document.getElementById('MainTable');
			if (main_table && main_table.style)
			{
				main_table.style.width = (w-35)+'px';
				rootDiv.style.width = (w-10)+'px';
				main_table.style.height = (h -45) + 'px';
				main_table.style.marginTop = 0;
				rootDiv.style.marginTop = '10px';
				rootDiv.style.height = (h -37) + 'px';
			}	
				
			// Add scrollbars to the main box
			rootDiv.style.overflow = 'auto';
		}
	}

}

/*
     FILE ARCHIVED ON 22:38:43 Mar 29, 2019 AND RETRIEVED FROM THE
     INTERNET ARCHIVE ON 07:28:05 Feb 24, 2020.
     JAVASCRIPT APPENDED BY WAYBACK MACHINE, COPYRIGHT INTERNET ARCHIVE.

     ALL OTHER CONTENT MAY ALSO BE PROTECTED BY COPYRIGHT (17 U.S.C.
     SECTION 108(a)(3)).
*/
/*
playback timings (ms):
  LoadShardBlock: 52.931 (3)
  PetaboxLoader3.datanode: 1241.402 (4)
  exclusion.robots.policy: 0.125
  exclusion.robots: 0.134
  RedisCDXSource: 46.107
  CDXLines.iter: 11.684 (3)
  PetaboxLoader3.resolve: 63.411
  captures_list: 113.946
  esindex: 0.026
  load_resource: 1253.893
*/</script><script id="cs_windowref" type="text/javascript" src="/commonspot/javascript/lightbox/window_ref.js">/*
JavaScript routines to resolve references for windows inside lightbox
*/

getOpener = function(ignoreOpenerProperty)
{
	if ((self != top) && (typeof(top.commonspot)!= 'undefined') && (typeof(top.commonspot.lightbox)!= 'undefined'))
	{
		return top.commonspot.lightbox.getOpenerWindow(ignoreOpenerProperty);
	}
	else
	{
		return self.opener;
	}
}

getOpenerWithIFrame = function(iFrameID)
{
	var wnd = getOpener();
	var obj = wnd.document.getElementById(iFrameID);
	if (obj)
	{
		return obj.contentWindow;
	}
	return getOpener();
}

getRTEopener = function(FrameName)
{
	// Grab the window object out of the RTE's iframe
	if (!FrameName)
		FrameName = 'WebEdit';
	var fr = null;
	var stackLen = 0;
	if ((self != top) && (typeof(top.commonspot)!= 'undefined') && (typeof(top.commonspot.lightbox)!= 'undefined'))
		stackLen = top.commonspot.lightbox.stack.length;
	for (var i=stackLen-1; i>=0; i--)
	{
		if(i == 0)
		{
			fr = top.commonspot.lightbox.stack[i].getWindow().getOpenerWithIFrame(FrameName);
			return fr;  // here fr is a window
		}
		else
			fr = top.commonspot.lightbox.stack[i].getWindow().document.getElementById(FrameName);
		if (fr)
			return fr.contentWindow;
	}
	return fr;
}


getRTEObject = function(FrameName, checkFrames)
{
	// Grab the window object out of the RTE's iframe
	var checkFrames = (typeof checkFrames == 'undefined') ? true : checkFrames;
	var FrameName = (typeof FrameName == 'undefined') ? 'WebEdit' : FrameName;
	var fr = null;
	var wn = null;
	var rteObj = null;
	var stackLen = 0;
	var fWn = null;
	if ((self != top) && (typeof(top.commonspot)!= 'undefined') && (typeof(top.commonspot.lightbox)!= 'undefined'))
		stackLen = top.commonspot.lightbox.stack.length;
	for (var i=stackLen-1; i>=0; i--)
	{
		wn = top.commonspot.lightbox.stack[i].getWindow();
		if (wn)
		{
			if (checkFrames)
			{
				for (j=0; j<wn.frames.length; j++)
				{
					try
					{
						fWn = wn.frames[j].contentWindow;
						if (fWn)
						{
							if (typeof fWn['CKEDITOR'] != 'undefined')
							{
								rteObj = fWn['CKEDITOR'].instances[FrameName];
								break;
							}	
						}
					}catch(e){}	
				}
			}
			else
			{
				try
				{
					if (typeof wn['CKEDITOR'] != 'undefined')
					{
						rteObj = wn['CKEDITOR'].instances[FrameName];
						break;
					}	
				}catch(e){}	
			}		
		}
	}
	if (!rteObj)
	{
		wn = top;
		if (checkFrames)
		{
			for (j=0; j<wn.frames.length; j++)
			{
				try
				{
					fWn = wn.frames[j];
					if (typeof fWn['CKEDITOR'] != 'undefined')
					{
						rteObj = fWn['CKEDITOR'].instances[FrameName];
						break;
					}	
				}catch(e){}	
			}
		}
		else
		{
			try
			{
				if (typeof wn['CKEDITOR'] != 'undefined')
					rteObj = wn['CKEDITOR'].instances[FrameName];
			}catch(e){}		
		}			
	}
	return rteObj;
}

hasLightbox = function()
{
	return ((top != self) && (typeof(top.commonspot)!= 'undefined') && (typeof(top.commonspot.lightbox)!= 'undefined'));
}

var cleanHTMLWnd;
var spellcheckerWnd;
getCleanHTMLTarget = function(dlgLoader)
{
	var url = dlgLoader ? dlgLoader + '?csModule=/commonspot/dhtmledit/clean_dhtml_fields' : '/commonspot/dhtmledit/clean_dhtml_fields.cfm';

	if((top != self) && (typeof(top.commonspot)!= 'undefined') && (typeof(top.commonspot.lightbox)!= 'undefined'))
	{
		var frName;
		for (var i=0; i<top.commonspot.lightbox.stack.length; i++)
		{
			frName = top.commonspot.lightbox.stack[i].getFrameName();
			if (frName == 'cleanHTML')
				return frName;
		}	
		var lightboxTarget = openEmptyLightBox(url, null, 'cleanHTML');
		return top.commonspot.lightbox.getFrameName();
	}
	else
	{
		if (!cleanHTMLWnd || cleanHTMLWnd.closed)
			cleanHTMLWnd = newWindow( 'cleanHTML', url);
		return 'cleanHTML';	
	}
	
}

getSpellCheckTarget = function(dlgLoader)
{
	var url = dlgLoader ? dlgLoader + '?csModule=/commonspot/spellchk/introscreen' : '/commonspot/spellchk/introscreen.cfm';

	if((top != self) && (typeof(top.commonspot)!= 'undefined') && (typeof(top.commonspot.lightbox)!= 'undefined'))
	{
		// Open an empty lightbox
		var frName;
		for (var i=0; i<top.commonspot.lightbox.stack.length; i++)
		{
			frName = top.commonspot.lightbox.stack[i].getFrameName();
			if (frName == 'spellchecker')
				return frName;
		}	
		var lightboxTarget = openEmptyLightBox(url, null, 'spellchecker');
		return top.commonspot.lightbox.getFrameName();
	}
	else
	{
		if (!spellcheckerWnd || spellcheckerWnd.closed)
			spellcheckerWnd = newWindow( 'spellchecker', url);
		return 'spellchecker';	
	}
	
}

closeEmptyChildDialogs = function(frameNameList)
{
	var frameNameList = frameNameList ? frameNameList : 'cleanHTML,spellchecker';
	if ((top != self) && (typeof(top.commonspot)!= 'undefined') && (typeof(top.commonspot.lightbox)!= 'undefined'))
	{
		var win;
		for (var i=top.commonspot.lightbox.stack.length-1; i>=0; i--)
		{
			win = top.commonspot.lightbox.stack[i];
			frName = win.getFrameName();
			if (frameNameList.indexOf(frName) >= 0)
				win.close();
		}
	}	
}

closeCleanHTMLWindows = function()
{
	closeEmptyChildDialogs('cleanHTML');
	/*
	if (self.children)
	{
		for(i=0;i<self.children.length;i++)
			self.children[i].close();
	}
	*/
}


getCSModuleField = function(thisForm)
{
	var fld = null;
	var update = 0;
	if (typeof thisForm.CSMODULE != 'undefined')
	{
		fld = thisForm.CSMODULE;
		update = 1;
	}	
	else if (typeof thisForm.csModule != 'undefined')
		fld = thisForm.csModule;
	else if (typeof thisForm.csmodule != 'undefined')
	{
		fld = thisForm.csmodule;
		update = 1;
	}	
	if (update)
		fld.setAttribute('name', 'csModule');	
	return fld;	
}

closeSpellCheckWindows = function()
{
	closeEmptyChildDialogs('spellchecker');
}

openEmptyLightBox = function(url, hideClose, name, customOverlayMsg)
{
	var lightboxTarget;	
	var url = url ? url : null;
	var hideClose = hideClose ? hideClose : null;
	var name = name ? name : null;
	var customOverlayMsg = customOverlayMsg ? customOverlayMsg : null;
	// If we are inside a lightbox
	if ((top != self) && (typeof(top.commonspot)!= 'undefined') && (typeof(top.commonspot.lightbox)!= 'undefined'))
	{
		// Open an empty lightbox
		top.commonspot.lightbox.openDialog(url, hideClose, name, customOverlayMsg, null, null, true);
		
		lightboxTarget = top.commonspot.lightbox.getFrameName();
		// Form's target now must be the lightbox, not a new window
		return lightboxTarget;
	}
	else
		return;
}

// returns contentWindow of admin-frame
getAdminWindow = function()
{
	var win = null;
	if ((top != self) && (typeof(top.commonspot)!= 'undefined') && (typeof(top.commonspot.lightbox)!= 'undefined'))
		win = top.commonspot.lightbox.getAdminWindow();
	return win;	
}


	/**
	 * Generic alert to user.
	 * see commonspot.dialog.client.showHTMLDialog for supported options
	 * msg can be text, or can be an array, in which case it'll be rendered as an html list
	 */
if ((top != self) && (typeof(top.commonspot)!== 'undefined') && (typeof(top.commonspot.lightbox)!== 'undefined'))
{
	if (typeof top.commonspot.dialog === 'undefined')
		top.commonspot.dialog = {};
	if (typeof top.commonspot.dialog.client === 'undefined')
	{
		top.commonspot.dialog.client = {};

		top.commonspot.dialog.client.alert = function(msg, options)
		{
			var html;
			if(msg.constructor == String)
				html = msg;
			else // assumed to be an array
			{
				if(msg.length === 1)
					html = msg[0];
				else
				{
					html = "<ul>";
					for(var i = 0; i < msg.length; i++)
						html += "<li>" + msg[i] + "</li>";
					html += "</ul>";
				}
			}
			html = html.replace(/\n/g, '<br />');
			top.commonspot.dialog.client.showHTMLDialog(html, options, 'alert');
		}

		/*
		 * create a lightboxed dlg containing the passed html
		 */
		top.commonspot.dialog.client.showHTMLDialog = function(html, options, dialogType)
		{
			var options = options || {};
			var defaultOptions =
			{
				title: "CommonSpot Message",
				subtitle: "",
				helpId: "",
				width: 500,
				height: 600,
				style: '',
				useDefaultStyles: true,
				maximize: false,
				hideClose: false,
				hideHelp: true,
				hideReload: true
			};
			top.commonspot.util.merge(options, defaultOptions);

			dialogType = dialogType || 'dialog';

			var style = options.style;
			if(options.useDefaultStyles)
				style = top.commonspot.dialog.client.getHTMLDialogDefaultStyles() + style;

			html = top.commonspot.dialog.client.getHTMLDialogHTML(html, style, options.title, options);

			// openDialog(url, hideClose, name, customOverlayMsg, dialogType, opener, hideHelp)
			var dlgObj = top.commonspot.lightbox.openDialog("about:blank", options.hideClose, null, top.commonspot.lightbox.NO_OVERLAY_MSG, dialogType, null, options.hideClose, options.hideReload);
			var lightboxWindow = dlgObj.getWindow();
			lightboxWindow.document.write(html);
			lightboxWindow.document.close();

			top.commonspot.lightbox.initCurrent
			(
				options.width,
				options.height,
				{
					title: options.title, subtitle: options.subtitle, helpId: options.helpId,
					close: options.close, reload: options.reload, maximize: options.maximize
				},
				'',
				true
			);

			var dt = lightboxWindow.document.getElementById("dialogContainer");
			var w = Math.max(dt.clientWidth + 30, 350);
			var h = Math.max(dt.clientHeight, 70) - ((options.hideClose && !options.customButtons) ? 30 : 0);
			top.commonspot.lightbox.resizeCurrent(w, h);
			// first wanted this to autosize, to measure it, but now want it full width so close btn is far right
			lightboxWindow.document.getElementById("dialogContainer").style.width = "100%";
		};

		top.commonspot.dialog.client.getHTMLDialogDefaultStyles = function()
		{
			var style =
	'body {font-family: Verdana,Arial,Helvetica,sans-serif; margin: 0; overflow: scroll; text-decoration: none; font-size: 11px;}\n\
	a:active {text-decoration: underline; color: #1D2661;}\n\
	a:hover {text-decoration: underline;color: #003366;}\n\
	a {color: #1D2661;text-decoration: underline;}\n\
	a:visited {	text-decoration: underline;color: #1D2661;}\n\
	#content {margin: 15px 11px; overflow: auto; font-size: 11px;}\n\
	#innerdialogContainer {background-color:#F0F0F0;border-bottom:1px solid #999999;border-top:1px solid #999999;margin-top:10px;}\n\
	#htmlDlgTableCell h2 {font-size: 11px; margin: 15px 0 8px;}\n\
	#htmlDlgTableCell h2:first-child {margin-top: 0;}\n\
	#htmlDlgTableCell p {margin: 0 0 8px; padding: 0;}\n\
	#htmlDlgTableCell ul {margin: 0 0 1em 1em; padding: 0;}\n\
	#htmlDlgTableCell li {margin: 5px;}\n\
	#htmlDlgTableCell dl {margin: 0 0 1em;}\n\
	#htmlDlgTableCell dt {color: #013466; font-weight: bold; margin: 5px 0 0;}\n\
	#htmlDlgTableCell dd {margin: 0 0 0 1.5em;}\n\
	#dialogContainer #dialogFooter {display: block; font-weight: bold; height: 28px; line-height: 28px; margin: 5px 0 0; padding: 0 1px; text-align: right; font-size: 11px;}\n\
	#htmlDlgTableCell .dumpTable caption {font-size: 8pt; font-weight: bold;}\n\
	#htmlDlgTableCell .dumpTable td {border: 1px solid #ccc; font-size: 8pt; padding: 1px;}\n\
	';
			return style;
		};

		top.commonspot.dialog.client.getHTMLDialogHTML = function(alertHTML, styleHTML, title, options)
		{
			var btnHTML = '';
			var linkID, linkClass, linkOnClick, linkObj, linkAccessKey, linkText, linkObj;
			var accessKeyHTML = '';
			btnHTML += options.hideClose ? '' : '<a id="closeButton" accesskey="C" href="javascript:;" onclick="top.commonspot.lightbox.closeCurrent()">Close</a>';
			if (options.customButtons)
			{
				for (var i=0; i<options.customButtons.length; i++)
				{
					linkObj = options.customButtons[i];
					linkID = linkObj.id ? linkObj.id : 'okButton';
					linkOnClick = linkObj.onclick ? linkObj.onclick : '';
					linkText = linkObj.linkText ? linkObj.linkText : '';
					if (linkObj.accessKey)
						accessKeyHTML = ' accesskey="' + linkObj.accessKey + '"';
					if (linkOnClick != '' && linkID != '' && linkText != '')
						btnHTML += '<a id="' + linkID + '"' + accessKeyHTML + ' href="javascript:;" onclick="' + linkOnClick + '">' + linkText + '</a>';
				}
			}
			var html =
				'<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">' +
				'<html>' +
				'<head>' +
					'<link href="/commonspot/dashboard/css/dialog.css" rel="stylesheet" type="text/css" id="dialogcss" />' +
					'<style>' + styleHTML + '</style>' +
					(title ? '<title>' + title + '</title>' : '') +
				'</head>' +
				'<body>' +
					'<table id="dialogContainer">' +
						'<tr><td>' +
							'<table id="innerdialogContainer" width="100%">' +
								'<tr>' +
									'<td id="htmlDlgTableCell">' +
										'<div id="content">' + alertHTML + '</div>' +
									'</td>' +
								'</tr>' +
							'</table>' +
						'</td></tr>' +
						'<tr><td>' +
							'<div id="dialogFooter">' +
								btnHTML +
							'</div>' +
						'</td></tr>'
					'</table>' +
				'</body>' +
				'</html>';
			return html;
		};
	}
}	 

/*
     FILE ARCHIVED ON 22:38:44 Mar 29, 2019 AND RETRIEVED FROM THE
     INTERNET ARCHIVE ON 07:28:06 Feb 24, 2020.
     JAVASCRIPT APPENDED BY WAYBACK MACHINE, COPYRIGHT INTERNET ARCHIVE.

     ALL OTHER CONTENT MAY ALSO BE PROTECTED BY COPYRIGHT (17 U.S.C.
     SECTION 108(a)(3)).
*/
/*
playback timings (ms):
  exclusion.robots.policy: 0.201
  PetaboxLoader3.datanode: 197.225 (4)
  PetaboxLoader3.resolve: 37.602
  LoadShardBlock: 186.266 (3)
  RedisCDXSource: 88.754
  esindex: 0.018
  CDXLines.iter: 12.88 (3)
  load_resource: 51.129
  captures_list: 292.718
  exclusion.robots: 0.213
*/</script></head><body lang="en" class="CS_Document"><a name="__topdoc__"></a><script src="/commonspot/pagemode/always-include-common.js" type="text/javascript"></script><script type="text/javascript">
<!--
		// always-include-ie.js  Copyright 1998-2005 PaperThin, Inc. All rights reserved.

bName = navigator.appName;
bVer = parseInt(navigator.appVersion);

var bCanRollover=0
if (bName == "Netscape")
{
	if(bVer >= 3)
		bCanRollover=1;
}
else if (bName == "Microsoft Internet Explorer")
{
	if(bVer >= 4)
		bCanRollover=1;
}

function ImageSet(imgID,newTarget)
{
	if (bCanRollover)
		document[imgID].src=newTarget;
}
function clearStatus()
{
	window.status = "";
}
function setStatbar(statbar)
{
	var strStatbar=unescape(statbar);
	window.status=strStatbar;
}
function onLoadComplete()
{
	if( menus_included == 1 )
		document.onmouseover = document_mouseover;	// defined in menu_ie.js
}
function HandleLink(parentID,link,displaylink) 
{
	// links are in one of the following formats:
	// 		cpe_60_0,CP___PAGEID=100
	// 		CPNEWWIN:WindowName^params@CP___
	// 			CPNEWWIN:child^top=110:left=130:ww=140:hh=150:tb=1:loc=1:dir=0:stat=1:mb=1:sb=1:rs=1@CP___PAGEID=3811,Adv-Search-2,1
	// displaylink is the server relative URL or fully qualified URL
	windowname = "";
	windowparams = "";

	// "CPNEWWIN:" & NewWindowName & "^" & params & "@" & linkStruct.LinkURL; 
	pos = link.indexOf("CPNEWWIN:");
	if (pos != -1)
	{
		pos1 = link.indexOf ("^");
		windowname = link.substring (pos+9, pos1);
		pos2 = link.indexOf ("@");
		windowparams = link.substring (pos1 + 1, pos2);
		link = link.substring (pos2 + 1, link.length);
	}
	
	if( displaylink && displaylink != "" )
	{		
		if (windowname == "")
			window.location = displaylink;
		else
		{
			windowparams = FormatWindowParams(windowparams);
			window.open (displaylink, windowname, windowparams);
		}
	}
	else
	{
		targetLink = link;

		if (link.indexOf ("CP___") != -1)
		{

			httpPos = -1;
			commaPos = link.indexOf(",");
			if (commaPos != -1)
			{
				targetUrl = link.substr(commaPos + 1);
				if (targetUrl.indexOf("://") != -1 || targetUrl.indexOf("/") == 0)
				{
						httpPos = commaPos + 1;
				}		
			}
				
			if (httpPos != -1)
			{
				targetLink = link.substr(httpPos);

				commaPos = targetLink.indexOf(",");
				if (commaPos != -1)
					targetLink = targetLink.substr(0, commaPos);
			}
			else
				targetLink = jsDlgLoader + "?csModule=utilities/handle-link&thelink=" + link;
			
			if (windowname == "")
				window.location = targetLink;
			else
			{
				windowparams = FormatWindowParams(windowparams);
				window.open (targetLink, windowname, windowparams);
			}
		}
		else
		{
			//commaPos = link.indexOf(",");
			//if (commaPos != -1)
			//	link = link.substr(0, commaPos);

			if (windowname == "")
				window.location = link;
			else
			{
				windowparams = FormatWindowParams(windowparams);
				window.open (link, windowname, windowparams);
			}
		}
	}

}
function doWindowOpen(href,name,params)
{
	if (params != '')
	window.open (href, name, params);
	else
		window.open (href, name);	
}

// 	CPNEWWIN:child^top=110:left=130:ww=140:hh=150:tb=1:loc=1:dir=0:stat=1:mb=1:sb=1:rs=1@CP___PAGEID=3811,Adv-Search-2,1
function FormatWindowParams(windowparams)
{
	if( windowparams.indexOf(":loc=") != -1 || windowparams.indexOf(":ww=") != -1 || windowparams.indexOf(":hh=") != -1 || 
	    windowparams.indexOf(":left=") != -1 || windowparams.indexOf(":top=") != -1 )
	{
		windowparams = substringReplace(windowparams,':left=',',left=');
		windowparams = substringReplace(windowparams,'left=','left=');
		windowparams = substringReplace(windowparams,':ww=',',width=');
		windowparams = substringReplace(windowparams,'ww=','width=');		
		windowparams = substringReplace(windowparams,':hh=',',height=');
		windowparams = substringReplace(windowparams,'hh=','height=');
		windowparams = substringReplace(windowparams,':loc=',',location=');
		windowparams = substringReplace(windowparams,'loc=','location=');
		windowparams = substringReplace(windowparams,':dir=',',directories=');
		windowparams = substringReplace(windowparams,'dir=','directories=');
		windowparams = substringReplace(windowparams,':tb=',',toolbar=');
		windowparams = substringReplace(windowparams,'tb=','toolbar=');
		windowparams = substringReplace(windowparams,':stat=',',status=');
		windowparams = substringReplace(windowparams,':mb=',',menubar=');
		windowparams = substringReplace(windowparams,':sb=',',scrollbars=');
		windowparams = substringReplace(windowparams,':rs=',',resizable=');
	}
	return windowparams;
}

// -->
		</script>


  <div class="wrapper">

	
    <div id="header">
    

	<div id="not_logged_slider" class="slider_wrapper">
		<div id="become_member_slider" class="header_slider">
			<div class="slider_content">
				<ul>
                    <li><a href="/membercenter/">join now</a></li>
                    <li><a href="/membercenter/membershiplevels/">member levels</a></li>
                    <li><a href="/membercenter/">member home</a></li>
				</ul>
			</div>
			<a class="slider_toggle">Become a member</a>
		</div>
		
	</div>
		
		<div id="member_login_slider">
			<a id="register_now_slider" href="/ssologin.cfm?login=true" title="Login"><span>Member Login</span></a>
		</div>
			
			
    
    
    

	  	<h1><a href="/" title="Go to AWEA homepage">AWEA - American Wind Energy Association</a></h1>
	  
	  
	  <div id="header_actions">
	  
	  
	    <form id="searchform" method="post" action="/searchresults.cfm">
	      <input name="search_string" type="text" class="text" value="search site" alt="Search AWEA.org" title="Search AWEA.org">
	      <button type="submit" class="submit" title="Search Submit">Search</button>
	    </form>
		
		
	    <div id="header_connect">
	      <p>connect with us:</p>
	      <ul>
	        <li class="tw"><a href="http://twitter.com/awea" title="Follow us on Twitter" target="_blank">Twitter</a></li>
	        <li class="fl"><a href="http://www.flickr.com/photos/awea/" title="Take a look at our photos" target="_blank">Flickr</a></li>
	        <li class="fb"><a href="http://www.facebook.com/pages/American-Wind-Energy-Association-AWEA/9423488774?ref=ts" title="Be a fan" target="_blank">Facebook</a></li>
	        <li class="yt"><a href="http://www.youtube.com/user/americanwindenergy" title="Look at our videos" target="_blank">Youtube</a></li>
	      </ul>
	    </div>    
	  </div>


		 
			<ul id="nav">
				
				<li id="nav_01">

					<a href="" title="GET INVOLVED" target="_self">
                       GET INVOLVED
					</a>
					
					
					<div class="subnav">
						<div class="subnav_content">
						
														
								<a class="subnav_block" id="subnav_becomeamember" href="/membercenter/" target="_self">			
								<img src="/ui/awea/images/subnavicon_getinvolved_becomeamember.jpg" alt="BECOME a Member">
								<span class="title">BECOME a Member</span>		 
								</a>
														
								<a class="subnav_block" id="subnav_aboutawea" href="/learnabout/aboutawea/index.cfm" target="_self">			
								<img src="/ui/awea/images/subnavicon_getinvolved_aboutawea.jpg" alt="ABOUT AWEA">
								<span class="title">ABOUT AWEA</span>		 
								</a>
							
	                        	<ul>
						    
	                        	<li>
	                                <a href="/issues/grassroots/index.cfm" title="Grassroots" target="_self">
	                                   <span>Grassroots</span>
	                                </a>
	                            </li>
						    
	                        	<li>
	                                <a href="/learnabout/smallwind/index.cfm" title="Distributed Wind" target="_self">
	                                   <span>Distributed Wind</span>
	                                </a>
	                            </li>
						    
	                        	<li>
	                                <a href="/events" title="AWEA Events" target="_self">
	                                   <span>AWEA Events</span>
	                                </a>
	                            </li>
						    
	                        	<li>
	                                <a href="http://www.careersinwind.com" title="Careers in Wind" target="_self">
	                                   <span>Careers in Wind</span>
	                                </a>
	                            </li>
						    
	                        	<li>
	                                <a href="/learnabout/aboutawea/advertising.cfm" title="Advertise on AWEA" target="_self">
	                                   <span>Advertise on AWEA</span>
	                                </a>
	                            </li>
						    
						    	</ul>
						  	
              		
						</div>
					</div>
					
				</li>
				
				<li id="nav_02">

					<a href="/learnabout/" title="LEARN ABOUT WIND POWER" target="_self">
                       LEARN ABOUT WIND POWER
					</a>
					
					
					<div class="subnav">
						<div class="subnav_content">
						
														
								<a class="subnav_block" id="subnav_statistics" href="/learnabout/industry_stats/index.cfm" target="_self">			
								<img src="/ui/awea/images/subnavicon_learnabout_industrystats.jpg" alt="Industry Statistics">
								<span class="title">Industry Statistics</span>		 
								</a>
														
								<a class="subnav_block" id="subnav_smallwind" href="/learnabout/smallwind/index.cfm" target="_self">			
								<img src="/ui/awea/images/subnavicon_learnabout_smallwind.jpg" alt="Distributed &amp; Community Wind">
								<span class="title">Distributed &amp; Community Wind</span>		 
								</a>
							
	                        	<ul>
						    
	                        	<li>
	                                <a href="/learnabout/utility/index.cfm" title="Utilities and Wind" target="_self">
	                                   <span>Utilities and Wind</span>
	                                </a>
	                            </li>
						    
	                        	<li>
	                                <a href="/learnabout/offshore/index.cfm" title="Offshore Wind" target="_self">
	                                   <span>Offshore Wind</span>
	                                </a>
	                            </li>
						    
	                        	<li>
	                                <a href="/learnabout/education/index.cfm" title="Education" target="_self">
	                                   <span>Education</span>
	                                </a>
	                            </li>
						    
	                        	<li>
	                                <a href="/learnabout/awea_standards_program/index.cfm" title="Standards Program" target="_self">
	                                   <span>Standards Program</span>
	                                </a>
	                            </li>
						    
	                        	<li>
	                                <a href="/learnabout/publications/index.cfm" title="Publications" target="_self">
	                                   <span>Publications</span>
	                                </a>
	                            </li>
						    
	                        	<li>
	                                <a href="/learnabout/publications/factsheets/index.cfm" title="Fact Sheets" target="_self">
	                                   <span>Fact Sheets</span>
	                                </a>
	                            </li>
						    
	                        	<li>
	                                <a href="/windtv/index.cfm" title="WindTV" target="_self">
	                                   <span>WindTV</span>
	                                </a>
	                            </li>
						    
	                        	<li>
	                                <a href="/learnabout/wind_energy_foundation.cfm" title="Foundation" target="_self">
	                                   <span>Foundation</span>
	                                </a>
	                            </li>
						    
						    	</ul>
						  	
              		
						</div>
					</div>
					
				</li>
				
				<li id="nav_03">

					<a href="/issues/" title="EXPLORE THE ISSUES" target="_self">
                       EXPLORE THE ISSUES
					</a>
					
					
					<div class="subnav">
						<div class="subnav_content">
						
														
								<a class="subnav_block" id="subnav_legislative" href="/issues/federal_policy/index.cfm" target="_self">			
								<img src="/ui/awea/images/subnavicon_explore_legislative.jpg" alt="Legislative">
								<span class="title">Legislative</span>		 
								</a>
														
								<a class="subnav_block" id="subnav_regulatory" href="/issues/state_policy/index.cfm" target="_self">			
								<img src="/ui/awea/images/subnavicon_explore_policy.jpg" alt="Regulatory">
								<span class="title">Regulatory</span>		 
								</a>
							
	                        	<ul>
						    
	                        	<li>
	                                <a href="/issues/transmission/index.cfm" title="Transmission" target="_self">
	                                   <span>Transmission</span>
	                                </a>
	                            </li>
						    
	                        	<li>
	                                <a href="/issues/siting/index.cfm" title="Siting" target="_self">
	                                   <span>Siting</span>
	                                </a>
	                            </li>
						    
	                        	<li>
	                                <a href="/issues/health_safety/health-safety.cfm" title="Health &amp; Safety" target="_self">
	                                   <span>Health &amp; Safety</span>
	                                </a>
	                            </li>
						    
	                        	<li>
	                                <a href="/issues/workforce/index.cfm" title="Workforce" target="_self">
	                                   <span>Workforce</span>
	                                </a>
	                            </li>
						    
	                        	<li>
	                                <a href="/issues/grassroots/index.cfm" title="Grassroots" target="_self">
	                                   <span>Grassroots</span>
	                                </a>
	                            </li>
						    
	                        	<li>
	                                <a href="/issues/windpac/index.cfm" title="WindPAC" target="_self">
	                                   <span>WindPAC</span>
	                                </a>
	                            </li>
						    
	                        	<li>
	                                <a href="/issues/supply_chain/index.cfm" title="Supply Chain" target="_self">
	                                   <span>Supply Chain</span>
	                                </a>
	                            </li>
						    
						    	</ul>
						  	
              		
						</div>
					</div>
					
				</li>
				
				<li id="nav_04">

					<a href="/newsroom/" title="READ THE NEWS" target="_self">
                       READ THE NEWS
					</a>
					
					
					<div class="subnav">
						<div class="subnav_content">
						
														
								<a class="subnav_block" id="subnav_press_releases" href="/newsroom/" target="_self">			
								<img src="/ui/awea/images/subnavicon_news_pressreleases.jpg" alt="Press Releases">
								<span class="title">Press Releases</span>		 
								</a>
														
								<a class="subnav_block" id="subnav_intothewind" href="/blog/" target="_self">			
								<img src="/ui/awea/images/subnavicon_news_blog.jpg" alt="Into the Wind: The AWEA Blog">
								<span class="title">Into the Wind: The AWEA Blog</span>		 
								</a>
							
	                        	<ul>
						    
	                        	<li>
	                                <a href="/newsroom/media-contacts.cfm" title="Media Contacts" target="_self">
	                                   <span>Media Contacts</span>
	                                </a>
	                            </li>
						    
						    	</ul>
						  	
              		
						</div>
					</div>
					
				</li>
				
				<li id="nav_05">

					<a href="/events/" title="GO TO EVENTS" target="_self">
                       GO TO EVENTS
					</a>
					
					
					<div class="subnav">
						<div class="subnav_content">
						
														
								<a class="subnav_block" id="subnav_windpower" href="http://www.windpowerexpo.com" target="_self">			
								<img src="/ui/awea/images/subnavicon_events_windpower.jpg" alt="WINDPOWER">
								<span class="title">WINDPOWER</span>		 
								</a>
														
								<a class="subnav_block" id="subnav_eventscalendar" href="/events/" target="_self">			
								<img src="/ui/awea/images/subnavicon_events_calender.jpg" alt="Events Calendar">
								<span class="title">Events Calendar</span>		 
								</a>
							
	                        	<ul>
						    
	                        	<li>
	                                <a href="http://sales.awea.org" title="Exhibit Opportunities" target="_self">
	                                   <span>Exhibit Opportunities</span>
	                                </a>
	                            </li>
						    
	                        	<li>
	                                <a href="/events/other-industry-events.cfm" title="Other Industry Events" target="_self">
	                                   <span>Other Industry Events</span>
	                                </a>
	                            </li>
						    
	                        	<li>
	                                <a href="http://sales.awea.org/sponsorship.cfm" title="Sponsorship" target="_self">
	                                   <span>Sponsorship</span>
	                                </a>
	                            </li>
						    
						    	</ul>
						  	
              		
						</div>
					</div>
					
				</li>
				
				<li id="nav_06">

					<a href="http://www.aweastore.com/" title="SHOP THE AWEA STORE" target="_self">
                       SHOP THE AWEA STORE
					</a>
					
				</li>
			
			</ul>
		
		
	</div>

	<div id="main">
	
            <div id="sidebar">
            
        <ul id="sidebar_nav">
          <li class="special"><a href="/">AWEA HOME</a></li> 
        </ul>
	
	
	<div class="clear"></div>

			<br>
			<div id="cs_control_1615" class=""><div class="CS_Element_Schedule" title="" id="CS_Element_leftcolumncontainer"></div></div>
            </div> 
            
            <div class="normal_content">
            
                <div class="content">
                
                
                
                <h2>
                Privacy Policy 
                </h2>
                 <br clear="all">
            <div id="cs_control_1398" class=""><div class="CS_Element_Schedule" title="" id="CS_Element_normalcontent">
<div id="cs_control_7547" class="cs_control CS_Element_Textblock"> <p><strong>American Wind Energy Association Privacy Policy</strong><br>
<br>
<strong>I. Introduction</strong><br>
This is the official Privacy Policy of the American Wind Energy Association ("AWEA," "we," "us," or "our")<br>
<br>
The official website for the AWEA is www.awea.org ("Site"). We are committed to protecting the privacy of our members and those who visit our Site. This Privacy Policy explains the type of personally identifiable information ("Personal Information") we collect, what we use it for, who we will share it with and how we will protect it. This Site is governed by laws and regulations of the United States ("U.S.").<br>
<br>
If you are not a resident of the U.S. and you chose to join the AWEA or to participate in AWEA events and activities that require the submission of your Personal Information, you hereby freely consent to the transfer and processing of your Personal Information to the U.S. and you consent to be governed by the laws and regulations of the U.S. with regards to the use of your Personal Information.<br>
<br>
Personal Information includes your name, address, phone number and e-mail address and any other information that is associated with your Personal Information. In the U.S., "Sensitive Personal Information" is personally identifiable information that is more confidential or sensitive in nature, such as your credit or debit card account number, social security number, and driver's license. We will tell you how we secure your Personal Information and Sensitive Personal Information and also what is the best way to contact us if you would like to review your Personal Information, Sensitive Personal Information or share your questions and comments. For the purpose of this Policy, we generally use the term "Personal Information" to include both confidential and non-confidential Personal Information, unless designated otherwise. This Privacy Policy governs all forms of Personal Information collected and used by the AWEA, and the AWEA Foundation offline and online.<br>
<br>
We reserve the right to modify this Policy at any time without prior notice. However, if there are material changes, we will notify you by e-mail and/or by postal mail. When we modify the Policy, we will post the revised Policy on this Site, with a notice on the homepage when such changes have been made.<br>
<br>
<strong>II. Collection and Use of Personal Information</strong><br>
We collect Personal Information online and offline only if you choose to provide it to us. If you choose to complete an AWEA membership application, register for an AWEA conference or seminar, or order a publication, participate in an AWEA event, or make a donation, we will ask you to provide your name, job title, name of company, business address, business phone, fax number and e-mail address. AWEA does not collect home addresses, home phone numbers or home e-mail accounts unless you decide to provide this information to the AWEA.<br>
<br>
We collect a credit or debit card account number and expiration date from members or other individuals to pay for membership dues, AWEA events fees, publications, audio or video materials and donations to the AWEA Foundation. For payments made offline, we submit the Personal Information needed to secure payment to the appropriate clearinghouse. If payment is submitted online, we use an authorized third-party operational service provider to collect and process your Sensitive Personal Information in a reasonably secure manner. Our operational service provider may also collect the security code associated with the credit or debit card. When members or other individuals choose to pay by check, we do not store checking account information. Payment information is retained for administrative and tax purposes.<br>
<br>
If you are a member we also use your name and the contact information you choose to share with us to compile an Annual Membership Directory for the personal and professional use of AWEA members. Every effort is made to ensure the accuracy of the information contained in the Directory. Online access to the Directory is password protected and restricted for use only by AWEA members and organizational staff.<br>
<br>
We will share your email address with other organizations that are co-sponsors or co-presenters of an AWEA event. lf you are a non-member, we will also use your email address for AWEA-related promotional purposes only; we do not disclose your email address to non-related third parties for marketing purposes. If you wish to be removed from our email distribution list, please complete the form to remove your email address from our list, or call AWEA at (202). We also share information within AWEA to improve service to our members and to enhance our organization's effectiveness.<br>
<br>
All third-party operational service providers used by the AWEA are required to comply with AWEA's Privacy Policy and practices. To the extent permitted by law, we may disclose your Personal Information to government authorities or third parties pursuant to a legal request, subpoena, or to comply with other legal process. We may also use or disclose your Personal Information to protect the rights or property of the AWEA, and the rights, safety or security of our members, our employees, our Site, or its users, and to enforce our Terms of Use Agreement.<br>
<br>
<strong>III. The Children's Online Privacy Protection Rule</strong><br>
The AWEA does not knowingly collect Personal Information from children under the age of 13.<br>
Any Personal Information knowingly collected from a child via the Site will be deleted.<br>
<br>
<strong>IV. Cookies and Other Technology</strong><br>
By using our Site, some information may be automatically collected by our web servers as you browse our Site. For example, our web server automatically collects information known as "click stream data," such as the domain name of the site providing you with Internet access, the Internet protocol (IP) address used to connect your computer to the Internet, your browser type and version, operating system and platform, the average time spent on our site, pages viewed, information searched for, access times and other relevant statistics. We also collect information by using technologies and methodologies that enable tracking, such as "cookies". "Cookies" are small pieces of information that a website transfers to the hard drive of a visitor's computer for record-keeping purposes. "Cookies" provide visitors a personalized experience on our site by enabling us to determine unique preferences and trends based on visits to our website and to other websites.<br>
<br>
<strong>V. Protecting Your Personal Information</strong><br>
The AWEA is committed to protecting the security of your Personal Information. We use reasonable security technologies and procedures to protect your Personal Information from unauthorized access, use or disclosure.<br>
<br>
<strong>VI. Access to and Review of Your Personal Information</strong><br>
If you have registered for an event via the Site, you have limited access to your record online. You may review the history of your activity for the calendar year. However, you may not modify or correct any Personal Information on your record; all modifications or corrections must be submitted to the AWEA directly. If you would like to review, modify and/ or correct your Personal Information, please contact us at [ ]. You must authenticate your identity before we provide access to your Personal Information.<br>
<br>
<strong>VII. External Links</strong><br>
In order to assist you and provide you as much information as possible, our Site contains links to other websites including those that offer information of professional interest to our membership. AWEA is not responsible for the business or privacy practices or the content of such external websites. Therefore, we encourage you to review the privacy policy and terms and conditions of any third-party website linked to this Site before you submit any Personal Information.<br>
<br>
<strong>VIII. Contact Us</strong><br>
If you have any questions or comments, please contact us at: 202-383-2500.</p> </div>
</div></div> 
                </div> 
            </div> 
            
	</div>	
	<div class="clear"></div>
   </div>


<div id="footer">
	  <div class="wrapper">
            <p align="center">
            </p><table align="center" width="900" cellpadding="0" cellspacing="0" border="0" style="margin-left: 30px;">
                <tbody><tr>
                    <td width="225"><a href="http://www.awea.org/"><img src="http://www.awea.org/ui/awea/images/logo_farm_awea.png" width="225" height="64" alt="American Wind Energy Association" border="0"></a></td>
                    <td width="225"><a href="http://www.windpowerexpo.org" target="_blank"><img src="http://www.awea.org/ui/awea/images/logo_farm_wp12.png" width="225" height="64" alt="WINDPOWER 2012" border="0"></a></td>
                    <td width="225"><a href="http://www.offshorewindexpo.org/" target="_blank"><img src="http://www.awea.org/ui/awea/images/logo_farm_off2012.png" width="225" height="64" alt="Offshore WINDPOWER 2012" border="0"></a></td>
                    <td width="225"><a href="http://www.powerofwind.com/" target="_blank"><img src="http://www.awea.org/ui/awea/images/logo_farm_pow.png" width="225" height="64" alt="Power of Wind" border="0"></a></td>
                </tr>
            </tbody></table>
            <p></p>
            <br>
            <br>
	    <p id="footer_nav">
	      <a href="#">Get Involved</a>
	      <a href="/learnabout/">Learn about Wind Power</a>
	      <a href="/issues/">Explore the Issues</a>
	      <a href="/newsroom/">Read the News</a>
	      <a href="/events/">Go to Events</a>
	      <a href="http://www.aweastore.com/">Shop the AWEA Store</a>
	    </p>
	    <div id="footer_disclaimer">
	      <p>AMERICAN WIND ENERGY ASSOCIATION®</p>
	      <p>1501 M Street, NW, Suite 1000 | Washington, DC 20005 | Phone: 202.383.2500 | Fax: 202.383.2505 | <a href="mailto:windmail@awea.org">windmail@awea.org</a> | <a href="mailto: websupport@awea.org">websupport@awea.org</a></p>
	      <p>Copyright 1996 - 2012 American Wind Energy Association. All Rights Reserved. <a href="http://www.awea.org/privacy.cfm">Privacy Policy</a></p>
	      
	    </div>      
	    <div class="clear"></div>
	  </div>
	</div>
<script type="text/JavaScript">var TFN='';var TFA='';var TFI='0';var TFL='0';var tf_RetServer="rt.trafficfacts.com";var tf_SiteId="14288gf4ff206ffe222e238a9b83b69842daf7dc172316h8";var tf_ScrServer=document.location.protocol+"//rt.trafficfacts.com/tf.php?k=14288gf4ff206ffe222e238a9b83b69842daf7dc172316h8;c=s;v=5";document.write(unescape('%3Cscript type="text/JavaScript" src="'+tf_ScrServer+'">%3C/script>'));</script><script type="text/JavaScript" src="https://rt.trafficfacts.com/tf.php?k=14288gf4ff206ffe222e238a9b83b69842daf7dc172316h8;c=s;v=5"></script><noscript><img src="http://rt.trafficfacts.com/ns.php?k=14288gf4ff206ffe222e238a9b83b69842daf7dc172316h8" height="1" width="1" alt=""/></noscript>

<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-26601400-1']);
  _gaq.push(['_setLocalRemoteServerMode']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script><div style="display:block; clear:left; padding:0px; font-family:Verdana,Arial; font-size:10px; color:gray;"></div>
		<script type="text/javascript">
		<!--
			var jsPageContributeMode = 'read';
			var jsPageSessionContributeMode = 'read';
			
			var jsPageAuthorMode = 0;
			var jsPageEditMode = 0;

			
			if(!commonspot)
				var commonspot = {};
			commonspot.csPage = {};
			commonspot.csPage.url = '/privacy.cfm';
			
			commonspot.csPage.id = 7546;
			commonspot.csPage.title = 'Privacy Policy';

			commonspot.csPage.pagetype = 0;
			commonspot.csPage.publicationState = 'Published Page';
			commonspot.csPage.subsiteRoot = '/';
			commonspot.csPage.siteRoot = '/';
			commonspot.csPage.mode = jsPageSessionContributeMode;
			commonspot.csPage.authorok = 1;
			commonspot.csPage.approvalstatus = 0;
			commonspot.csPage.showContainerUI = 0;
			commonspot.csPage.requestedVersionTimestamp = '';
			commonspot.csPage.userRights = {};
			commonspot.csPage.userRights.isLoggedIn = 0;
			commonspot.csPage.userRights.licensedContributor = 0;
			commonspot.csPage.userRights.read = 1;
			commonspot.csPage.userRights.author = 0;
			commonspot.csPage.userRights.edit = 0;
			commonspot.csPage.userRights.approve = 0;
			commonspot.csPage.userRights.history = 0;
			commonspot.csPage.userRights.design = 0;
			commonspot.csPage.userRights.admin = 0;
			commonspot.csPage.userRights.subsiteAdmin = 0;
			commonspot.csPage.userRights.siteAdmin = 0;
			commonspot.csPage.userRights.customerAdmin = 0;
			commonspot.csPage.userRights.serverAdmin = 0;

			commonspot.csPage.enabledMenuClasses = '';
			
			commonspot.csPage.visibleMenuClasses = '';

			
			commonspot.csPage.subsiteContext = {};
			commonspot.csPage.subsiteContext.sitetype = 1;
			commonspot.csPage.subsiteContext.siteid = 1;
			commonspot.csPage.subsiteContext.subsiteid = 1;
			commonspot.csPage.subsiteContext.siteurl = '/';
			commonspot.csPage.subsiteContext.subsiteurl = '/';
			commonspot.csPage.subsiteContext.sitename = 'awea';
			commonspot.csPage.subsiteContext.subsitename = '/';
			commonspot.csPage.subsiteContext.menucontexttimestamp = '1340377213558';
			commonspot.csPage.serveradminurl = "/commonspot/admin/";
			if (parent.commonspot)
				parent.commonspot.csPage = commonspot.csPage;
			var doLviewRedirect;
			if(parent &&
						parent.commonspot &&
						parent.commonspot.lview &&
						!doLviewRedirect &&
						parent.commonspot.lightbox &&
						parent.commonspot.lightbox.stack.length == 0)
			{
			
				commonspot.csPage.showPageSubmit = false;
			
				onPageArrival = function()
				{
					parent.commonspot.lview.currentPage.onPageArrival( commonspot.csPage );
				};
				onPageUnload = function()
				{
					parent.commonspot.lview.currentPage.onPageUnload();
				};
				parent.Spry.Utils.addEventListener(window, 'load', onPageArrival, false);
				parent.Spry.Utils.addEventListener(window, 'unload', onPageUnload, false);
			}
		

		// -->
		</script> <script type="text/javascript" src="/commonspot/javascript/browser-all.js"></script> 
<script type="text/javascript">
<!--
	if ((typeof commonspot == 'undefined' || !commonspot.lightbox) && (!top.commonspot || !top.commonspot.lightbox))
		loadNonDashboardFiles();
	if (parent.commonspot && typeof newWindow == 'undefined')
	{
		var arrFiles = 
				[
					{fileName: '/commonspot/javascript/lightbox/overrides.js', fileType: 'script', fileID: null},
					{fileName: '/commonspot/javascript/lightbox/window_ref.js', fileType: 'script', fileID: null}
				];
		
		loadDashboardFiles(arrFiles);
	}	
//-->
</script>

</body></html>